<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Metabolomics | Water masses influence microbiome and metabolome in deep-sea sponges</title>
  <meta name="description" content="3 Metabolomics | Water masses influence microbiome and metabolome in deep-sea sponges" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Metabolomics | Water masses influence microbiome and metabolome in deep-sea sponges" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Metabolomics | Water masses influence microbiome and metabolome in deep-sea sponges" />
  
  
  

<meta name="author" content="Karin Steffen" />


<meta name="date" content="2020-01-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metabolomics.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SUPPLEMENTARY MATERIAL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Content</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#experimental-setup"><i class="fa fa-check"></i><b>1.1</b> Experimental setup</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#map"><i class="fa fa-check"></i><b>1.1.1</b> Map</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#water-masses"><i class="fa fa-check"></i><b>1.1.2</b> Water masses</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#sponges"><i class="fa fa-check"></i><b>1.1.3</b> Sponges</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#funding-disclaimer"><i class="fa fa-check"></i><b>1.1.4</b> Funding disclaimer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="metabolomics.html"><a href="metabolomics.html"><i class="fa fa-check"></i><b>2</b> Metabolomics</a><ul>
<li class="chapter" data-level="2.1" data-path="metabolomics.html"><a href="metabolomics.html#experimental-methods-and-detailled-description"><i class="fa fa-check"></i><b>2.1</b> Experimental methods and detailled description</a><ul>
<li class="chapter" data-level="2.1.1" data-path="metabolomics.html"><a href="metabolomics.html#additional-sampling-notes"><i class="fa fa-check"></i><b>2.1.1</b> Additional sampling notes</a></li>
<li class="chapter" data-level="2.1.2" data-path="metabolomics.html"><a href="metabolomics.html#laboratory-methods-and-data-acquisition"><i class="fa fa-check"></i><b>2.1.2</b> Laboratory methods and data acquisition</a></li>
<li class="chapter" data-level="2.1.3" data-path="metabolomics.html"><a href="metabolomics.html#mass-spectrometry-analysis"><i class="fa fa-check"></i><b>2.1.3</b> Mass spectrometry analysis</a></li>
<li class="chapter" data-level="2.1.4" data-path="metabolomics.html"><a href="metabolomics.html#high-resolution-ms-analysis-system-and-settings"><i class="fa fa-check"></i><b>2.1.4</b> High resolution MS analysis system and settings</a></li>
<li class="chapter" data-level="2.1.5" data-path="metabolomics.html"><a href="metabolomics.html#data-acquisition"><i class="fa fa-check"></i><b>2.1.5</b> Data acquisition</a></li>
<li class="chapter" data-level="2.1.6" data-path="metabolomics.html"><a href="metabolomics.html#ms-data-processing"><i class="fa fa-check"></i><b>2.1.6</b> MS data processing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="metabolomics.html"><a href="metabolomics.html#peak-picking-with-xcms-and-annotation-with-camera"><i class="fa fa-check"></i><b>2.2</b> Peak picking with XCMS and annotation with CAMERA</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metabolomics-1.html"><a href="metabolomics-1.html"><i class="fa fa-check"></i><b>3</b> Metabolomics</a><ul>
<li class="chapter" data-level="3.1" data-path="metabolomics-1.html"><a href="metabolomics-1.html#xcms-data-processing"><i class="fa fa-check"></i><b>3.1</b> XCMS data processing</a><ul>
<li class="chapter" data-level="3.1.1" data-path="metabolomics-1.html"><a href="metabolomics-1.html#hilic-hydrophilic-interaction-chromatography-column-with-positive-esi-electron-spray-ionosation"><i class="fa fa-check"></i><b>3.1.1</b> HILIC (Hydrophilic interaction chromatography) column with positive ESI (electron spray ionosation)</a></li>
<li class="chapter" data-level="3.1.2" data-path="metabolomics-1.html"><a href="metabolomics-1.html#hilic-chromatography-with-negative-esi"><i class="fa fa-check"></i><b>3.1.2</b> HILIC Chromatography with negative ESI</a></li>
<li class="chapter" data-level="3.1.3" data-path="metabolomics-1.html"><a href="metabolomics-1.html#rp-reversed-phase-chromatography-with-positive-esi"><i class="fa fa-check"></i><b>3.1.3</b> RP (Reversed phase) Chromatography with positive ESI</a></li>
<li class="chapter" data-level="3.1.4" data-path="metabolomics-1.html"><a href="metabolomics-1.html#rp-chromatography-with-negative-esi"><i class="fa fa-check"></i><b>3.1.4</b> RP Chromatography with negative ESI</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="metabolomics-1.html"><a href="metabolomics-1.html#filtering-of-the-raw-data-set"><i class="fa fa-check"></i><b>3.2</b> Filtering of the raw data set</a></li>
<li class="chapter" data-level="3.3" data-path="metabolomics-1.html"><a href="metabolomics-1.html#summary"><i class="fa fa-check"></i><b>3.3</b> Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Water masses influence microbiome and metabolome in deep-sea sponges</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metabolomics-1" class="section level1">
<h1><span class="header-section-number">3</span> Metabolomics</h1>
<div id="xcms-data-processing" class="section level2">
<h2><span class="header-section-number">3.1</span> XCMS data processing</h2>
<div id="hilic-hydrophilic-interaction-chromatography-column-with-positive-esi-electron-spray-ionosation" class="section level3">
<h3><span class="header-section-number">3.1.1</span> HILIC (Hydrophilic interaction chromatography) column with positive ESI (electron spray ionosation)</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="metabolomics-1.html#cb1-1"></a><span class="co"># HILIC POS</span></span>
<span id="cb1-2"><a href="metabolomics-1.html#cb1-2"></a><span class="co"># ALWAYS CHECK DATE, CHROMATOGRAPHIC CLOUMN (HILIC, RP) AND ESI-MODE (naming, CAMERA: pos, neg)</span></span>
<span id="cb1-3"><a href="metabolomics-1.html#cb1-3"></a></span>
<span id="cb1-4"><a href="metabolomics-1.html#cb1-4"></a><span class="co">#setwd() # work in directory containing the sorted CDF files.</span></span>
<span id="cb1-5"><a href="metabolomics-1.html#cb1-5"></a><span class="co">#getwd()</span></span>
<span id="cb1-6"><a href="metabolomics-1.html#cb1-6"></a><span class="kw">library</span>(xcms)</span>
<span id="cb1-7"><a href="metabolomics-1.html#cb1-7"></a>xset&lt;-<span class="kw">xcmsSet</span>(<span class="dt">method=</span><span class="st">&quot;centWave&quot;</span>, <span class="dt">ppm=</span><span class="dv">8</span>, <span class="dt">peakwidth=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">45</span>), <span class="dt">noise=</span><span class="dv">2000</span>)</span>
<span id="cb1-8"><a href="metabolomics-1.html#cb1-8"></a><span class="kw">save</span>(xset, <span class="dt">file=</span><span class="st">&quot;HILIC_pos_xset_20190417.Rda&quot;</span>)</span>
<span id="cb1-9"><a href="metabolomics-1.html#cb1-9"></a><span class="co">#load(file=&quot;HILIC_pos_xset_20190417.Rda&quot;) #When resuming after a break</span></span>
<span id="cb1-10"><a href="metabolomics-1.html#cb1-10"></a>xset&lt;-<span class="kw">group</span>(xset)</span>
<span id="cb1-11"><a href="metabolomics-1.html#cb1-11"></a>xset2&lt;-<span class="kw">retcor</span>(xset, <span class="dt">method=</span><span class="st">&quot;obiwarp&quot;</span>, <span class="dt">response=</span><span class="dv">10</span>, <span class="dt">plottype=</span><span class="st">&quot;deviation&quot;</span>)</span>
<span id="cb1-12"><a href="metabolomics-1.html#cb1-12"></a>xset2&lt;-<span class="kw">group</span>(xset2)</span>
<span id="cb1-13"><a href="metabolomics-1.html#cb1-13"></a>xset3&lt;-<span class="kw">fillPeaks</span>(xset2)</span>
<span id="cb1-14"><a href="metabolomics-1.html#cb1-14"></a><span class="kw">save</span>(xset3, <span class="dt">file=</span><span class="st">&quot;HILIC_pos_xset3_20190417.Rda&quot;</span>)</span>
<span id="cb1-15"><a href="metabolomics-1.html#cb1-15"></a>reporttab&lt;-<span class="kw">diffreport</span>(xset3, <span class="st">&quot;Gb&quot;</span>, <span class="st">&quot;Sf&quot;</span>, <span class="st">&quot;Gb_Sf_HILIC_pos_20190417&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb1-16"><a href="metabolomics-1.html#cb1-16"></a></span>
<span id="cb1-17"><a href="metabolomics-1.html#cb1-17"></a><span class="kw">library</span>(CAMERA)</span>
<span id="cb1-18"><a href="metabolomics-1.html#cb1-18"></a>xsa&lt;-<span class="kw">xsAnnotate</span>(xset3)</span>
<span id="cb1-19"><a href="metabolomics-1.html#cb1-19"></a>xsaF&lt;-<span class="kw">groupFWHM</span>(xsa, <span class="dt">perfwhm =</span> <span class="fl">0.3</span>)</span>
<span id="cb1-20"><a href="metabolomics-1.html#cb1-20"></a>xsaC&lt;-<span class="kw">groupCorr</span>(xsaF, <span class="dt">cor_eic_th =</span> <span class="fl">0.7</span>) </span>
<span id="cb1-21"><a href="metabolomics-1.html#cb1-21"></a>xsaFI&lt;-<span class="kw">findIsotopes</span>(xsaC)</span>
<span id="cb1-22"><a href="metabolomics-1.html#cb1-22"></a>rules &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rules_jan_pos.csv&quot;</span>, <span class="dt">header=</span>T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb1-23"><a href="metabolomics-1.html#cb1-23"></a>xsaFA&lt;-<span class="kw">findAdducts</span>(xsaFI, <span class="dt">polarity=</span><span class="st">&quot;positive&quot;</span>, <span class="dt">rules=</span>rules)</span>
<span id="cb1-24"><a href="metabolomics-1.html#cb1-24"></a><span class="co">#write.csv(getPeaklist(xsaFA), file=&quot;HILIC_pos_20190417.csv&quot;)</span></span></code></pre></div>
<p>The other data experiments, HILIC with negative ESI and RP with positive and negative ESI are processed accordingly.</p>
</div>
<div id="hilic-chromatography-with-negative-esi" class="section level3">
<h3><span class="header-section-number">3.1.2</span> HILIC Chromatography with negative ESI</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="metabolomics-1.html#cb2-1"></a><span class="co"># HILIC NEG 20190421</span></span>
<span id="cb2-2"><a href="metabolomics-1.html#cb2-2"></a></span>
<span id="cb2-3"><a href="metabolomics-1.html#cb2-3"></a><span class="co">#setwd() # work in directory containing the sorted CDF files.</span></span>
<span id="cb2-4"><a href="metabolomics-1.html#cb2-4"></a><span class="co">#getwd()</span></span>
<span id="cb2-5"><a href="metabolomics-1.html#cb2-5"></a><span class="kw">library</span>(xcms)</span>
<span id="cb2-6"><a href="metabolomics-1.html#cb2-6"></a>xset&lt;-<span class="kw">xcmsSet</span>(<span class="dt">method=</span><span class="st">&quot;centWave&quot;</span>, <span class="dt">ppm=</span><span class="dv">8</span>, <span class="dt">peakwidth=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">45</span>), <span class="dt">noise=</span><span class="dv">2000</span>)</span>
<span id="cb2-7"><a href="metabolomics-1.html#cb2-7"></a><span class="kw">save</span>(xset, <span class="dt">file=</span><span class="st">&quot;HILIC_neg_xset_20190421.Rda&quot;</span>)</span>
<span id="cb2-8"><a href="metabolomics-1.html#cb2-8"></a><span class="co">#load(file=&quot;HILIC_neg_xset_20190421.Rda&quot;) #When resuming after a break</span></span>
<span id="cb2-9"><a href="metabolomics-1.html#cb2-9"></a>xset&lt;-<span class="kw">group</span>(xset)</span>
<span id="cb2-10"><a href="metabolomics-1.html#cb2-10"></a>xset2&lt;-<span class="kw">retcor</span>(xset, <span class="dt">method=</span><span class="st">&quot;obiwarp&quot;</span>, <span class="dt">response=</span><span class="dv">10</span>, <span class="dt">plottype=</span><span class="st">&quot;deviation&quot;</span>)</span>
<span id="cb2-11"><a href="metabolomics-1.html#cb2-11"></a>xset2&lt;-<span class="kw">group</span>(xset2)</span>
<span id="cb2-12"><a href="metabolomics-1.html#cb2-12"></a>xset3&lt;-<span class="kw">fillPeaks</span>(xset2)</span>
<span id="cb2-13"><a href="metabolomics-1.html#cb2-13"></a><span class="kw">save</span>(xset3, <span class="dt">file=</span><span class="st">&quot;HILIC_neg_xset3_20190421.Rda&quot;</span>)</span>
<span id="cb2-14"><a href="metabolomics-1.html#cb2-14"></a>reporttab&lt;-<span class="kw">diffreport</span>(xset3, <span class="st">&quot;Gb&quot;</span>, <span class="st">&quot;Sf&quot;</span>, <span class="st">&quot;Gb_Sf_HILIC_neg_20190421&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb2-15"><a href="metabolomics-1.html#cb2-15"></a></span>
<span id="cb2-16"><a href="metabolomics-1.html#cb2-16"></a><span class="kw">library</span>(CAMERA)</span>
<span id="cb2-17"><a href="metabolomics-1.html#cb2-17"></a>xsa&lt;-<span class="kw">xsAnnotate</span>(xset3)</span>
<span id="cb2-18"><a href="metabolomics-1.html#cb2-18"></a>xsaF&lt;-<span class="kw">groupFWHM</span>(xsa,<span class="dt">perfwhm =</span> <span class="fl">0.3</span>)</span>
<span id="cb2-19"><a href="metabolomics-1.html#cb2-19"></a>xsaC&lt;-<span class="kw">groupCorr</span>(xsaF,<span class="dt">cor_eic_th =</span> <span class="fl">0.7</span>) </span>
<span id="cb2-20"><a href="metabolomics-1.html#cb2-20"></a>xsaFI&lt;-<span class="kw">findIsotopes</span>(xsaC)</span>
<span id="cb2-21"><a href="metabolomics-1.html#cb2-21"></a>rules &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rules_jan_neg.csv&quot;</span>, <span class="dt">header=</span>T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb2-22"><a href="metabolomics-1.html#cb2-22"></a>xsaFA&lt;-<span class="kw">findAdducts</span>(xsaFI, <span class="dt">polarity=</span><span class="st">&quot;negative&quot;</span>, <span class="dt">rules=</span>rules)</span>
<span id="cb2-23"><a href="metabolomics-1.html#cb2-23"></a><span class="co">#write.csv(getPeaklist(xsaFA), file=&quot;HILIC_neg_20190421.csv&quot;)</span></span></code></pre></div>
</div>
<div id="rp-reversed-phase-chromatography-with-positive-esi" class="section level3">
<h3><span class="header-section-number">3.1.3</span> RP (Reversed phase) Chromatography with positive ESI</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="metabolomics-1.html#cb3-1"></a><span class="co"># RP POS 20190421</span></span>
<span id="cb3-2"><a href="metabolomics-1.html#cb3-2"></a></span>
<span id="cb3-3"><a href="metabolomics-1.html#cb3-3"></a><span class="co">#setwd() # work in directory containing the sorted CDF files.</span></span>
<span id="cb3-4"><a href="metabolomics-1.html#cb3-4"></a><span class="co">#getwd()</span></span>
<span id="cb3-5"><a href="metabolomics-1.html#cb3-5"></a><span class="kw">library</span>(xcms)</span>
<span id="cb3-6"><a href="metabolomics-1.html#cb3-6"></a>xset&lt;-<span class="kw">xcmsSet</span>(<span class="dt">method=</span><span class="st">&quot;centWave&quot;</span>, <span class="dt">ppm=</span><span class="dv">8</span>, <span class="dt">peakwidth=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">45</span>), <span class="dt">noise=</span><span class="dv">2000</span>)</span>
<span id="cb3-7"><a href="metabolomics-1.html#cb3-7"></a><span class="kw">save</span>(xset, <span class="dt">file=</span><span class="st">&quot;RP_pos_xset_20190421.Rda&quot;</span>)</span>
<span id="cb3-8"><a href="metabolomics-1.html#cb3-8"></a><span class="co">#load(file=&quot;RP_pos_xset_20190421.Rda&quot;) #When resuming after a break</span></span>
<span id="cb3-9"><a href="metabolomics-1.html#cb3-9"></a>xset&lt;-<span class="kw">group</span>(xset)</span>
<span id="cb3-10"><a href="metabolomics-1.html#cb3-10"></a>xset2&lt;-<span class="kw">retcor</span>(xset, <span class="dt">method=</span><span class="st">&quot;obiwarp&quot;</span>, <span class="dt">response=</span><span class="dv">10</span>, <span class="dt">plottype=</span><span class="st">&quot;deviation&quot;</span>)</span>
<span id="cb3-11"><a href="metabolomics-1.html#cb3-11"></a>xset2&lt;-<span class="kw">group</span>(xset2)</span>
<span id="cb3-12"><a href="metabolomics-1.html#cb3-12"></a>xset3&lt;-<span class="kw">fillPeaks</span>(xset2)</span>
<span id="cb3-13"><a href="metabolomics-1.html#cb3-13"></a><span class="kw">save</span>(xset3, <span class="dt">file=</span><span class="st">&quot;RP_pos_xset3_20190421.Rda&quot;</span>)</span>
<span id="cb3-14"><a href="metabolomics-1.html#cb3-14"></a>reporttab&lt;-<span class="kw">diffreport</span>(xset3, <span class="st">&quot;Gb&quot;</span>, <span class="st">&quot;Sf&quot;</span>, <span class="st">&quot;Gb_Sf_RP_pos_20190421&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb3-15"><a href="metabolomics-1.html#cb3-15"></a></span>
<span id="cb3-16"><a href="metabolomics-1.html#cb3-16"></a><span class="kw">library</span>(CAMERA)</span>
<span id="cb3-17"><a href="metabolomics-1.html#cb3-17"></a>xsa&lt;-<span class="kw">xsAnnotate</span>(xset3)</span>
<span id="cb3-18"><a href="metabolomics-1.html#cb3-18"></a>xsaF&lt;-<span class="kw">groupFWHM</span>(xsa,<span class="dt">perfwhm =</span> <span class="fl">0.3</span>)</span>
<span id="cb3-19"><a href="metabolomics-1.html#cb3-19"></a>xsaC&lt;-<span class="kw">groupCorr</span>(xsaF,<span class="dt">cor_eic_th =</span> <span class="fl">0.7</span>) </span>
<span id="cb3-20"><a href="metabolomics-1.html#cb3-20"></a>xsaFI&lt;-<span class="kw">findIsotopes</span>(xsaC)</span>
<span id="cb3-21"><a href="metabolomics-1.html#cb3-21"></a>rules &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rules_jan_pos.csv&quot;</span>, <span class="dt">header=</span>T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb3-22"><a href="metabolomics-1.html#cb3-22"></a>xsaFA&lt;-<span class="kw">findAdducts</span>(xsaFI, <span class="dt">polarity=</span><span class="st">&quot;positive&quot;</span>, <span class="dt">rules=</span>rules)</span>
<span id="cb3-23"><a href="metabolomics-1.html#cb3-23"></a><span class="co">#write.csv(getPeaklist(xsaFA), file=&quot;RP_pos_20190421.csv&quot;)</span></span></code></pre></div>
</div>
<div id="rp-chromatography-with-negative-esi" class="section level3">
<h3><span class="header-section-number">3.1.4</span> RP Chromatography with negative ESI</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="metabolomics-1.html#cb4-1"></a><span class="co"># RP NEG 20190422</span></span>
<span id="cb4-2"><a href="metabolomics-1.html#cb4-2"></a></span>
<span id="cb4-3"><a href="metabolomics-1.html#cb4-3"></a><span class="co">#setwd() # work in directory containing the sorted CDF files.</span></span>
<span id="cb4-4"><a href="metabolomics-1.html#cb4-4"></a><span class="co">#getwd()</span></span>
<span id="cb4-5"><a href="metabolomics-1.html#cb4-5"></a><span class="kw">library</span>(xcms)</span>
<span id="cb4-6"><a href="metabolomics-1.html#cb4-6"></a>xset&lt;-<span class="kw">xcmsSet</span>(<span class="dt">method=</span><span class="st">&quot;centWave&quot;</span>, <span class="dt">ppm=</span><span class="dv">8</span>, <span class="dt">peakwidth=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">45</span>), <span class="dt">noise=</span><span class="dv">2000</span>)</span>
<span id="cb4-7"><a href="metabolomics-1.html#cb4-7"></a><span class="kw">save</span>(xset, <span class="dt">file=</span><span class="st">&quot;RP_neg_xset_20190422.Rda&quot;</span>)</span>
<span id="cb4-8"><a href="metabolomics-1.html#cb4-8"></a><span class="co">#load(file=&quot;RP_neg_xset_20190422.Rda&quot;) #When resuming after a break</span></span>
<span id="cb4-9"><a href="metabolomics-1.html#cb4-9"></a>xset&lt;-<span class="kw">group</span>(xset)</span>
<span id="cb4-10"><a href="metabolomics-1.html#cb4-10"></a>xset2&lt;-<span class="kw">retcor</span>(xset, <span class="dt">method=</span><span class="st">&quot;obiwarp&quot;</span>, <span class="dt">response=</span><span class="dv">10</span>, <span class="dt">plottype=</span><span class="st">&quot;deviation&quot;</span>)</span>
<span id="cb4-11"><a href="metabolomics-1.html#cb4-11"></a>xset2&lt;-<span class="kw">group</span>(xset2)</span>
<span id="cb4-12"><a href="metabolomics-1.html#cb4-12"></a>xset3&lt;-<span class="kw">fillPeaks</span>(xset2)</span>
<span id="cb4-13"><a href="metabolomics-1.html#cb4-13"></a><span class="kw">save</span>(xset3, <span class="dt">file=</span><span class="st">&quot;RP_neg_xset3_20190422.Rda&quot;</span>)</span>
<span id="cb4-14"><a href="metabolomics-1.html#cb4-14"></a>reporttab&lt;-<span class="kw">diffreport</span>(xset3, <span class="st">&quot;Gb&quot;</span>, <span class="st">&quot;Sf&quot;</span>, <span class="st">&quot;Gb_Sf_RP_neg_20190422&quot;</span>, <span class="dv">10</span>)</span>
<span id="cb4-15"><a href="metabolomics-1.html#cb4-15"></a></span>
<span id="cb4-16"><a href="metabolomics-1.html#cb4-16"></a><span class="kw">library</span>(CAMERA)</span>
<span id="cb4-17"><a href="metabolomics-1.html#cb4-17"></a>xsa&lt;-<span class="kw">xsAnnotate</span>(xset3)</span>
<span id="cb4-18"><a href="metabolomics-1.html#cb4-18"></a>xsaF&lt;-<span class="kw">groupFWHM</span>(xsa,<span class="dt">perfwhm =</span> <span class="fl">0.3</span>)</span>
<span id="cb4-19"><a href="metabolomics-1.html#cb4-19"></a>xsaC&lt;-<span class="kw">groupCorr</span>(xsaF,<span class="dt">cor_eic_th =</span> <span class="fl">0.7</span>) </span>
<span id="cb4-20"><a href="metabolomics-1.html#cb4-20"></a>xsaFI&lt;-<span class="kw">findIsotopes</span>(xsaC)</span>
<span id="cb4-21"><a href="metabolomics-1.html#cb4-21"></a>rules &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rules_jan_neg.csv&quot;</span>, <span class="dt">header=</span>T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb4-22"><a href="metabolomics-1.html#cb4-22"></a>xsaFA&lt;-<span class="kw">findAdducts</span>(xsaFI, <span class="dt">polarity=</span><span class="st">&quot;negative&quot;</span>, <span class="dt">rules=</span>rules)</span>
<span id="cb4-23"><a href="metabolomics-1.html#cb4-23"></a><span class="co">#write.csv(getPeaklist(xsaFA), file=&quot;RP_neg_20190422.csv&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="filtering-of-the-raw-data-set" class="section level2">
<h2><span class="header-section-number">3.2</span> Filtering of the raw data set</h2>
<p>Features with with following properties were removed:</p>
<ul>
<li>Eluting in the void (RT &lt; 45 s)</li>
<li>CV&gt;30 % in QC samples</li>
<li>Adducts as annotated by CAMERA</li>
</ul>
<p>As the presence of the same parent feature in the the form of isotopes and adducts distorts downstream global metabolome analyses, we generated two versions of curated or selective feature tables. In both, void and unstably measured features are removed (“cleaned”). One retains only the feature with the largest signal per pc group (“cleaned_pcgroup”), the other is more stringent and only contains explicitly annotated parent ions (“cleaned_MH”), i.e. [M+H]+ for positive ESI and [M-H]- for negative ESI acquired data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="metabolomics-1.html#cb5-1"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="metabolomics-1.html#cb9-1"></a><span class="co">#================================ HILIC pos ===================================</span></span>
<span id="cb9-2"><a href="metabolomics-1.html#cb9-2"></a>raw_peaks &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;HILIC_pos_20190417.csv&quot;</span>)</span>
<span id="cb9-3"><a href="metabolomics-1.html#cb9-3"></a>hp_dim1 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb9-4"><a href="metabolomics-1.html#cb9-4"></a>hp_pcg1 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb9-5"><a href="metabolomics-1.html#cb9-5"></a></span>
<span id="cb9-6"><a href="metabolomics-1.html#cb9-6"></a><span class="co"># Removing features eluting in the void</span></span>
<span id="cb9-7"><a href="metabolomics-1.html#cb9-7"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>rt<span class="op">&gt;</span><span class="dv">45</span>,]</span>
<span id="cb9-8"><a href="metabolomics-1.html#cb9-8"></a>hp_dim2 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb9-9"><a href="metabolomics-1.html#cb9-9"></a>hp_pcg2 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb9-10"><a href="metabolomics-1.html#cb9-10"></a></span>
<span id="cb9-11"><a href="metabolomics-1.html#cb9-11"></a><span class="co"># Removing features with a CV &lt; 30%</span></span>
<span id="cb9-12"><a href="metabolomics-1.html#cb9-12"></a>f &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20170918_02001&quot;</span>) <span class="co"># first QC HILIC pos</span></span>
<span id="cb9-13"><a href="metabolomics-1.html#cb9-13"></a>l &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20170918_07601&quot;</span>) <span class="co"># last QC HILIC pos</span></span>
<span id="cb9-14"><a href="metabolomics-1.html#cb9-14"></a>raw_peaks[<span class="st">&quot;SD&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, sd)</span>
<span id="cb9-15"><a href="metabolomics-1.html#cb9-15"></a>raw_peaks[<span class="st">&quot;MEAN&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, mean)</span>
<span id="cb9-16"><a href="metabolomics-1.html#cb9-16"></a>raw_peaks[<span class="st">&quot;CV&quot;</span>] &lt;-<span class="st"> </span>raw_peaks<span class="op">$</span>SD<span class="op">/</span>raw_peaks<span class="op">$</span>MEAN</span>
<span id="cb9-17"><a href="metabolomics-1.html#cb9-17"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>CV<span class="op">&lt;</span><span class="fl">0.3</span>,]</span>
<span id="cb9-18"><a href="metabolomics-1.html#cb9-18"></a>hp_dim3 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb9-19"><a href="metabolomics-1.html#cb9-19"></a>hp_pcg3 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb9-20"><a href="metabolomics-1.html#cb9-20"></a><span class="co">#write.csv(raw_peaks, &quot;HILIC_pos_20190417_cleaned.csv&quot;)</span></span>
<span id="cb9-21"><a href="metabolomics-1.html#cb9-21"></a></span>
<span id="cb9-22"><a href="metabolomics-1.html#cb9-22"></a><span class="co"># Keep only the feature with the greatest sum of signal per pc group</span></span>
<span id="cb9-23"><a href="metabolomics-1.html#cb9-23"></a>l &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">6</span></span>
<span id="cb9-24"><a href="metabolomics-1.html#cb9-24"></a>raw_peaks[<span class="st">&quot;fss&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,<span class="dv">13</span><span class="op">:</span>l], <span class="dv">1</span>, sum) <span class="co">#feature signal sum</span></span>
<span id="cb9-25"><a href="metabolomics-1.html#cb9-25"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[<span class="kw">order</span>(raw_peaks<span class="op">$</span>pcgroup, <span class="op">-</span>raw_peaks<span class="op">$</span>fss),] </span>
<span id="cb9-26"><a href="metabolomics-1.html#cb9-26"></a><span class="co">#for every pc group, the first line has the strongest signal.</span></span>
<span id="cb9-27"><a href="metabolomics-1.html#cb9-27"></a><span class="co">#The function distinct() [dplyr package] can be used to keep only unique/distinct rows from a data frame. If there are duplicate rows, _only the first row_ is preserved. </span></span>
<span id="cb9-28"><a href="metabolomics-1.html#cb9-28"></a>selected_peaks &lt;-<span class="st"> </span><span class="kw">distinct</span>(raw_peaks, raw_peaks<span class="op">$</span>pcgroup, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-29"><a href="metabolomics-1.html#cb9-29"></a>hp_dim4 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb9-30"><a href="metabolomics-1.html#cb9-30"></a>hp_pcg4 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb9-31"><a href="metabolomics-1.html#cb9-31"></a><span class="co">#write.csv(selected_peaks, &quot;HILIC_pos_20190417_cleaned_pcgroup.csv&quot;)</span></span>
<span id="cb9-32"><a href="metabolomics-1.html#cb9-32"></a><span class="kw">rm</span>(selected_peaks)</span>
<span id="cb9-33"><a href="metabolomics-1.html#cb9-33"></a></span>
<span id="cb9-34"><a href="metabolomics-1.html#cb9-34"></a><span class="co"># Keep only features with explicit annotations of [M+H]+</span></span>
<span id="cb9-35"><a href="metabolomics-1.html#cb9-35"></a><span class="kw">library</span>(stringr)</span></code></pre></div>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 3.5.2</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="metabolomics-1.html#cb11-1"></a>raw_peaks[<span class="st">&quot;[M+H]+&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb11-2"><a href="metabolomics-1.html#cb11-2"></a>pattern &lt;-<span class="st"> &quot;[M+H]+&quot;</span></span>
<span id="cb11-3"><a href="metabolomics-1.html#cb11-3"></a>raw_peaks[<span class="st">&quot;[M+H]+&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_detect</span>(raw_peaks<span class="op">$</span>adduct, <span class="kw">paste0</span>(<span class="st">&quot;^</span><span class="ch">\\</span><span class="st">Q&quot;</span>,pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">E&quot;</span>))</span>
<span id="cb11-4"><a href="metabolomics-1.html#cb11-4"></a>selected_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span><span class="st">`</span><span class="dt">[M+H]+</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;TRUE&quot;</span>,]</span>
<span id="cb11-5"><a href="metabolomics-1.html#cb11-5"></a>hp_dim5 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-6"><a href="metabolomics-1.html#cb11-6"></a>hp_pcg5 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-7"><a href="metabolomics-1.html#cb11-7"></a><span class="co">#write.csv(selected_peaks, &quot;HILIC_pos_20190417_cleaned_MH.csv&quot;)</span></span>
<span id="cb11-8"><a href="metabolomics-1.html#cb11-8"></a></span>
<span id="cb11-9"><a href="metabolomics-1.html#cb11-9"></a>hilic_pos &lt;-<span class="st"> </span>raw_peaks</span>
<span id="cb11-10"><a href="metabolomics-1.html#cb11-10"></a><span class="kw">rm</span> (f, l, raw_peaks, selected_peaks)</span>
<span id="cb11-11"><a href="metabolomics-1.html#cb11-11"></a></span>
<span id="cb11-12"><a href="metabolomics-1.html#cb11-12"></a><span class="co">#================================ HILIC neg ===================================</span></span>
<span id="cb11-13"><a href="metabolomics-1.html#cb11-13"></a>raw_peaks &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;HILIC_neg_20190421.csv&quot;</span>)</span>
<span id="cb11-14"><a href="metabolomics-1.html#cb11-14"></a>hn_dim1 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-15"><a href="metabolomics-1.html#cb11-15"></a>hn_pcg1 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-16"><a href="metabolomics-1.html#cb11-16"></a></span>
<span id="cb11-17"><a href="metabolomics-1.html#cb11-17"></a><span class="co"># Removing features eluting in the void</span></span>
<span id="cb11-18"><a href="metabolomics-1.html#cb11-18"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>rt<span class="op">&gt;</span><span class="dv">45</span>,]</span>
<span id="cb11-19"><a href="metabolomics-1.html#cb11-19"></a>hn_dim2 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-20"><a href="metabolomics-1.html#cb11-20"></a>hn_pcg2 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-21"><a href="metabolomics-1.html#cb11-21"></a></span>
<span id="cb11-22"><a href="metabolomics-1.html#cb11-22"></a><span class="co"># Removing features with a CV &lt; 30%</span></span>
<span id="cb11-23"><a href="metabolomics-1.html#cb11-23"></a>f &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20170919_01301&quot;</span>) <span class="co"># first QC HILIC neg</span></span>
<span id="cb11-24"><a href="metabolomics-1.html#cb11-24"></a>l &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20170919_06901&quot;</span>) <span class="co"># last QC HILIC neg</span></span>
<span id="cb11-25"><a href="metabolomics-1.html#cb11-25"></a>raw_peaks[<span class="st">&quot;SD&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, sd)</span>
<span id="cb11-26"><a href="metabolomics-1.html#cb11-26"></a>raw_peaks[<span class="st">&quot;MEAN&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, mean)</span>
<span id="cb11-27"><a href="metabolomics-1.html#cb11-27"></a>raw_peaks[<span class="st">&quot;CV&quot;</span>] &lt;-<span class="st"> </span>raw_peaks<span class="op">$</span>SD<span class="op">/</span>raw_peaks<span class="op">$</span>MEAN</span>
<span id="cb11-28"><a href="metabolomics-1.html#cb11-28"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>CV<span class="op">&lt;</span><span class="fl">0.3</span>,]</span>
<span id="cb11-29"><a href="metabolomics-1.html#cb11-29"></a>hn_dim3 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-30"><a href="metabolomics-1.html#cb11-30"></a>hn_pcg3 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-31"><a href="metabolomics-1.html#cb11-31"></a><span class="co">#write.csv(raw_peaks, &quot;HILIC_neg_20190421_cleaned.csv&quot;)</span></span>
<span id="cb11-32"><a href="metabolomics-1.html#cb11-32"></a></span>
<span id="cb11-33"><a href="metabolomics-1.html#cb11-33"></a><span class="co"># Keep only the feature with the greatest sum of signal per pc group</span></span>
<span id="cb11-34"><a href="metabolomics-1.html#cb11-34"></a>l &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">6</span></span>
<span id="cb11-35"><a href="metabolomics-1.html#cb11-35"></a>raw_peaks[<span class="st">&quot;fss&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,<span class="dv">13</span><span class="op">:</span>l], <span class="dv">1</span>, sum) <span class="co">#feature signal sum</span></span>
<span id="cb11-36"><a href="metabolomics-1.html#cb11-36"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[<span class="kw">order</span>(raw_peaks<span class="op">$</span>pcgroup, <span class="op">-</span>raw_peaks<span class="op">$</span>fss),] </span>
<span id="cb11-37"><a href="metabolomics-1.html#cb11-37"></a>selected_peaks &lt;-<span class="st"> </span><span class="kw">distinct</span>(raw_peaks, raw_peaks<span class="op">$</span>pcgroup, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-38"><a href="metabolomics-1.html#cb11-38"></a>hn_dim4 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-39"><a href="metabolomics-1.html#cb11-39"></a>hn_pcg4 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-40"><a href="metabolomics-1.html#cb11-40"></a><span class="co">#write.csv(selected_peaks, &quot;HILIC_neg_20190421_cleaned_pcgroup.csv&quot;)</span></span>
<span id="cb11-41"><a href="metabolomics-1.html#cb11-41"></a><span class="kw">rm</span>(selected_peaks)</span>
<span id="cb11-42"><a href="metabolomics-1.html#cb11-42"></a></span>
<span id="cb11-43"><a href="metabolomics-1.html#cb11-43"></a><span class="co"># Keep only features with explicit annotations of [M-H]-</span></span>
<span id="cb11-44"><a href="metabolomics-1.html#cb11-44"></a><span class="kw">library</span>(stringr)</span>
<span id="cb11-45"><a href="metabolomics-1.html#cb11-45"></a>raw_peaks[<span class="st">&quot;[M-H]-&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb11-46"><a href="metabolomics-1.html#cb11-46"></a>pattern &lt;-<span class="st"> &quot;[M-H]-&quot;</span></span>
<span id="cb11-47"><a href="metabolomics-1.html#cb11-47"></a>raw_peaks[<span class="st">&quot;[M-H]-&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_detect</span>(raw_peaks<span class="op">$</span>adduct, <span class="kw">paste0</span>(<span class="st">&quot;^</span><span class="ch">\\</span><span class="st">Q&quot;</span>,pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">E&quot;</span>))</span>
<span id="cb11-48"><a href="metabolomics-1.html#cb11-48"></a>selected_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span><span class="st">`</span><span class="dt">[M-H]-</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;TRUE&quot;</span>,]</span>
<span id="cb11-49"><a href="metabolomics-1.html#cb11-49"></a>hn_dim5 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-50"><a href="metabolomics-1.html#cb11-50"></a>hn_pcg5 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-51"><a href="metabolomics-1.html#cb11-51"></a><span class="co">#write.csv(selected_peaks, &quot;HILIC_neg_20190421_cleaned_MH.csv&quot;)</span></span>
<span id="cb11-52"><a href="metabolomics-1.html#cb11-52"></a></span>
<span id="cb11-53"><a href="metabolomics-1.html#cb11-53"></a>hilic_neg &lt;-<span class="st"> </span>raw_peaks</span>
<span id="cb11-54"><a href="metabolomics-1.html#cb11-54"></a><span class="kw">rm</span> (f, l, raw_peaks)</span>
<span id="cb11-55"><a href="metabolomics-1.html#cb11-55"></a></span>
<span id="cb11-56"><a href="metabolomics-1.html#cb11-56"></a><span class="co">#================================== RP pos ====================================</span></span>
<span id="cb11-57"><a href="metabolomics-1.html#cb11-57"></a>raw_peaks &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;RP_pos_20190421.csv&quot;</span>)</span>
<span id="cb11-58"><a href="metabolomics-1.html#cb11-58"></a>rp_dim1 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-59"><a href="metabolomics-1.html#cb11-59"></a>rp_pcg1 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-60"><a href="metabolomics-1.html#cb11-60"></a></span>
<span id="cb11-61"><a href="metabolomics-1.html#cb11-61"></a><span class="co"># Removing features eluting in the void</span></span>
<span id="cb11-62"><a href="metabolomics-1.html#cb11-62"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>rt<span class="op">&gt;</span><span class="dv">45</span>,]</span>
<span id="cb11-63"><a href="metabolomics-1.html#cb11-63"></a>rp_dim2 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-64"><a href="metabolomics-1.html#cb11-64"></a>rp_pcg2 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-65"><a href="metabolomics-1.html#cb11-65"></a></span>
<span id="cb11-66"><a href="metabolomics-1.html#cb11-66"></a><span class="co"># Removing features with a CV &lt; 30%</span></span>
<span id="cb11-67"><a href="metabolomics-1.html#cb11-67"></a>f &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20171002_01401&quot;</span>) <span class="co"># first QC RP neg</span></span>
<span id="cb11-68"><a href="metabolomics-1.html#cb11-68"></a>l &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20171002_07201&quot;</span>) <span class="co"># last QC RP neg</span></span>
<span id="cb11-69"><a href="metabolomics-1.html#cb11-69"></a>raw_peaks[<span class="st">&quot;SD&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, sd)</span>
<span id="cb11-70"><a href="metabolomics-1.html#cb11-70"></a>raw_peaks[<span class="st">&quot;MEAN&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, mean)</span>
<span id="cb11-71"><a href="metabolomics-1.html#cb11-71"></a>raw_peaks[<span class="st">&quot;CV&quot;</span>] &lt;-<span class="st"> </span>raw_peaks<span class="op">$</span>SD<span class="op">/</span>raw_peaks<span class="op">$</span>MEAN</span>
<span id="cb11-72"><a href="metabolomics-1.html#cb11-72"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>CV<span class="op">&lt;</span><span class="fl">0.3</span>,]</span>
<span id="cb11-73"><a href="metabolomics-1.html#cb11-73"></a>rp_dim3 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-74"><a href="metabolomics-1.html#cb11-74"></a>rp_pcg3 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-75"><a href="metabolomics-1.html#cb11-75"></a><span class="co">#write.csv(raw_peaks, &quot;RP_pos_20190421_cleaned.csv&quot;)</span></span>
<span id="cb11-76"><a href="metabolomics-1.html#cb11-76"></a></span>
<span id="cb11-77"><a href="metabolomics-1.html#cb11-77"></a><span class="co"># Keep only the feature with the greatest sum of signal per pc group</span></span>
<span id="cb11-78"><a href="metabolomics-1.html#cb11-78"></a>l &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">6</span></span>
<span id="cb11-79"><a href="metabolomics-1.html#cb11-79"></a>raw_peaks[<span class="st">&quot;fss&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,<span class="dv">13</span><span class="op">:</span>l], <span class="dv">1</span>, sum) <span class="co">#feature signal sum</span></span>
<span id="cb11-80"><a href="metabolomics-1.html#cb11-80"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[<span class="kw">order</span>(raw_peaks<span class="op">$</span>pcgroup, <span class="op">-</span>raw_peaks<span class="op">$</span>fss),] </span>
<span id="cb11-81"><a href="metabolomics-1.html#cb11-81"></a>selected_peaks &lt;-<span class="st"> </span><span class="kw">distinct</span>(raw_peaks, raw_peaks<span class="op">$</span>pcgroup, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-82"><a href="metabolomics-1.html#cb11-82"></a>rp_dim4 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-83"><a href="metabolomics-1.html#cb11-83"></a>rp_pcg4 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-84"><a href="metabolomics-1.html#cb11-84"></a><span class="co">#write.csv(selected_peaks, &quot;RP_pos_20190421_cleaned_pcgroup.csv&quot;)</span></span>
<span id="cb11-85"><a href="metabolomics-1.html#cb11-85"></a><span class="kw">rm</span>(selected_peaks)</span>
<span id="cb11-86"><a href="metabolomics-1.html#cb11-86"></a></span>
<span id="cb11-87"><a href="metabolomics-1.html#cb11-87"></a><span class="co"># Keep only features with explicit annotations of [M+H]+</span></span>
<span id="cb11-88"><a href="metabolomics-1.html#cb11-88"></a><span class="kw">library</span>(stringr)</span>
<span id="cb11-89"><a href="metabolomics-1.html#cb11-89"></a>raw_peaks[<span class="st">&quot;[M+H]+&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb11-90"><a href="metabolomics-1.html#cb11-90"></a>pattern &lt;-<span class="st"> &quot;[M+H]+&quot;</span></span>
<span id="cb11-91"><a href="metabolomics-1.html#cb11-91"></a>raw_peaks[<span class="st">&quot;[M+H]+&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_detect</span>(raw_peaks<span class="op">$</span>adduct, <span class="kw">paste0</span>(<span class="st">&quot;^</span><span class="ch">\\</span><span class="st">Q&quot;</span>,pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">E&quot;</span>))</span>
<span id="cb11-92"><a href="metabolomics-1.html#cb11-92"></a>selected_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span><span class="st">`</span><span class="dt">[M+H]+</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;TRUE&quot;</span>,]</span>
<span id="cb11-93"><a href="metabolomics-1.html#cb11-93"></a>rp_dim5 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-94"><a href="metabolomics-1.html#cb11-94"></a>rp_pcg5 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-95"><a href="metabolomics-1.html#cb11-95"></a><span class="co">#write.csv(selected_peaks, &quot;RP_pos_20190421_cleaned_MH.csv&quot;)</span></span>
<span id="cb11-96"><a href="metabolomics-1.html#cb11-96"></a></span>
<span id="cb11-97"><a href="metabolomics-1.html#cb11-97"></a>rp_pos &lt;-<span class="st"> </span>raw_peaks</span>
<span id="cb11-98"><a href="metabolomics-1.html#cb11-98"></a><span class="kw">rm</span> (f, l, raw_peaks, selected_peaks)</span>
<span id="cb11-99"><a href="metabolomics-1.html#cb11-99"></a></span>
<span id="cb11-100"><a href="metabolomics-1.html#cb11-100"></a><span class="co">#================================== RP neg ====================================</span></span>
<span id="cb11-101"><a href="metabolomics-1.html#cb11-101"></a>raw_peaks &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;RP_neg_20190422.csv&quot;</span>)</span>
<span id="cb11-102"><a href="metabolomics-1.html#cb11-102"></a>rn_dim1 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-103"><a href="metabolomics-1.html#cb11-103"></a>rn_pcg1 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-104"><a href="metabolomics-1.html#cb11-104"></a></span>
<span id="cb11-105"><a href="metabolomics-1.html#cb11-105"></a><span class="co"># Removing features eluting in the void</span></span>
<span id="cb11-106"><a href="metabolomics-1.html#cb11-106"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>rt<span class="op">&gt;</span><span class="dv">45</span>,]</span>
<span id="cb11-107"><a href="metabolomics-1.html#cb11-107"></a>rn_dim2 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-108"><a href="metabolomics-1.html#cb11-108"></a>rn_pcg2 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-109"><a href="metabolomics-1.html#cb11-109"></a></span>
<span id="cb11-110"><a href="metabolomics-1.html#cb11-110"></a><span class="co"># Removing features with a CV &lt; 30%</span></span>
<span id="cb11-111"><a href="metabolomics-1.html#cb11-111"></a>f &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20171003_01301&quot;</span>) <span class="co"># first QC RP neg</span></span>
<span id="cb11-112"><a href="metabolomics-1.html#cb11-112"></a>l &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">colnames</span>(raw_peaks)<span class="op">==</span><span class="st">&quot;IE_20171003_05701&quot;</span>) <span class="co"># 3rd last QC RP neg; QC empty after this injection</span></span>
<span id="cb11-113"><a href="metabolomics-1.html#cb11-113"></a>raw_peaks[<span class="st">&quot;SD&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, sd)</span>
<span id="cb11-114"><a href="metabolomics-1.html#cb11-114"></a>raw_peaks[<span class="st">&quot;MEAN&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,f<span class="op">:</span>l], <span class="dv">1</span>, mean)</span>
<span id="cb11-115"><a href="metabolomics-1.html#cb11-115"></a>raw_peaks[<span class="st">&quot;CV&quot;</span>] &lt;-<span class="st"> </span>raw_peaks<span class="op">$</span>SD<span class="op">/</span>raw_peaks<span class="op">$</span>MEAN</span>
<span id="cb11-116"><a href="metabolomics-1.html#cb11-116"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span>CV<span class="op">&lt;</span><span class="fl">0.3</span>,]</span>
<span id="cb11-117"><a href="metabolomics-1.html#cb11-117"></a>rn_dim3 &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-118"><a href="metabolomics-1.html#cb11-118"></a>rn_pcg3 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(raw_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-119"><a href="metabolomics-1.html#cb11-119"></a><span class="co">#write.csv(raw_peaks, &quot;RP_neg_20190422_cleaned.csv&quot;)</span></span>
<span id="cb11-120"><a href="metabolomics-1.html#cb11-120"></a></span>
<span id="cb11-121"><a href="metabolomics-1.html#cb11-121"></a><span class="co"># Keep only the feature with the greatest sum of signal per pc group</span></span>
<span id="cb11-122"><a href="metabolomics-1.html#cb11-122"></a>l &lt;-<span class="st"> </span><span class="kw">dim</span>(raw_peaks)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">6</span></span>
<span id="cb11-123"><a href="metabolomics-1.html#cb11-123"></a>raw_peaks[<span class="st">&quot;fss&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(raw_peaks[,<span class="dv">13</span><span class="op">:</span>l], <span class="dv">1</span>, sum) <span class="co">#feature signal sum</span></span>
<span id="cb11-124"><a href="metabolomics-1.html#cb11-124"></a>raw_peaks &lt;-<span class="st"> </span>raw_peaks[<span class="kw">order</span>(raw_peaks<span class="op">$</span>pcgroup, <span class="op">-</span>raw_peaks<span class="op">$</span>fss),] </span>
<span id="cb11-125"><a href="metabolomics-1.html#cb11-125"></a>selected_peaks &lt;-<span class="st"> </span><span class="kw">distinct</span>(raw_peaks, raw_peaks<span class="op">$</span>pcgroup, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-126"><a href="metabolomics-1.html#cb11-126"></a>rn_dim4 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-127"><a href="metabolomics-1.html#cb11-127"></a>rn_pcg4 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-128"><a href="metabolomics-1.html#cb11-128"></a><span class="co">#write.csv(selected_peaks, &quot;RP_neg_20190422_cleaned_pcgroup.csv&quot;)</span></span>
<span id="cb11-129"><a href="metabolomics-1.html#cb11-129"></a><span class="kw">rm</span>(selected_peaks)</span>
<span id="cb11-130"><a href="metabolomics-1.html#cb11-130"></a></span>
<span id="cb11-131"><a href="metabolomics-1.html#cb11-131"></a><span class="co"># Keep only features with explicit annotations of [M-H]-</span></span>
<span id="cb11-132"><a href="metabolomics-1.html#cb11-132"></a><span class="kw">library</span>(stringr)</span>
<span id="cb11-133"><a href="metabolomics-1.html#cb11-133"></a>raw_peaks[<span class="st">&quot;[M-H]-&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb11-134"><a href="metabolomics-1.html#cb11-134"></a>pattern &lt;-<span class="st"> &quot;[M-H]-&quot;</span></span>
<span id="cb11-135"><a href="metabolomics-1.html#cb11-135"></a>raw_peaks[<span class="st">&quot;[M-H]-&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_detect</span>(raw_peaks<span class="op">$</span>adduct, <span class="kw">paste0</span>(<span class="st">&quot;^</span><span class="ch">\\</span><span class="st">Q&quot;</span>,pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">E&quot;</span>))</span>
<span id="cb11-136"><a href="metabolomics-1.html#cb11-136"></a>selected_peaks &lt;-<span class="st"> </span>raw_peaks[raw_peaks<span class="op">$</span><span class="st">`</span><span class="dt">[M-H]-</span><span class="st">`</span><span class="op">==</span><span class="st">&quot;TRUE&quot;</span>,]</span>
<span id="cb11-137"><a href="metabolomics-1.html#cb11-137"></a>rn_dim5 &lt;-<span class="st"> </span><span class="kw">dim</span>(selected_peaks)[<span class="dv">1</span>]</span>
<span id="cb11-138"><a href="metabolomics-1.html#cb11-138"></a>rn_pcg5 &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(selected_peaks<span class="op">$</span>pcgroup))</span>
<span id="cb11-139"><a href="metabolomics-1.html#cb11-139"></a><span class="co">#write.csv(selected_peaks, &quot;RP_neg_20190422_cleaned_MH.csv&quot;)</span></span>
<span id="cb11-140"><a href="metabolomics-1.html#cb11-140"></a></span>
<span id="cb11-141"><a href="metabolomics-1.html#cb11-141"></a>hilic_neg &lt;-<span class="st"> </span>raw_peaks</span>
<span id="cb11-142"><a href="metabolomics-1.html#cb11-142"></a><span class="kw">rm</span> (f, l, raw_peaks, selected_peaks)</span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">3.3</span> Summary</h2>
<p>Below we outline the number of features removed in every step as shown in the table and corresponding figure.</p>
<pre><code>## 
## Attaching package: &#39;kableExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     group_rows</code></pre>
<p>\begin{longtable}[t]{lrrrrrrrrrr}
\caption{(#tab:kable_table)Number of features and pc groups
remaining after each filtering step.}\

 &amp;  &amp;  \
(l{3pt}r{3pt}){2-6} (l{3pt}r{3pt}){7-11}
&amp; initial &amp; RT &gt;45 s &amp; CV &lt;30% &amp; repr. feat. &amp; ion &amp; initial &amp; RT &gt;45 s &amp; CV &lt;30% &amp; repr. feat. &amp; ion\

HILIC pos &amp; 5113 &amp; 4389 &amp; 3507 &amp; 2212 &amp; 105 &amp; 3298 &amp; 2781 &amp; 2212 &amp; 2212 &amp; 79\
HILIC neg &amp; 4049 &amp; 3081 &amp; 2808 &amp; 1351 &amp; 123 &amp; 2044 &amp; 1495 &amp; 1351 &amp; 1351 &amp; 62\
RP pos &amp; 5821 &amp; 5588 &amp; 4673 &amp; 2736 &amp; 171 &amp; 3420 &amp; 3277 &amp; 2736 &amp; 2736 &amp; 128\
RP neg &amp; 3867 &amp; 3621 &amp; 3166 &amp; 1678 &amp; 105 &amp; 2069 &amp; 1918 &amp; 1678 &amp; 1678 &amp; 80\

\end{longtable}</p>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.5.2</code></pre>
<p><img src="Water-masses-influence-microbiome-and-metabolome-in-deep-sea-sponges_files/figure-html/kable_table-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>After preliminary analyses of metabolomics data, a few outliers were re-identified by P. Cárdenas, and one specimen was removed from the data set as it originated from another species.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="metabolomics-1.html#cb15-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.14.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggplot2_3.2.1         reshape2_1.4.3        kableExtra_1.1.0.9000
## [4] stringr_1.4.0         dplyr_0.8.3          
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.3        plyr_1.8.5        pillar_1.4.3      compiler_3.5.1   
##  [5] tools_3.5.1       zeallot_0.1.0     digest_0.6.23     gtable_0.3.0     
##  [9] evaluate_0.14     tibble_2.1.3      lifecycle_0.1.0   viridisLite_0.3.0
## [13] pkgconfig_2.0.3   rlang_0.4.2       rstudioapi_0.10   yaml_2.2.0       
## [17] xfun_0.12         withr_2.1.2       httr_1.4.1        knitr_1.26       
## [21] xml2_1.2.2        vctrs_0.2.1       hms_0.5.3         grid_3.5.1       
## [25] webshot_0.5.2     tidyselect_0.2.5  glue_1.3.1        R6_2.4.1         
## [29] rmarkdown_2.0     bookdown_0.17     farver_2.0.1      readr_1.3.1      
## [33] purrr_0.3.3       magrittr_1.5      backports_1.1.5   scales_1.1.0     
## [37] htmltools_0.4.0   assertthat_0.2.1  rvest_0.3.5       colorspace_1.4-1 
## [41] stringi_1.4.5     lazyeval_0.2.2    munsell_0.5.0     crayon_1.3.4</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metabolomics.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Water masses influence microbiome and metabolome in deep-sea sponges.pdf", "Water masses influence microbiome and metabolome in deep-sea sponges.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
