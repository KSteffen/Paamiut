<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges</title>
  <meta name="description" content="4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges" />
  
  
  

<meta name="author" content="Karin Steffen" />


<meta name="date" content="2020-04-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="microbiota.html"/>
<link rel="next" href="funding-disclaimer.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SUPPLEMENTARY MATERIAL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Content</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#experimental-setup"><i class="fa fa-check"></i><b>1.1</b> Experimental setup</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#map"><i class="fa fa-check"></i><b>1.1.1</b> Map</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#water-masses"><i class="fa fa-check"></i><b>1.1.2</b> Water masses</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#sponges"><i class="fa fa-check"></i><b>1.1.3</b> Sponges</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sample-metadata-analysis"><i class="fa fa-check"></i><b>1.2</b> Sample metadata analysis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#correlations-visual-inspection-and-variance-inflation-factors-vif-across-all-samples"><i class="fa fa-check"></i><b>1.2.1</b> Correlations, visual inspection and variance inflation factors (VIF) across all samples</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#correlations-visual-inspection-and-variance-inflation-factors-vif-across-g.-barretti-samples"><i class="fa fa-check"></i><b>1.2.2</b> Correlations, visual inspection and variance inflation factors (VIF) across <em>G. barretti</em> samples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="metabolomics.html"><a href="metabolomics.html"><i class="fa fa-check"></i><b>2</b> Metabolomics</a><ul>
<li class="chapter" data-level="2.1" data-path="metabolomics.html"><a href="metabolomics.html#experimental-methods-and-detailed-description"><i class="fa fa-check"></i><b>2.1</b> Experimental methods and detailed description</a></li>
<li class="chapter" data-level="2.2" data-path="metabolomics.html"><a href="metabolomics.html#data-processing"><i class="fa fa-check"></i><b>2.2</b> Data processing</a><ul>
<li class="chapter" data-level="2.2.1" data-path="metabolomics.html"><a href="metabolomics.html#peak-picking-with-xcms-and-annotation-with-camera"><i class="fa fa-check"></i><b>2.2.1</b> Peak picking with XCMS and annotation with CAMERA</a></li>
<li class="chapter" data-level="2.2.2" data-path="metabolomics.html"><a href="metabolomics.html#hilic-hydrophilic-interaction-chromatography-column-with-positive-esi-electron-spray-ionisation"><i class="fa fa-check"></i><b>2.2.2</b> HILIC (Hydrophilic interaction chromatography) column with positive ESI (electron spray ionisation)</a></li>
<li class="chapter" data-level="2.2.3" data-path="metabolomics.html"><a href="metabolomics.html#hilic-chromatography-with-negative-esi"><i class="fa fa-check"></i><b>2.2.3</b> HILIC Chromatography with negative ESI</a></li>
<li class="chapter" data-level="2.2.4" data-path="metabolomics.html"><a href="metabolomics.html#rp-reversed-phase-chromatography-with-positive-esi"><i class="fa fa-check"></i><b>2.2.4</b> RP (Reversed phase) Chromatography with positive ESI</a></li>
<li class="chapter" data-level="2.2.5" data-path="metabolomics.html"><a href="metabolomics.html#rp-chromatography-with-negative-esi"><i class="fa fa-check"></i><b>2.2.5</b> RP Chromatography with negative ESI</a></li>
<li class="chapter" data-level="2.2.6" data-path="metabolomics.html"><a href="metabolomics.html#filtering-of-the-raw-data-set"><i class="fa fa-check"></i><b>2.2.6</b> Filtering of the raw data set</a></li>
<li class="chapter" data-level="2.2.7" data-path="metabolomics.html"><a href="metabolomics.html#data-quality-control"><i class="fa fa-check"></i><b>2.2.7</b> Data quality control</a></li>
<li class="chapter" data-level="2.2.8" data-path="metabolomics.html"><a href="metabolomics.html#summary-of-data-processing"><i class="fa fa-check"></i><b>2.2.8</b> Summary of data processing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="metabolomics.html"><a href="metabolomics.html#multivariate-analyses"><i class="fa fa-check"></i><b>2.3</b> Multivariate analyses</a></li>
<li class="chapter" data-level="2.4" data-path="metabolomics.html"><a href="metabolomics.html#vips"><i class="fa fa-check"></i><b>2.4</b> VIPS</a></li>
<li class="chapter" data-level="2.5" data-path="metabolomics.html"><a href="metabolomics.html#manual-annotation-identification-and-extraction-of-metabolic-feature-signals"><i class="fa fa-check"></i><b>2.5</b> Manual annotation, identification and extraction of metabolic feature signals</a></li>
<li class="chapter" data-level="2.6" data-path="metabolomics.html"><a href="metabolomics.html#chromatorgrams"><i class="fa fa-check"></i><b>2.6</b> Chromatorgrams</a></li>
<li class="chapter" data-level="2.7" data-path="metabolomics.html"><a href="metabolomics.html#correlations"><i class="fa fa-check"></i><b>2.7</b> Correlations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="microbiota.html"><a href="microbiota.html"><i class="fa fa-check"></i><b>3</b> Microbiota</a><ul>
<li class="chapter" data-level="3.1" data-path="microbiota.html"><a href="microbiota.html#functions"><i class="fa fa-check"></i><b>3.1</b> Functions</a></li>
<li class="chapter" data-level="3.2" data-path="microbiota.html"><a href="microbiota.html#relative-abundance"><i class="fa fa-check"></i><b>3.2</b> Relative abundance</a></li>
<li class="chapter" data-level="3.3" data-path="microbiota.html"><a href="microbiota.html#data-set-description"><i class="fa fa-check"></i><b>3.3</b> Data set description</a></li>
<li class="chapter" data-level="3.4" data-path="microbiota.html"><a href="microbiota.html#depth-response"><i class="fa fa-check"></i><b>3.4</b> Depth response</a></li>
<li class="chapter" data-level="3.5" data-path="microbiota.html"><a href="microbiota.html#shortlist"><i class="fa fa-check"></i><b>3.5</b> Shortlist</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inter-omics.html"><a href="inter-omics.html"><i class="fa fa-check"></i><b>4</b> Inter-omics</a><ul>
<li class="chapter" data-level="4.1" data-path="inter-omics.html"><a href="inter-omics.html#mantel-test-and-procrustes-rotations"><i class="fa fa-check"></i><b>4.1</b> Mantel test and procrustes rotations</a><ul>
<li class="chapter" data-level="4.1.1" data-path="inter-omics.html"><a href="inter-omics.html#libraries-and-functions"><i class="fa fa-check"></i><b>4.1.1</b> Libraries and functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="inter-omics.html"><a href="inter-omics.html#data-sets"><i class="fa fa-check"></i><b>4.1.2</b> Data sets</a></li>
<li class="chapter" data-level="4.1.3" data-path="inter-omics.html"><a href="inter-omics.html#mantel-test-code-and-tabular-output"><i class="fa fa-check"></i><b>4.1.3</b> Mantel test code and tabular output</a></li>
<li class="chapter" data-level="4.1.4" data-path="inter-omics.html"><a href="inter-omics.html#procrustes-rotation-and-protest-code-and-tabular-output"><i class="fa fa-check"></i><b>4.1.4</b> Procrustes rotation and protest code and tabular output</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="inter-omics.html"><a href="inter-omics.html#microbial-interaction-network"><i class="fa fa-check"></i><b>4.2</b> Microbial interaction network</a><ul>
<li class="chapter" data-level="4.2.1" data-path="inter-omics.html"><a href="inter-omics.html#generating-network-based-on-different-algorithms"><i class="fa fa-check"></i><b>4.2.1</b> Generating network based on different algorithms</a></li>
<li class="chapter" data-level="4.2.2" data-path="inter-omics.html"><a href="inter-omics.html#consolidation-of-the-different-networks"><i class="fa fa-check"></i><b>4.2.2</b> Consolidation of the different networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="funding-disclaimer.html"><a href="funding-disclaimer.html"><i class="fa fa-check"></i><b>5</b> Funding disclaimer</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inter-omics" class="section level1">
<h1><span class="header-section-number">4</span> Inter-omics</h1>
<p>The inter-omics analyses are comprised of three parts. In the first part, we evaluate congruency of the prokaryotic and metabolomic data set as a whole using numerical methods (Mantel test) and ordination (Procrustes rotation and Protest). The second part consists of generating a microbial interaction network and annotating it with depth response of the OTUs and correlation with the barettin signal. In the third part, we rank OTUs based on properties hypothesised to be true forthe producer of barettin.</p>
<div id="mantel-test-and-procrustes-rotations" class="section level2">
<h2><span class="header-section-number">4.1</span> Mantel test and procrustes rotations</h2>
<div id="libraries-and-functions" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Libraries and functions</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="inter-omics.html#cb94-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb94-2"><a href="inter-omics.html#cb94-2"></a><span class="kw">library</span>(vegan)</span>
<span id="cb94-3"><a href="inter-omics.html#cb94-3"></a><span class="kw">library</span>(kableExtra)</span>
<span id="cb94-4"><a href="inter-omics.html#cb94-4"></a></span>
<span id="cb94-5"><a href="inter-omics.html#cb94-5"></a><span class="co">############# FUNCTIONS #</span></span>
<span id="cb94-6"><a href="inter-omics.html#cb94-6"></a></span>
<span id="cb94-7"><a href="inter-omics.html#cb94-7"></a><span class="co"># Prepare dataframes aka &#39;data gymnastics&#39;. The output is a list with the three data set per experiment for the</span></span>
<span id="cb94-8"><a href="inter-omics.html#cb94-8"></a><span class="co"># three different species gb, sf, wb</span></span>
<span id="cb94-9"><a href="inter-omics.html#cb94-9"></a>gymnastics &lt;-<span class="st"> </span><span class="cf">function</span>(df, my_colnames) {</span>
<span id="cb94-10"><a href="inter-omics.html#cb94-10"></a>    df[, <span class="kw">c</span>(<span class="st">&quot;df.1&quot;</span>, <span class="st">&quot;df&quot;</span>, <span class="st">&quot;mz&quot;</span>, <span class="st">&quot;mzmin&quot;</span>, <span class="st">&quot;mzmadf&quot;</span>, <span class="st">&quot;rt&quot;</span>, <span class="st">&quot;rtmin&quot;</span>, <span class="st">&quot;rtmadf&quot;</span>, <span class="st">&quot;npeaks&quot;</span>, <span class="st">&quot;Gb&quot;</span>, <span class="st">&quot;QC&quot;</span>, <span class="st">&quot;Sf&quot;</span>, <span class="st">&quot;Wb&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb94-11"><a href="inter-omics.html#cb94-11"></a>    df[, <span class="kw">c</span>(<span class="st">&quot;isotopes&quot;</span>, <span class="st">&quot;adduct&quot;</span>, <span class="st">&quot;pcgroup&quot;</span>, <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;MEAN&quot;</span>, <span class="st">&quot;CV&quot;</span>, <span class="st">&quot;fss&quot;</span>, <span class="st">&quot;df.M.H..&quot;</span>, <span class="st">&quot;raw_peaks.pcgroup&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb94-12"><a href="inter-omics.html#cb94-12"></a>    df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(df))</span>
<span id="cb94-13"><a href="inter-omics.html#cb94-13"></a>    df[<span class="st">&quot;ID&quot;</span>] &lt;-<span class="st"> </span><span class="kw">rownames</span>(df)</span>
<span id="cb94-14"><a href="inter-omics.html#cb94-14"></a>    df[<span class="st">&quot;unified_ID&quot;</span>] &lt;-<span class="st"> </span>masslynx<span class="op">$</span>unified_ID[<span class="kw">match</span>(df<span class="op">$</span>ID, masslynx[[my_colnames]])]</span>
<span id="cb94-15"><a href="inter-omics.html#cb94-15"></a>    df &lt;-<span class="st"> </span><span class="kw">na.omit</span>(df)</span>
<span id="cb94-16"><a href="inter-omics.html#cb94-16"></a>    df &lt;-<span class="st"> </span>df[<span class="kw">order</span>(df<span class="op">$</span>unified_ID), ]</span>
<span id="cb94-17"><a href="inter-omics.html#cb94-17"></a>    <span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>df<span class="op">$</span>unified_ID</span>
<span id="cb94-18"><a href="inter-omics.html#cb94-18"></a>    df[<span class="st">&quot;spec&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(df<span class="op">$</span>unified_ID, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb94-19"><a href="inter-omics.html#cb94-19"></a>    df &lt;-<span class="st"> </span>df[<span class="op">!</span>df<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;QC&quot;</span>, ]</span>
<span id="cb94-20"><a href="inter-omics.html#cb94-20"></a>    df[, <span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;unified_ID&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb94-21"><a href="inter-omics.html#cb94-21"></a>    df_gb &lt;-<span class="st"> </span>df[df<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;Gb&quot;</span>, ]</span>
<span id="cb94-22"><a href="inter-omics.html#cb94-22"></a>    df_sf &lt;-<span class="st"> </span>df[df<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;Sf&quot;</span>, ]</span>
<span id="cb94-23"><a href="inter-omics.html#cb94-23"></a>    df_wb &lt;-<span class="st"> </span>df[df<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;Wb&quot;</span>, ]</span>
<span id="cb94-24"><a href="inter-omics.html#cb94-24"></a>    df_gb<span class="op">$</span>spec &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb94-25"><a href="inter-omics.html#cb94-25"></a>    df_sf<span class="op">$</span>spec &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb94-26"><a href="inter-omics.html#cb94-26"></a>    df_wb<span class="op">$</span>spec &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb94-27"><a href="inter-omics.html#cb94-27"></a>    <span class="co"># ready for mantel</span></span>
<span id="cb94-28"><a href="inter-omics.html#cb94-28"></a>    metabolome &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">gb =</span> df_gb, <span class="dt">sf =</span> df_sf, <span class="dt">wb =</span> df_wb)</span>
<span id="cb94-29"><a href="inter-omics.html#cb94-29"></a>    <span class="kw">return</span>(metabolome)</span>
<span id="cb94-30"><a href="inter-omics.html#cb94-30"></a>}</span>
<span id="cb94-31"><a href="inter-omics.html#cb94-31"></a></span>
<span id="cb94-32"><a href="inter-omics.html#cb94-32"></a><span class="co"># Prepares the microbiome data sets to match the metabolomes. The output is a list with all microbiomes and</span></span>
<span id="cb94-33"><a href="inter-omics.html#cb94-33"></a><span class="co"># metabolomes</span></span>
<span id="cb94-34"><a href="inter-omics.html#cb94-34"></a>congruency &lt;-<span class="st"> </span><span class="cf">function</span>(metabolomes) {</span>
<span id="cb94-35"><a href="inter-omics.html#cb94-35"></a>    metabolome_gb &lt;-<span class="st"> </span>metabolomes<span class="op">$</span>gb</span>
<span id="cb94-36"><a href="inter-omics.html#cb94-36"></a>    metabolome_sf &lt;-<span class="st"> </span>metabolomes<span class="op">$</span>sf</span>
<span id="cb94-37"><a href="inter-omics.html#cb94-37"></a>    metabolome_wb &lt;-<span class="st"> </span>metabolomes<span class="op">$</span>wb</span>
<span id="cb94-38"><a href="inter-omics.html#cb94-38"></a>    </span>
<span id="cb94-39"><a href="inter-omics.html#cb94-39"></a>    micro_gb &lt;-<span class="st"> </span>micro[micro<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;Gb&quot;</span>, ]</span>
<span id="cb94-40"><a href="inter-omics.html#cb94-40"></a>    micro_sf &lt;-<span class="st"> </span>micro[micro<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;Sf&quot;</span>, ]</span>
<span id="cb94-41"><a href="inter-omics.html#cb94-41"></a>    micro_wb &lt;-<span class="st"> </span>micro[micro<span class="op">$</span>spec <span class="op">==</span><span class="st"> &quot;Wb&quot;</span>, ]</span>
<span id="cb94-42"><a href="inter-omics.html#cb94-42"></a>    </span>
<span id="cb94-43"><a href="inter-omics.html#cb94-43"></a>    micro_gb[, <span class="kw">c</span>(<span class="st">&quot;spec&quot;</span>, <span class="st">&quot;unified_ID&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb94-44"><a href="inter-omics.html#cb94-44"></a>    micro_sf[, <span class="kw">c</span>(<span class="st">&quot;spec&quot;</span>, <span class="st">&quot;unified_ID&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb94-45"><a href="inter-omics.html#cb94-45"></a>    micro_wb[, <span class="kw">c</span>(<span class="st">&quot;spec&quot;</span>, <span class="st">&quot;unified_ID&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb94-46"><a href="inter-omics.html#cb94-46"></a>    </span>
<span id="cb94-47"><a href="inter-omics.html#cb94-47"></a>    micro_gb &lt;-<span class="st"> </span>micro_gb[, <span class="kw">colSums</span>(micro_gb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb94-48"><a href="inter-omics.html#cb94-48"></a>    micro_sf &lt;-<span class="st"> </span>micro_sf[, <span class="kw">colSums</span>(micro_sf <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb94-49"><a href="inter-omics.html#cb94-49"></a>    micro_wb &lt;-<span class="st"> </span>micro_wb[, <span class="kw">colSums</span>(micro_wb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb94-50"><a href="inter-omics.html#cb94-50"></a>    </span>
<span id="cb94-51"><a href="inter-omics.html#cb94-51"></a>    micro_gb &lt;-<span class="st"> </span><span class="kw">sqrt</span>(micro_gb)</span>
<span id="cb94-52"><a href="inter-omics.html#cb94-52"></a>    micro_sf &lt;-<span class="st"> </span><span class="kw">sqrt</span>(micro_sf)</span>
<span id="cb94-53"><a href="inter-omics.html#cb94-53"></a>    micro_wb &lt;-<span class="st"> </span><span class="kw">sqrt</span>(micro_wb)</span>
<span id="cb94-54"><a href="inter-omics.html#cb94-54"></a>    </span>
<span id="cb94-55"><a href="inter-omics.html#cb94-55"></a>    micro_gb &lt;-<span class="st"> </span><span class="kw">wisconsin</span>(micro_gb)</span>
<span id="cb94-56"><a href="inter-omics.html#cb94-56"></a>    micro_sf &lt;-<span class="st"> </span><span class="kw">wisconsin</span>(micro_sf)</span>
<span id="cb94-57"><a href="inter-omics.html#cb94-57"></a>    micro_wb &lt;-<span class="st"> </span><span class="kw">wisconsin</span>(micro_wb)</span>
<span id="cb94-58"><a href="inter-omics.html#cb94-58"></a>    </span>
<span id="cb94-59"><a href="inter-omics.html#cb94-59"></a>    micro_gb &lt;-<span class="st"> </span>micro_gb[<span class="kw">rownames</span>(micro_gb) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(metabolome_gb), ]</span>
<span id="cb94-60"><a href="inter-omics.html#cb94-60"></a>    metabolome_gb &lt;-<span class="st"> </span>metabolome_gb[<span class="kw">rownames</span>(metabolome_gb) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(micro_gb), ]</span>
<span id="cb94-61"><a href="inter-omics.html#cb94-61"></a>    <span class="kw">all</span>(<span class="kw">rownames</span>(micro_gb) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(metabolome_gb))</span>
<span id="cb94-62"><a href="inter-omics.html#cb94-62"></a>    </span>
<span id="cb94-63"><a href="inter-omics.html#cb94-63"></a>    micro_sf &lt;-<span class="st"> </span>micro_sf[<span class="kw">rownames</span>(micro_sf) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(metabolome_sf), ]</span>
<span id="cb94-64"><a href="inter-omics.html#cb94-64"></a>    metabolome_sf &lt;-<span class="st"> </span>metabolome_sf[<span class="kw">rownames</span>(metabolome_sf) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(micro_sf), ]</span>
<span id="cb94-65"><a href="inter-omics.html#cb94-65"></a>    <span class="kw">all</span>(<span class="kw">rownames</span>(micro_sf) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(metabolome_sf))</span>
<span id="cb94-66"><a href="inter-omics.html#cb94-66"></a>    </span>
<span id="cb94-67"><a href="inter-omics.html#cb94-67"></a>    micro_wb &lt;-<span class="st"> </span>micro_wb[<span class="kw">rownames</span>(micro_wb) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(metabolome_wb), ]</span>
<span id="cb94-68"><a href="inter-omics.html#cb94-68"></a>    metabolome_wb &lt;-<span class="st"> </span>metabolome_wb[<span class="kw">rownames</span>(metabolome_wb) <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(micro_wb), ]</span>
<span id="cb94-69"><a href="inter-omics.html#cb94-69"></a>    <span class="kw">all</span>(<span class="kw">rownames</span>(micro_wb) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(metabolome_wb))</span>
<span id="cb94-70"><a href="inter-omics.html#cb94-70"></a>    </span>
<span id="cb94-71"><a href="inter-omics.html#cb94-71"></a>    congruent_dfs &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">micro_gb =</span> micro_gb, <span class="dt">micro_sf =</span> micro_sf, <span class="dt">micro_wb =</span> micro_wb, <span class="dt">metabolome_gb =</span> metabolome_gb, </span>
<span id="cb94-72"><a href="inter-omics.html#cb94-72"></a>        <span class="dt">metabolome_sf =</span> metabolome_sf, <span class="dt">metabolome_wb =</span> metabolome_wb)</span>
<span id="cb94-73"><a href="inter-omics.html#cb94-73"></a>    <span class="kw">return</span>(congruent_dfs)</span>
<span id="cb94-74"><a href="inter-omics.html#cb94-74"></a>}</span>
<span id="cb94-75"><a href="inter-omics.html#cb94-75"></a></span>
<span id="cb94-76"><a href="inter-omics.html#cb94-76"></a><span class="co"># MANTEL </span><span class="al">TEST</span><span class="co"> Generates distance matrices &#39;Bray-Curtis&#39; for microbiome, scaled &#39;euclidean&#39; for metabolomes, runs a</span></span>
<span id="cb94-77"><a href="inter-omics.html#cb94-77"></a><span class="co"># Mantel test with Spearman correlation, and saves the parameters to a data frame.</span></span>
<span id="cb94-78"><a href="inter-omics.html#cb94-78"></a>cloak &lt;-<span class="st"> </span><span class="cf">function</span>(congruent_dfs, experiment, filtering) {</span>
<span id="cb94-79"><a href="inter-omics.html#cb94-79"></a>    gb_meta_dist &lt;-<span class="st"> </span><span class="kw">vegdist</span>(<span class="kw">scale</span>(congruent_dfs<span class="op">$</span>metabolome_gb), <span class="st">&quot;euclid&quot;</span>)</span>
<span id="cb94-80"><a href="inter-omics.html#cb94-80"></a>    micro_gb_dist &lt;-<span class="st"> </span><span class="kw">vegdist</span>(congruent_dfs<span class="op">$</span>micro_gb, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb94-81"><a href="inter-omics.html#cb94-81"></a>    </span>
<span id="cb94-82"><a href="inter-omics.html#cb94-82"></a>    sf_meta_dist &lt;-<span class="st"> </span><span class="kw">vegdist</span>(<span class="kw">scale</span>(congruent_dfs<span class="op">$</span>metabolome_sf), <span class="st">&quot;euclid&quot;</span>)</span>
<span id="cb94-83"><a href="inter-omics.html#cb94-83"></a>    micro_sf_dist &lt;-<span class="st"> </span><span class="kw">vegdist</span>(congruent_dfs<span class="op">$</span>micro_sf, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb94-84"><a href="inter-omics.html#cb94-84"></a>    </span>
<span id="cb94-85"><a href="inter-omics.html#cb94-85"></a>    wb_meta_dist &lt;-<span class="st"> </span><span class="kw">vegdist</span>(<span class="kw">scale</span>(congruent_dfs<span class="op">$</span>metabolome_wb), <span class="st">&quot;euclid&quot;</span>)</span>
<span id="cb94-86"><a href="inter-omics.html#cb94-86"></a>    micro_wb_dist &lt;-<span class="st"> </span><span class="kw">vegdist</span>(congruent_dfs<span class="op">$</span>micro_wb, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb94-87"><a href="inter-omics.html#cb94-87"></a>    </span>
<span id="cb94-88"><a href="inter-omics.html#cb94-88"></a>    m_gb &lt;-<span class="st"> </span><span class="kw">mantel</span>(micro_gb_dist, gb_meta_dist, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb94-89"><a href="inter-omics.html#cb94-89"></a>    m_sf &lt;-<span class="st"> </span><span class="kw">mantel</span>(micro_sf_dist, sf_meta_dist, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb94-90"><a href="inter-omics.html#cb94-90"></a>    m_wb &lt;-<span class="st"> </span><span class="kw">mantel</span>(micro_wb_dist, wb_meta_dist, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb94-91"><a href="inter-omics.html#cb94-91"></a>    </span>
<span id="cb94-92"><a href="inter-omics.html#cb94-92"></a>    micro_dim &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>micro_gb)))</span>
<span id="cb94-93"><a href="inter-omics.html#cb94-93"></a>    micro_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(micro_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>micro_sf))))</span>
<span id="cb94-94"><a href="inter-omics.html#cb94-94"></a>    micro_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(micro_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>micro_wb))))</span>
<span id="cb94-95"><a href="inter-omics.html#cb94-95"></a>    <span class="kw">colnames</span>(micro_dim) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;micro_samples&quot;</span>, <span class="st">&quot;micro_OTUs&quot;</span>)</span>
<span id="cb94-96"><a href="inter-omics.html#cb94-96"></a>    </span>
<span id="cb94-97"><a href="inter-omics.html#cb94-97"></a>    meta_dim &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>metabolome_gb)))</span>
<span id="cb94-98"><a href="inter-omics.html#cb94-98"></a>    meta_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(meta_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>metabolome_sf))))</span>
<span id="cb94-99"><a href="inter-omics.html#cb94-99"></a>    meta_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(meta_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>metabolome_wb))))</span>
<span id="cb94-100"><a href="inter-omics.html#cb94-100"></a>    <span class="kw">colnames</span>(meta_dim) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;meta_samples&quot;</span>, <span class="st">&quot;meta_features&quot;</span>)</span>
<span id="cb94-101"><a href="inter-omics.html#cb94-101"></a>    </span>
<span id="cb94-102"><a href="inter-omics.html#cb94-102"></a>    stats &lt;-<span class="st"> </span><span class="kw">data.frame</span>(m_gb<span class="op">$</span>statistic)</span>
<span id="cb94-103"><a href="inter-omics.html#cb94-103"></a>    stats &lt;-<span class="st"> </span><span class="kw">rbind</span>(stats, m_sf<span class="op">$</span>statistic)</span>
<span id="cb94-104"><a href="inter-omics.html#cb94-104"></a>    stats &lt;-<span class="st"> </span><span class="kw">rbind</span>(stats, m_wb<span class="op">$</span>statistic)</span>
<span id="cb94-105"><a href="inter-omics.html#cb94-105"></a>    </span>
<span id="cb94-106"><a href="inter-omics.html#cb94-106"></a>    signif &lt;-<span class="st"> </span><span class="kw">data.frame</span>(m_gb<span class="op">$</span>signif)</span>
<span id="cb94-107"><a href="inter-omics.html#cb94-107"></a>    signif &lt;-<span class="st"> </span><span class="kw">rbind</span>(signif, m_sf<span class="op">$</span>signif)</span>
<span id="cb94-108"><a href="inter-omics.html#cb94-108"></a>    signif &lt;-<span class="st"> </span><span class="kw">rbind</span>(signif, m_wb<span class="op">$</span>signif)</span>
<span id="cb94-109"><a href="inter-omics.html#cb94-109"></a>    </span>
<span id="cb94-110"><a href="inter-omics.html#cb94-110"></a>    <span class="kw">colnames</span>(stats) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;statistic&quot;</span>)</span>
<span id="cb94-111"><a href="inter-omics.html#cb94-111"></a>    stats[<span class="st">&quot;signif&quot;</span>] &lt;-<span class="st"> </span>signif</span>
<span id="cb94-112"><a href="inter-omics.html#cb94-112"></a>    stats[<span class="st">&quot;Sponge species&quot;</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Geodia barretti&quot;</span>, <span class="st">&quot;Stryphnus fortis&quot;</span>, <span class="st">&quot;Weberella bursa&quot;</span>)</span>
<span id="cb94-113"><a href="inter-omics.html#cb94-113"></a>    </span>
<span id="cb94-114"><a href="inter-omics.html#cb94-114"></a>    stats &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(stats, micro_dim)</span>
<span id="cb94-115"><a href="inter-omics.html#cb94-115"></a>    stats &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(stats, meta_dim)</span>
<span id="cb94-116"><a href="inter-omics.html#cb94-116"></a>    stats[<span class="st">&quot;data set&quot;</span>] &lt;-<span class="st"> </span>filtering</span>
<span id="cb94-117"><a href="inter-omics.html#cb94-117"></a>    stats[<span class="st">&quot;Experiment&quot;</span>] &lt;-<span class="st"> </span>experiment</span>
<span id="cb94-118"><a href="inter-omics.html#cb94-118"></a>    <span class="kw">return</span>(stats)</span>
<span id="cb94-119"><a href="inter-omics.html#cb94-119"></a>}</span>
<span id="cb94-120"><a href="inter-omics.html#cb94-120"></a></span>
<span id="cb94-121"><a href="inter-omics.html#cb94-121"></a><span class="co"># PROTEST NMDS ordination and protest</span></span>
<span id="cb94-122"><a href="inter-omics.html#cb94-122"></a>ordination &lt;-<span class="st"> </span><span class="cf">function</span>(congruent_dfs, experiment, filtering) {</span>
<span id="cb94-123"><a href="inter-omics.html#cb94-123"></a>    <span class="co"># If you do not have community data, you should probably set autotransform = FALSE. k: number of dimensions</span></span>
<span id="cb94-124"><a href="inter-omics.html#cb94-124"></a>    gb_meta_mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(congruent_dfs<span class="op">$</span>metabolome_gb, <span class="dt">trymax =</span> <span class="dv">100</span>, <span class="dt">distance =</span> <span class="st">&quot;euclid&quot;</span>, <span class="dt">autotransforme =</span> F)</span>
<span id="cb94-125"><a href="inter-omics.html#cb94-125"></a>    micro_gb_mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(congruent_dfs<span class="op">$</span>micro_gb, <span class="dt">trymax =</span> <span class="dv">100</span>, <span class="dt">distance =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb94-126"><a href="inter-omics.html#cb94-126"></a>    </span>
<span id="cb94-127"><a href="inter-omics.html#cb94-127"></a>    sf_meta_mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(congruent_dfs<span class="op">$</span>metabolome_sf, <span class="dt">trymax =</span> <span class="dv">100</span>, <span class="dt">distance =</span> <span class="st">&quot;euclid&quot;</span>, <span class="dt">autotransforme =</span> F)</span>
<span id="cb94-128"><a href="inter-omics.html#cb94-128"></a>    micro_sf_mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(congruent_dfs<span class="op">$</span>micro_sf, <span class="dt">trymax =</span> <span class="dv">100</span>, <span class="dt">distance =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb94-129"><a href="inter-omics.html#cb94-129"></a>    </span>
<span id="cb94-130"><a href="inter-omics.html#cb94-130"></a>    wb_meta_mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(congruent_dfs<span class="op">$</span>metabolome_wb, <span class="dt">trymax =</span> <span class="dv">100</span>, <span class="dt">distance =</span> <span class="st">&quot;euclid&quot;</span>, <span class="dt">autotransforme =</span> F)</span>
<span id="cb94-131"><a href="inter-omics.html#cb94-131"></a>    micro_wb_mds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(congruent_dfs<span class="op">$</span>micro_wb, <span class="dt">trymax =</span> <span class="dv">100</span>, <span class="dt">distance =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb94-132"><a href="inter-omics.html#cb94-132"></a>    </span>
<span id="cb94-133"><a href="inter-omics.html#cb94-133"></a>    gb_proc &lt;-<span class="st"> </span><span class="kw">procrustes</span>(micro_gb_mds, gb_meta_mds, <span class="dt">scores =</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb94-134"><a href="inter-omics.html#cb94-134"></a>    gb_prot &lt;-<span class="st"> </span><span class="kw">protest</span>(micro_gb_mds, gb_meta_mds, <span class="dt">scores =</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb94-135"><a href="inter-omics.html#cb94-135"></a>    </span>
<span id="cb94-136"><a href="inter-omics.html#cb94-136"></a>    sf_proc &lt;-<span class="st"> </span><span class="kw">procrustes</span>(micro_sf_mds, sf_meta_mds, <span class="dt">scores =</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb94-137"><a href="inter-omics.html#cb94-137"></a>    sf_prot &lt;-<span class="st"> </span><span class="kw">protest</span>(micro_sf_mds, sf_meta_mds, <span class="dt">scores =</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb94-138"><a href="inter-omics.html#cb94-138"></a>    </span>
<span id="cb94-139"><a href="inter-omics.html#cb94-139"></a>    wb_proc &lt;-<span class="st"> </span><span class="kw">procrustes</span>(micro_wb_mds, wb_meta_mds, <span class="dt">scores =</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb94-140"><a href="inter-omics.html#cb94-140"></a>    wb_prot &lt;-<span class="st"> </span><span class="kw">protest</span>(micro_wb_mds, wb_meta_mds, <span class="dt">scores =</span> <span class="st">&quot;sites&quot;</span>)</span>
<span id="cb94-141"><a href="inter-omics.html#cb94-141"></a>    </span>
<span id="cb94-142"><a href="inter-omics.html#cb94-142"></a>    micro_dim &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>micro_gb)))</span>
<span id="cb94-143"><a href="inter-omics.html#cb94-143"></a>    micro_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(micro_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>micro_sf))))</span>
<span id="cb94-144"><a href="inter-omics.html#cb94-144"></a>    micro_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(micro_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>micro_wb))))</span>
<span id="cb94-145"><a href="inter-omics.html#cb94-145"></a>    <span class="kw">colnames</span>(micro_dim) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;micro_samples&quot;</span>, <span class="st">&quot;micro_OTUs&quot;</span>)</span>
<span id="cb94-146"><a href="inter-omics.html#cb94-146"></a>    </span>
<span id="cb94-147"><a href="inter-omics.html#cb94-147"></a>    meta_dim &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>metabolome_gb)))</span>
<span id="cb94-148"><a href="inter-omics.html#cb94-148"></a>    meta_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(meta_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>metabolome_sf))))</span>
<span id="cb94-149"><a href="inter-omics.html#cb94-149"></a>    meta_dim &lt;-<span class="st"> </span><span class="kw">rbind</span>(meta_dim, <span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">dim</span>(congruent_dfs<span class="op">$</span>metabolome_wb))))</span>
<span id="cb94-150"><a href="inter-omics.html#cb94-150"></a>    <span class="kw">colnames</span>(meta_dim) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;meta_samples&quot;</span>, <span class="st">&quot;meta_features&quot;</span>)</span>
<span id="cb94-151"><a href="inter-omics.html#cb94-151"></a>    </span>
<span id="cb94-152"><a href="inter-omics.html#cb94-152"></a>    pss &lt;-<span class="st"> </span><span class="kw">data.frame</span>(gb_prot<span class="op">$</span>ss)</span>
<span id="cb94-153"><a href="inter-omics.html#cb94-153"></a>    pss &lt;-<span class="st"> </span><span class="kw">rbind</span>(pss, sf_prot<span class="op">$</span>ss)</span>
<span id="cb94-154"><a href="inter-omics.html#cb94-154"></a>    pss &lt;-<span class="st"> </span><span class="kw">rbind</span>(pss, wb_prot<span class="op">$</span>ss)</span>
<span id="cb94-155"><a href="inter-omics.html#cb94-155"></a>    <span class="kw">colnames</span>(pss) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Procrustes SS&quot;</span>)</span>
<span id="cb94-156"><a href="inter-omics.html#cb94-156"></a>    </span>
<span id="cb94-157"><a href="inter-omics.html#cb94-157"></a>    cor &lt;-<span class="st"> </span><span class="kw">data.frame</span>(gb_prot<span class="op">$</span>scale)</span>
<span id="cb94-158"><a href="inter-omics.html#cb94-158"></a>    cor &lt;-<span class="st"> </span><span class="kw">rbind</span>(cor, sf_prot<span class="op">$</span>scale)</span>
<span id="cb94-159"><a href="inter-omics.html#cb94-159"></a>    cor &lt;-<span class="st"> </span><span class="kw">rbind</span>(cor, wb_prot<span class="op">$</span>scale)</span>
<span id="cb94-160"><a href="inter-omics.html#cb94-160"></a>    <span class="kw">colnames</span>(cor) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;correlation in sym. rotation&quot;</span>)</span>
<span id="cb94-161"><a href="inter-omics.html#cb94-161"></a>    </span>
<span id="cb94-162"><a href="inter-omics.html#cb94-162"></a>    signif &lt;-<span class="st"> </span><span class="kw">data.frame</span>(gb_prot<span class="op">$</span>signif)</span>
<span id="cb94-163"><a href="inter-omics.html#cb94-163"></a>    signif &lt;-<span class="st"> </span><span class="kw">rbind</span>(signif, sf_prot<span class="op">$</span>signif)</span>
<span id="cb94-164"><a href="inter-omics.html#cb94-164"></a>    signif &lt;-<span class="st"> </span><span class="kw">rbind</span>(signif, wb_prot<span class="op">$</span>signif)</span>
<span id="cb94-165"><a href="inter-omics.html#cb94-165"></a>    <span class="kw">colnames</span>(signif) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;signif&quot;</span>)</span>
<span id="cb94-166"><a href="inter-omics.html#cb94-166"></a>    </span>
<span id="cb94-167"><a href="inter-omics.html#cb94-167"></a>    stats &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(pss, cor, signif, micro_dim, meta_dim)</span>
<span id="cb94-168"><a href="inter-omics.html#cb94-168"></a>    stats[<span class="st">&quot;data set&quot;</span>] &lt;-<span class="st"> </span>filtering</span>
<span id="cb94-169"><a href="inter-omics.html#cb94-169"></a>    stats[<span class="st">&quot;Experiment&quot;</span>] &lt;-<span class="st"> </span>experiment</span>
<span id="cb94-170"><a href="inter-omics.html#cb94-170"></a>    stats[<span class="st">&quot;Sponge species&quot;</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Geodia barretti&quot;</span>, <span class="st">&quot;Stryphnus fortis&quot;</span>, <span class="st">&quot;Weberella bursa&quot;</span>)</span>
<span id="cb94-171"><a href="inter-omics.html#cb94-171"></a>    <span class="kw">return</span>(stats)</span>
<span id="cb94-172"><a href="inter-omics.html#cb94-172"></a>}</span></code></pre></div>
</div>
<div id="data-sets" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Data sets</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="inter-omics.html#cb95-1"></a><span class="co"># LOAD DATA</span></span>
<span id="cb95-2"><a href="inter-omics.html#cb95-2"></a>micro &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/OTU_all_R.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb95-3"><a href="inter-omics.html#cb95-3"></a><span class="kw">colnames</span>(micro)[<span class="kw">colnames</span>(micro) <span class="op">==</span><span class="st"> &quot;Sample_ID&quot;</span>] &lt;-<span class="st"> &quot;unified_ID&quot;</span></span>
<span id="cb95-4"><a href="inter-omics.html#cb95-4"></a>micro &lt;-<span class="st"> </span>micro[<span class="kw">order</span>(micro<span class="op">$</span>unified_ID), ]</span>
<span id="cb95-5"><a href="inter-omics.html#cb95-5"></a><span class="kw">rownames</span>(micro) &lt;-<span class="st"> </span>micro<span class="op">$</span>unified_ID</span>
<span id="cb95-6"><a href="inter-omics.html#cb95-6"></a>micro[<span class="st">&quot;spec&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(micro<span class="op">$</span>unified_ID, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb95-7"><a href="inter-omics.html#cb95-7"></a></span>
<span id="cb95-8"><a href="inter-omics.html#cb95-8"></a>meta_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/PANGAEA_Final.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb95-9"><a href="inter-omics.html#cb95-9"></a>masslynx &lt;-<span class="st"> </span>meta_data</span>
<span id="cb95-10"><a href="inter-omics.html#cb95-10"></a>masslynx &lt;-<span class="st"> </span>masslynx[<span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;LC.MS.HILIC.positive&quot;</span>, <span class="st">&quot;LC.MS.HILIC.negative&quot;</span>, <span class="st">&quot;LC.MS.RP.positive&quot;</span>, <span class="st">&quot;LC.MS.RP.negative&quot;</span>)]</span>
<span id="cb95-11"><a href="inter-omics.html#cb95-11"></a><span class="kw">colnames</span>(masslynx) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;H_p&quot;</span>, <span class="st">&quot;H_n&quot;</span>, <span class="st">&quot;R_p&quot;</span>, <span class="st">&quot;R_n&quot;</span>)</span>
<span id="cb95-12"><a href="inter-omics.html#cb95-12"></a>masslynx &lt;-<span class="st"> </span><span class="kw">na.omit</span>(masslynx)</span>
<span id="cb95-13"><a href="inter-omics.html#cb95-13"></a>masslynx[<span class="st">&quot;HILIC_pos&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>H_p, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb95-14"><a href="inter-omics.html#cb95-14"></a>masslynx[<span class="st">&quot;HILIC_neg&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>H_n, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb95-15"><a href="inter-omics.html#cb95-15"></a>masslynx[<span class="st">&quot;RP_pos&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>R_p, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb95-16"><a href="inter-omics.html#cb95-16"></a>masslynx[<span class="st">&quot;RP_neg&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>R_n, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb95-17"><a href="inter-omics.html#cb95-17"></a></span>
<span id="cb95-18"><a href="inter-omics.html#cb95-18"></a><span class="co"># load one set of experiments at a time, i.e. CLEANED, ION or PC_GROUPS</span></span>
<span id="cb95-19"><a href="inter-omics.html#cb95-19"></a></span>
<span id="cb95-20"><a href="inter-omics.html#cb95-20"></a><span class="co">### CLEANED</span></span>
<span id="cb95-21"><a href="inter-omics.html#cb95-21"></a>hilic_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_pos_20190417_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-22"><a href="inter-omics.html#cb95-22"></a>hilic_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_neg_20190421_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-23"><a href="inter-omics.html#cb95-23"></a>rp_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_pos_20190421_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-24"><a href="inter-omics.html#cb95-24"></a>rp_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_neg_20190422_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-25"><a href="inter-omics.html#cb95-25"></a></span>
<span id="cb95-26"><a href="inter-omics.html#cb95-26"></a><span class="co">### ION</span></span>
<span id="cb95-27"><a href="inter-omics.html#cb95-27"></a>hilic_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_pos_20190417_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-28"><a href="inter-omics.html#cb95-28"></a>hilic_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_neg_20190421_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-29"><a href="inter-omics.html#cb95-29"></a>rp_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_pos_20190421_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-30"><a href="inter-omics.html#cb95-30"></a>rp_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_neg_20190422_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-31"><a href="inter-omics.html#cb95-31"></a></span>
<span id="cb95-32"><a href="inter-omics.html#cb95-32"></a><span class="co">### PC_GROUPS</span></span>
<span id="cb95-33"><a href="inter-omics.html#cb95-33"></a>hilic_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_pos_20190417_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-34"><a href="inter-omics.html#cb95-34"></a>hilic_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_neg_20190421_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-35"><a href="inter-omics.html#cb95-35"></a>rp_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_pos_20190421_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb95-36"><a href="inter-omics.html#cb95-36"></a>rp_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_neg_20190422_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
</div>
<div id="mantel-test-code-and-tabular-output" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Mantel test code and tabular output</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="inter-omics.html#cb96-1"></a><span class="co">### =============================== MANTEL </span><span class="al">TEST</span><span class="co">=================================</span></span>
<span id="cb96-2"><a href="inter-omics.html#cb96-2"></a></span>
<span id="cb96-3"><a href="inter-omics.html#cb96-3"></a><span class="co"># run one of this at a time</span></span>
<span id="cb96-4"><a href="inter-omics.html#cb96-4"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_pos, <span class="st">&quot;H_p&quot;</span>)</span>
<span id="cb96-5"><a href="inter-omics.html#cb96-5"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_neg, <span class="st">&quot;H_n&quot;</span>)</span>
<span id="cb96-6"><a href="inter-omics.html#cb96-6"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_pos, <span class="st">&quot;R_p&quot;</span>)</span>
<span id="cb96-7"><a href="inter-omics.html#cb96-7"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_neg, <span class="st">&quot;R_n&quot;</span>)</span>
<span id="cb96-8"><a href="inter-omics.html#cb96-8"></a></span>
<span id="cb96-9"><a href="inter-omics.html#cb96-9"></a><span class="co"># run this</span></span>
<span id="cb96-10"><a href="inter-omics.html#cb96-10"></a>congruent_dfs &lt;-<span class="st"> </span><span class="kw">congruency</span>(metabolomes)</span>
<span id="cb96-11"><a href="inter-omics.html#cb96-11"></a></span>
<span id="cb96-12"><a href="inter-omics.html#cb96-12"></a><span class="co"># run one of these: MANTEL </span><span class="al">TEST</span></span>
<span id="cb96-13"><a href="inter-omics.html#cb96-13"></a>diagnostics_hp_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb96-14"><a href="inter-omics.html#cb96-14"></a>diagnostics_hn_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb96-15"><a href="inter-omics.html#cb96-15"></a>diagnostics_rp_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb96-16"><a href="inter-omics.html#cb96-16"></a>diagnostics_rn_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb96-17"><a href="inter-omics.html#cb96-17"></a></span>
<span id="cb96-18"><a href="inter-omics.html#cb96-18"></a>diagnostics_hp_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb96-19"><a href="inter-omics.html#cb96-19"></a>diagnostics_hn_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb96-20"><a href="inter-omics.html#cb96-20"></a>diagnostics_rp_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb96-21"><a href="inter-omics.html#cb96-21"></a>diagnostics_rn_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb96-22"><a href="inter-omics.html#cb96-22"></a></span>
<span id="cb96-23"><a href="inter-omics.html#cb96-23"></a>diagnostics_hp_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb96-24"><a href="inter-omics.html#cb96-24"></a>diagnostics_hn_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb96-25"><a href="inter-omics.html#cb96-25"></a>diagnostics_rp_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb96-26"><a href="inter-omics.html#cb96-26"></a>diagnostics_rn_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb96-27"><a href="inter-omics.html#cb96-27"></a></span>
<span id="cb96-28"><a href="inter-omics.html#cb96-28"></a></span>
<span id="cb96-29"><a href="inter-omics.html#cb96-29"></a><span class="co">### Combine all test results into one file</span></span>
<span id="cb96-30"><a href="inter-omics.html#cb96-30"></a></span>
<span id="cb96-31"><a href="inter-omics.html#cb96-31"></a>diagnostics &lt;-<span class="st"> </span>diagnostics_hp_cleaned</span>
<span id="cb96-32"><a href="inter-omics.html#cb96-32"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">rbind</span>(diagnostics, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_pc_group, </span>
<span id="cb96-33"><a href="inter-omics.html#cb96-33"></a>    diagnostics_hn_pc_group, diagnostics_rp_pc_group, diagnostics_rn_pc_group, diagnostics_hp_ion, diagnostics_hn_ion, </span>
<span id="cb96-34"><a href="inter-omics.html#cb96-34"></a>    diagnostics_rp_ion, diagnostics_rn_ion)</span>
<span id="cb96-35"><a href="inter-omics.html#cb96-35"></a>diagnostics</span>
<span id="cb96-36"><a href="inter-omics.html#cb96-36"></a><span class="kw">write.csv</span>(diagnostics, <span class="st">&quot;mantel_stats_FUN.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="inter-omics.html#cb97-1"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/mantel_stats_FUN.csv&quot;</span>)</span>
<span id="cb97-2"><a href="inter-omics.html#cb97-2"></a>diagnostics<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb97-3"><a href="inter-omics.html#cb97-3"></a>diagnostics &lt;-<span class="st"> </span>diagnostics[, <span class="kw">c</span>(<span class="st">&quot;statistic&quot;</span>, <span class="st">&quot;signif&quot;</span>, <span class="st">&quot;micro_samples&quot;</span>, <span class="st">&quot;micro_OTUs&quot;</span>, <span class="st">&quot;meta_samples&quot;</span>, <span class="st">&quot;meta_features&quot;</span>, </span>
<span id="cb97-4"><a href="inter-omics.html#cb97-4"></a>    <span class="st">&quot;Sponge.species&quot;</span>, <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data.set&quot;</span>)]</span>
<span id="cb97-5"><a href="inter-omics.html#cb97-5"></a></span>
<span id="cb97-6"><a href="inter-omics.html#cb97-6"></a><span class="kw">options</span>(<span class="dt">kableExtra.html.bsTable =</span> T)</span>
<span id="cb97-7"><a href="inter-omics.html#cb97-7"></a><span class="kw">kable</span>(diagnostics, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Mantel statistic r&quot;</span>, <span class="st">&quot;significance&quot;</span>, <span class="st">&quot;N microbiome samples&quot;</span>, <span class="st">&quot;N OTUs&quot;</span>, <span class="st">&quot;N metabolome samples&quot;</span>, </span>
<span id="cb97-8"><a href="inter-omics.html#cb97-8"></a>    <span class="st">&quot;N features&quot;</span>, <span class="st">&quot;Sponge species&quot;</span>, <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data set&quot;</span>), <span class="dt">longtable =</span> T, <span class="dt">booktabs =</span> T, <span class="dt">caption =</span> <span class="st">&quot;Mantel test diagnostics diagnositcs comparing the microbiome and metabolome of the same sponge specimens&quot;</span>, </span>
<span id="cb97-9"><a href="inter-omics.html#cb97-9"></a>    <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="dt">Diagnostics =</span> <span class="dv">6</span>, <span class="st">`</span><span class="dt">Data set attribution</span><span class="st">`</span> =<span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, </span>
<span id="cb97-10"><a href="inter-omics.html#cb97-10"></a>    <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;bordered&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">font_size =</span> <span class="dv">12</span>, <span class="dt">full_width =</span> F, <span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;scale_down&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover table-bordered table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
(#tab:io4_mantel_results)Mantel test diagnostics diagnositcs comparing the microbiome and metabolome of the same sponge specimens
</caption>
<thead>
<tr>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="6">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Diagnostics
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Data set attribution
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Mantel statistic r
</th>
<th style="text-align:right;">
significance
</th>
<th style="text-align:right;">
N microbiome samples
</th>
<th style="text-align:right;">
N OTUs
</th>
<th style="text-align:right;">
N metabolome samples
</th>
<th style="text-align:right;">
N features
</th>
<th style="text-align:left;">
Sponge species
</th>
<th style="text-align:left;">
Experiment
</th>
<th style="text-align:left;">
data set
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.6076416
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3507
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3857788
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3507
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4576405
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
3507
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4516469
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2808
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1513297
</td>
<td style="text-align:right;">
0.186
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2808
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1854966
</td>
<td style="text-align:right;">
0.168
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2808
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2014493
</td>
<td style="text-align:right;">
0.833
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4673
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3127632
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
4673
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3323657
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
4673
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2465894
</td>
<td style="text-align:right;">
0.845
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1960950
</td>
<td style="text-align:right;">
0.173
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1721750
</td>
<td style="text-align:right;">
0.174
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5836627
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4082626
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4483931
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3951252
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1351
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3211093
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1351
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0315675
</td>
<td style="text-align:right;">
0.414
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1351
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1600791
</td>
<td style="text-align:right;">
0.774
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2736
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3181249
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2736
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3008501
</td>
<td style="text-align:right;">
0.067
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2736
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1879022
</td>
<td style="text-align:right;">
0.790
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2034548
</td>
<td style="text-align:right;">
0.156
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1507257
</td>
<td style="text-align:right;">
0.198
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3351779
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2908357
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4683599
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4429513
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0727247
</td>
<td style="text-align:right;">
0.320
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2320236
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2569170
</td>
<td style="text-align:right;">
0.908
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3070980
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2656853
</td>
<td style="text-align:right;">
0.072
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1220077
</td>
<td style="text-align:right;">
0.703
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0505950
</td>
<td style="text-align:right;">
0.597
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1218225
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="inter-omics.html#cb98-1"></a>dig &lt;-<span class="st"> </span>diagnostics[diagnostics<span class="op">$</span>signif <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, ]</span>
<span id="cb98-2"><a href="inter-omics.html#cb98-2"></a>a &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dig, <span class="dt">by =</span> <span class="kw">list</span>(dig<span class="op">$</span>Sponge.species, dig<span class="op">$</span>Experiment, dig<span class="op">$</span>data.set), <span class="dt">FUN =</span> <span class="st">&quot;length&quot;</span>)</span>
<span id="cb98-3"><a href="inter-omics.html#cb98-3"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Geodia barretti Stryphnus fortis  Weberella bursa 
##                6                3                4</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="inter-omics.html#cb100-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## HILIC neg HILIC pos    RP neg    RP pos 
##         4         8         0         1</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="inter-omics.html#cb102-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  cleaned      ion pc_group 
##        5        3        5</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="inter-omics.html#cb104-1"></a><span class="kw">rm</span>(diagnostics_hp_cleaned, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_ion, </span>
<span id="cb104-2"><a href="inter-omics.html#cb104-2"></a>    diagnostics_hn_ion, diagnostics_rp_ion, diagnostics_rn_ion, diagnostics_hp_pc_group, diagnostics_hn_pc_group, diagnostics_rp_pc_group, </span>
<span id="cb104-3"><a href="inter-omics.html#cb104-3"></a>    diagnostics_rn_pc_group)</span>
<span id="cb104-4"><a href="inter-omics.html#cb104-4"></a><span class="kw">rm</span>(hilic_pos, hilic_neg, rp_pos, rp_neg)</span></code></pre></div>
<p>As we can see from the table, in 13 cases, the Mantel test returns a significant correlation between the two matrices. Above you can see the the significant tests broken down by sponge species, HPCL-experiment and filtering approach.</p>
</div>
<div id="procrustes-rotation-and-protest-code-and-tabular-output" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Procrustes rotation and protest code and tabular output</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="inter-omics.html#cb105-1"></a><span class="co">### =============================== PROTEST ====================================</span></span>
<span id="cb105-2"><a href="inter-omics.html#cb105-2"></a></span>
<span id="cb105-3"><a href="inter-omics.html#cb105-3"></a><span class="co"># run one of this at a time</span></span>
<span id="cb105-4"><a href="inter-omics.html#cb105-4"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_pos, <span class="st">&quot;H_p&quot;</span>)</span>
<span id="cb105-5"><a href="inter-omics.html#cb105-5"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_neg, <span class="st">&quot;H_n&quot;</span>)</span>
<span id="cb105-6"><a href="inter-omics.html#cb105-6"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_pos, <span class="st">&quot;R_p&quot;</span>)</span>
<span id="cb105-7"><a href="inter-omics.html#cb105-7"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_neg, <span class="st">&quot;R_n&quot;</span>)</span>
<span id="cb105-8"><a href="inter-omics.html#cb105-8"></a></span>
<span id="cb105-9"><a href="inter-omics.html#cb105-9"></a><span class="co"># run this</span></span>
<span id="cb105-10"><a href="inter-omics.html#cb105-10"></a>congruent_dfs &lt;-<span class="st"> </span><span class="kw">congruency</span>(metabolomes)</span>
<span id="cb105-11"><a href="inter-omics.html#cb105-11"></a></span>
<span id="cb105-12"><a href="inter-omics.html#cb105-12"></a><span class="co"># run one of these: PROTEST </span><span class="al">TEST</span></span>
<span id="cb105-13"><a href="inter-omics.html#cb105-13"></a>diagnostics_hp_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb105-14"><a href="inter-omics.html#cb105-14"></a>diagnostics_hn_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb105-15"><a href="inter-omics.html#cb105-15"></a>diagnostics_rp_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb105-16"><a href="inter-omics.html#cb105-16"></a>diagnostics_rn_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb105-17"><a href="inter-omics.html#cb105-17"></a></span>
<span id="cb105-18"><a href="inter-omics.html#cb105-18"></a>diagnostics_hp_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb105-19"><a href="inter-omics.html#cb105-19"></a>diagnostics_hn_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb105-20"><a href="inter-omics.html#cb105-20"></a>diagnostics_rp_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb105-21"><a href="inter-omics.html#cb105-21"></a>diagnostics_rn_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb105-22"><a href="inter-omics.html#cb105-22"></a></span>
<span id="cb105-23"><a href="inter-omics.html#cb105-23"></a>diagnostics_hp_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb105-24"><a href="inter-omics.html#cb105-24"></a>diagnostics_hn_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb105-25"><a href="inter-omics.html#cb105-25"></a>diagnostics_rp_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb105-26"><a href="inter-omics.html#cb105-26"></a>diagnostics_rn_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb105-27"><a href="inter-omics.html#cb105-27"></a></span>
<span id="cb105-28"><a href="inter-omics.html#cb105-28"></a></span>
<span id="cb105-29"><a href="inter-omics.html#cb105-29"></a><span class="co">### Combine all test results into one file</span></span>
<span id="cb105-30"><a href="inter-omics.html#cb105-30"></a></span>
<span id="cb105-31"><a href="inter-omics.html#cb105-31"></a>diagnostics &lt;-<span class="st"> </span>diagnostics_hp_cleaned</span>
<span id="cb105-32"><a href="inter-omics.html#cb105-32"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">rbind</span>(diagnostics, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_pc_group, </span>
<span id="cb105-33"><a href="inter-omics.html#cb105-33"></a>    diagnostics_hn_pc_group, diagnostics_rp_pc_group, diagnostics_rn_pc_group, diagnostics_hp_ion, diagnostics_hn_ion, </span>
<span id="cb105-34"><a href="inter-omics.html#cb105-34"></a>    diagnostics_rp_ion, diagnostics_rn_ion)</span>
<span id="cb105-35"><a href="inter-omics.html#cb105-35"></a>diagnostics</span>
<span id="cb105-36"><a href="inter-omics.html#cb105-36"></a></span>
<span id="cb105-37"><a href="inter-omics.html#cb105-37"></a><span class="kw">write.csv</span>(diagnostics, <span class="st">&quot;protest_stats_FUN.csv&quot;</span>)</span>
<span id="cb105-38"><a href="inter-omics.html#cb105-38"></a></span>
<span id="cb105-39"><a href="inter-omics.html#cb105-39"></a><span class="kw">rm</span>(diagnostics_hp_cleaned, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_ion, </span>
<span id="cb105-40"><a href="inter-omics.html#cb105-40"></a>    diagnostics_hn_ion, diagnostics_rp_ion, diagnostics_rn_ion, diagnostics_hp_pc_group, diagnostics_hn_pc_group, diagnostics_rp_pc_group, </span>
<span id="cb105-41"><a href="inter-omics.html#cb105-41"></a>    diagnostics_rn_pc_group, diagnostics)</span>
<span id="cb105-42"><a href="inter-omics.html#cb105-42"></a><span class="kw">rm</span>(hilic_pos, hilic_neg, rp_pos, rp_neg)</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="inter-omics.html#cb106-1"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/protest_stats_FUN.csv&quot;</span>)</span>
<span id="cb106-2"><a href="inter-omics.html#cb106-2"></a>diagnostics<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb106-3"><a href="inter-omics.html#cb106-3"></a>diagnostics &lt;-<span class="st"> </span>diagnostics[, <span class="kw">c</span>(<span class="st">&quot;Procrustes.SS&quot;</span>, <span class="st">&quot;correlation.in.sym..rotation&quot;</span>, <span class="st">&quot;signif&quot;</span>, <span class="st">&quot;micro_samples&quot;</span>, <span class="st">&quot;micro_OTUs&quot;</span>, </span>
<span id="cb106-4"><a href="inter-omics.html#cb106-4"></a>    <span class="st">&quot;meta_samples&quot;</span>, <span class="st">&quot;meta_features&quot;</span>, <span class="st">&quot;Sponge.species&quot;</span>, <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data.set&quot;</span>)]</span>
<span id="cb106-5"><a href="inter-omics.html#cb106-5"></a></span>
<span id="cb106-6"><a href="inter-omics.html#cb106-6"></a><span class="kw">options</span>(<span class="dt">kableExtra.html.bsTable =</span> T)</span>
<span id="cb106-7"><a href="inter-omics.html#cb106-7"></a><span class="kw">kable</span>(diagnostics, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Procrustes sum of squares&quot;</span>, <span class="st">&quot;correlation in symmetric rotation&quot;</span>, <span class="st">&quot;significance&quot;</span>, </span>
<span id="cb106-8"><a href="inter-omics.html#cb106-8"></a>    <span class="st">&quot;N microbiome samples&quot;</span>, <span class="st">&quot;N OTUs&quot;</span>, <span class="st">&quot;N metabolome samples&quot;</span>, <span class="st">&quot;N features&quot;</span>, <span class="st">&quot;Sponge species&quot;</span>, <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data set&quot;</span>), </span>
<span id="cb106-9"><a href="inter-omics.html#cb106-9"></a>    <span class="dt">longtable =</span> T, <span class="dt">booktabs =</span> T, <span class="dt">caption =</span> <span class="st">&quot;Protest diagnostics comparing the microbiome and metabolome of the same sponge specimens&quot;</span>, </span>
<span id="cb106-10"><a href="inter-omics.html#cb106-10"></a>    <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="dt">Diagnostics =</span> <span class="dv">7</span>, <span class="st">`</span><span class="dt">Data set attribution</span><span class="st">`</span> =<span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, </span>
<span id="cb106-11"><a href="inter-omics.html#cb106-11"></a>    <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;bordered&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">font_size =</span> <span class="dv">12</span>, <span class="dt">full_width =</span> F, <span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;scale_down&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover table-bordered table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
(#tab:io6_prt)Protest diagnostics comparing the microbiome and metabolome of the same sponge specimens
</caption>
<thead>
<tr>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="7">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Diagnostics
</div>
</th>
<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Data set attribution
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
Procrustes sum of squares
</th>
<th style="text-align:right;">
correlation in symmetric rotation
</th>
<th style="text-align:right;">
significance
</th>
<th style="text-align:right;">
N microbiome samples
</th>
<th style="text-align:right;">
N OTUs
</th>
<th style="text-align:right;">
N metabolome samples
</th>
<th style="text-align:right;">
N features
</th>
<th style="text-align:left;">
Sponge species
</th>
<th style="text-align:left;">
Experiment
</th>
<th style="text-align:left;">
data set
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.4901473
</td>
<td style="text-align:right;">
0.7140397
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3507
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3360196
</td>
<td style="text-align:right;">
0.8148499
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3507
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6451196
</td>
<td style="text-align:right;">
0.5957184
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
3507
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5056719
</td>
<td style="text-align:right;">
0.7030847
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2808
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7144829
</td>
<td style="text-align:right;">
0.5343380
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2808
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6454847
</td>
<td style="text-align:right;">
0.5954119
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2808
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7241690
</td>
<td style="text-align:right;">
0.5251961
</td>
<td style="text-align:right;">
0.124
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
4673
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5535784
</td>
<td style="text-align:right;">
0.6681479
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
4673
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9089831
</td>
<td style="text-align:right;">
0.3016901
</td>
<td style="text-align:right;">
0.513
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
4673
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7744081
</td>
<td style="text-align:right;">
0.4749652
</td>
<td style="text-align:right;">
0.229
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7769037
</td>
<td style="text-align:right;">
0.4723307
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9426954
</td>
<td style="text-align:right;">
0.2393838
</td>
<td style="text-align:right;">
0.656
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
cleaned
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4903060
</td>
<td style="text-align:right;">
0.7139285
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6122646
</td>
<td style="text-align:right;">
0.6226840
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5611609
</td>
<td style="text-align:right;">
0.6624494
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4442919
</td>
<td style="text-align:right;">
0.7454583
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1351
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6072203
</td>
<td style="text-align:right;">
0.6267214
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1351
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7647882
</td>
<td style="text-align:right;">
0.4849864
</td>
<td style="text-align:right;">
0.062
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1351
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7332277
</td>
<td style="text-align:right;">
0.5165001
</td>
<td style="text-align:right;">
0.146
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2736
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5557670
</td>
<td style="text-align:right;">
0.6665081
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
2736
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9184545
</td>
<td style="text-align:right;">
0.2855616
</td>
<td style="text-align:right;">
0.579
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
2736
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7952845
</td>
<td style="text-align:right;">
0.4524550
</td>
<td style="text-align:right;">
0.314
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7513407
</td>
<td style="text-align:right;">
0.4986575
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9669093
</td>
<td style="text-align:right;">
0.1819085
</td>
<td style="text-align:right;">
0.851
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1678
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
pc_group
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7744285
</td>
<td style="text-align:right;">
0.4749437
</td>
<td style="text-align:right;">
0.254
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7768298
</td>
<td style="text-align:right;">
0.4724090
</td>
<td style="text-align:right;">
0.119
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9427350
</td>
<td style="text-align:right;">
0.2393010
</td>
<td style="text-align:right;">
0.671
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
3166
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3977778
</td>
<td style="text-align:right;">
0.7760297
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7620196
</td>
<td style="text-align:right;">
0.4878323
</td>
<td style="text-align:right;">
0.101
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6263664
</td>
<td style="text-align:right;">
0.6112558
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
HILIC neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6879735
</td>
<td style="text-align:right;">
0.5585933
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6735153
</td>
<td style="text-align:right;">
0.5713884
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9830213
</td>
<td style="text-align:right;">
0.1303022
</td>
<td style="text-align:right;">
0.961
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
171
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP pos
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7788793
</td>
<td style="text-align:right;">
0.4702347
</td>
<td style="text-align:right;">
0.271
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Geodia barretti
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9754054
</td>
<td style="text-align:right;">
0.1568265
</td>
<td style="text-align:right;">
0.767
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Stryphnus fortis
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9595716
</td>
<td style="text-align:right;">
0.2010681
</td>
<td style="text-align:right;">
0.791
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:left;">
Weberella bursa
</td>
<td style="text-align:left;">
RP neg
</td>
<td style="text-align:left;">
ion
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="inter-omics.html#cb107-1"></a>dig &lt;-<span class="st"> </span>diagnostics[diagnostics<span class="op">$</span>signif <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, ]</span>
<span id="cb107-2"><a href="inter-omics.html#cb107-2"></a>a &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dig, <span class="dt">by =</span> <span class="kw">list</span>(dig<span class="op">$</span>Sponge.species, dig<span class="op">$</span>Experiment, dig<span class="op">$</span>data.set), <span class="dt">FUN =</span> <span class="st">&quot;length&quot;</span>)</span>
<span id="cb107-3"><a href="inter-omics.html#cb107-3"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Geodia barretti Stryphnus fortis  Weberella bursa 
##                5                7                4</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="inter-omics.html#cb109-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## HILIC neg HILIC pos    RP neg    RP pos 
##         7         6         0         3</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="inter-omics.html#cb111-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  cleaned      ion pc_group 
##        7        3        6</code></pre>
<p>Out of the 36 tests performed, 16 are significant (<em>p</em> <span class="math inline">\(\leq\)</span> 0.05). Immediately above you can see the the significant tests broken down by sponge species, HPCL-experiment and filtering approach.</p>
</div>
</div>
<div id="microbial-interaction-network" class="section level2">
<h2><span class="header-section-number">4.2</span> Microbial interaction network</h2>
<div id="generating-network-based-on-different-algorithms" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Generating network based on different algorithms</h3>
<p>The overall goal of the subsequent seqctions of code is to produce a microbial interation network for <em>Geodia barretti</em>. Nodes will be OTUs/ASVs from <em>Geodia barretti</em> samples and edges represent an interaction between those OTUs/ASVs. In this first part, we will employ different algorithms for network building. Network building algorithms are mannifold and their results not uncontroversial, thus the recommended strategy is to use different methods and merge the resulting networks to one consensus representation (Weiss <em>et al</em>., 2016), which we will do in the second part.</p>
<p>The original data set from 14 specimens of <em>Geodia barretti</em> contained 420 OTUs/ASVs. To reduce sparsity, we removed OTUs/ASVs with two or less non-zero values resulting in a data set containing 289 OTUs/ASVs. This data set was used for network inference with the following methods:</p>
<ol style="list-style-type: decimal">
<li>MENA Pipeline</li>
<li>fastLSA</li>
<li>SparCC</li>
<li>Maximal information coefficient MIC</li>
</ol>
<div id="molecular-ecological-network-analysis-mena-pipeline" class="section level4">
<h4><span class="header-section-number">4.2.1.1</span> Molecular Ecological Network Analysis (MENA) Pipeline</h4>
<p>The implementation of MENA (Deng <em>et al</em>., 2012; Zhou, Deng <em>et al</em>., 2010; Zhou, Deng <em>et al</em>.,2011) can be accessed at <a href="http://ieg4.rccc.ou.edu/mena" class="uri">http://ieg4.rccc.ou.edu/mena</a>. The data set was saved as tab separated values and all zeros were converted to blanks.
No further filtering for non-zero values was done (more than two non-zero values). For data preparation, default settings were applied, i.e. missing data was only filled with 0.01 in blanks with paired valid values, logarithm was taken, Pearson correlation coefficient was selected. Likewise, Random matrix theory settings were kept at defaults, decreasing the cutoff from the top using Regress Poisson distribution only. The cutoff of 0.800 was chosen for the similarity matrix to construct the network, corresponding to a Chi-square test on Poisson distribution of 99.191 and a p-value of 0.001. This resulted in a network with 241 nodes and 3582 edges.</p>
<p>A second analysis was produced with the same settings except building the similarity matrix based on Spearman’s Rho. The cutoff of 0.820 was chosen for the similarity matrix to construct the network, corresponding to a Chi-square test on Poisson distribution of 98.417 and a p-value of 0.001. This resulted in a network with 252 nodes and 2216 edges.</p>
<p>Network properties and parameters are summarized in MENA_network_parameters_Feb2019.xlsx.</p>
</div>
<div id="local-similarity-analysis-fastlsa" class="section level4">
<h4><span class="header-section-number">4.2.1.2</span> Local Similarity Analysis: fastLSA</h4>
<p>The command line program for calcularing local similarity (Durno <em>et al</em>., 2013) was downloaded from <a href="http://hallam.microbiology.ubc.ca/fastLSA/install/index.html" class="uri">http://hallam.microbiology.ubc.ca/fastLSA/install/index.html</a> and run specifying the input file, no time lag (-d 0) and significance level alpha (-a 0.05). All other paramters were kept at their default values. The input data set was a tab delimited text file stripped of OTU labels or sample IDs.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb113-1"><a href="inter-omics.html#cb113-1"></a>$ <span class="ex">./fastLSA</span> -i ../gb_289_feb2019.txt -d 0 -a 0.05 -o ../gb_289_feb2019.out</span></code></pre></div>
<p>The output file, as specified on the website, containes five columns. ‘index1’ and ‘index2’ represent the significant paired indices ranging from 0 to n-1 (OTUs/ASVs). LSA denotes the LSA statistic of each pair, lag was set to 0 with the -d flag and the p-valueBound column provides the p-value’s upper boundary for the significantly paired p-value.</p>
<p>To produce comparable data sets, we replaced the indices with their OTU IDs and removed superfluous columns.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="inter-omics.html#cb114-1"></a>fastLSA &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289_feb2019.out&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb114-2"><a href="inter-omics.html#cb114-2"></a>key &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/fastLSA_index_otu_CORRECTEDfeb2019.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb114-3"><a href="inter-omics.html#cb114-3"></a></span>
<span id="cb114-4"><a href="inter-omics.html#cb114-4"></a>fastLSA<span class="op">$</span>index1_otu &lt;-<span class="st"> </span>key<span class="op">$</span>fastLSA_OTU[<span class="kw">match</span>(fastLSA<span class="op">$</span>index1, key<span class="op">$</span>fastLSA_index)]</span>
<span id="cb114-5"><a href="inter-omics.html#cb114-5"></a>fastLSA<span class="op">$</span>index2_otu &lt;-<span class="st"> </span>key<span class="op">$</span>fastLSA_OTU[<span class="kw">match</span>(fastLSA<span class="op">$</span>index2, key<span class="op">$</span>fastLSA_index)]</span>
<span id="cb114-6"><a href="inter-omics.html#cb114-6"></a></span>
<span id="cb114-7"><a href="inter-omics.html#cb114-7"></a>fastLSA<span class="op">$</span>index1 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb114-8"><a href="inter-omics.html#cb114-8"></a>fastLSA<span class="op">$</span>index2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb114-9"><a href="inter-omics.html#cb114-9"></a>fastLSA<span class="op">$</span>lag &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb114-10"><a href="inter-omics.html#cb114-10"></a>fastLSA<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb114-11"><a href="inter-omics.html#cb114-11"></a>fastLSA &lt;-<span class="st"> </span>fastLSA[, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb114-12"><a href="inter-omics.html#cb114-12"></a>fastLSA &lt;-<span class="st"> </span>fastLSA[<span class="kw">order</span>(fastLSA<span class="op">$</span>p.valueBound), ]</span>
<span id="cb114-13"><a href="inter-omics.html#cb114-13"></a></span>
<span id="cb114-14"><a href="inter-omics.html#cb114-14"></a><span class="kw">write.csv</span>(fastLSA, <span class="st">&quot;fastLSA_for_networks.csv&quot;</span>)</span>
<span id="cb114-15"><a href="inter-omics.html#cb114-15"></a><span class="kw">rm</span>(fastLSA, key)</span></code></pre></div>
<p>LSA scores range from -1 for strong negatively correlations to 1, for strong positive correlations. There were no negative correlations in this data setand we refrained from scaleding the LSA score furhter.
The resulting network contrained <code>length(unique(c(fastLSA$index1, fastLSA$index2)))</code> nodes and <code>(dim(fastLSA)[1])-1</code> edges.</p>
</div>
<div id="sparcc" class="section level4">
<h4><span class="header-section-number">4.2.1.3</span> SparCC</h4>
<p>SparCC (Friedman and Alm, 2012) is a network building algorithm for compositional data and can be found at <a href="https://bitbucket.org/yonatanf/sparcc" class="uri">https://bitbucket.org/yonatanf/sparcc</a>.</p>
<p>Prior to running it I had to get help as there was a minor issue during compilation. SparCC needed specific versions of numpy, panda and python to run properly, which is easiest accomodated in a specific environment. The OTU table needs to be windows formatted text. The embedded code is an example, for the analysis, 500 iterations were combined.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb115-1"><a href="inter-omics.html#cb115-1"></a>$ <span class="bu">cd</span> to working directory with SparCC and the data set gb_289.csv</span>
<span id="cb115-2"><a href="inter-omics.html#cb115-2"></a>$ <span class="bu">source</span> activate sparcc</span>
<span id="cb115-3"><a href="inter-omics.html#cb115-3"></a><span class="ex">python</span> SparCC.py ../gb_sparcc.txt -c ../gb_sparcc_cor_file.txt -v </span>
<span id="cb115-4"><a href="inter-omics.html#cb115-4"></a><span class="ex">../gb_sparcc_coverage_file.txt</span> -i 5</span>
<span id="cb115-5"><a href="inter-omics.html#cb115-5"></a>$ <span class="ex">deactivate</span></span></code></pre></div>
<p>Create a results directory and redirect all the output there. Pseudo p-value Calculation, generates -n shuffled data sets:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb116-1"><a href="inter-omics.html#cb116-1"></a>$ <span class="fu">mkdir</span> results <span class="co">#creates output directory</span></span>
<span id="cb116-2"><a href="inter-omics.html#cb116-2"></a>$ <span class="ex">python</span> MakeBootstraps.py ../gb_sparcc.txt -n 5 -t permutation_#.txt -p ../results/ </span></code></pre></div>
<p>And run SparCC.py on all the re-shuffled data sets:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb117-1"><a href="inter-omics.html#cb117-1"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_0.txt -i 5 --cor_file=../results/perm_cor_0.txt</span>
<span id="cb117-2"><a href="inter-omics.html#cb117-2"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_1.txt -i 5 --cor_file=../results/perm_cor_1.txt</span>
<span id="cb117-3"><a href="inter-omics.html#cb117-3"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_2.txt -i 5 --cor_file=../results/perm_cor_2.txt</span>
<span id="cb117-4"><a href="inter-omics.html#cb117-4"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_3.txt -i 5 --cor_file=../results/perm_cor_3.txt</span>
<span id="cb117-5"><a href="inter-omics.html#cb117-5"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_4.txt -i 5 --cor_file=../results/perm_cor_4.txt</span></code></pre></div>
<p>Generate p-values:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb118-1"><a href="inter-omics.html#cb118-1"></a>$ <span class="ex">python</span> PseudoPvals.py ../results/gb_sparcc_cor_file.txt ../results/perm_cor_#.txt 5 </span>
<span id="cb118-2"><a href="inter-omics.html#cb118-2"></a><span class="ex">-o</span> ../results/pvals.two_sided.txt -t two_sided</span></code></pre></div>
<p>Formatting the resulting data set like so:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="inter-omics.html#cb119-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb119-2"><a href="inter-omics.html#cb119-2"></a>cor_file &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_sparcc_cor_file_289.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb119-3"><a href="inter-omics.html#cb119-3"></a>p_vals &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289_pvals.two_sided.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb119-4"><a href="inter-omics.html#cb119-4"></a></span>
<span id="cb119-5"><a href="inter-omics.html#cb119-5"></a><span class="co"># make OTU ID the rowname</span></span>
<span id="cb119-6"><a href="inter-omics.html#cb119-6"></a><span class="kw">rownames</span>(cor_file) &lt;-<span class="st"> </span>cor_file[, <span class="dv">1</span>]</span>
<span id="cb119-7"><a href="inter-omics.html#cb119-7"></a>cor_file[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb119-8"><a href="inter-omics.html#cb119-8"></a><span class="kw">rownames</span>(p_vals) &lt;-<span class="st"> </span>p_vals[, <span class="dv">1</span>]</span>
<span id="cb119-9"><a href="inter-omics.html#cb119-9"></a>p_vals[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb119-10"><a href="inter-omics.html#cb119-10"></a><span class="co"># check ds congruency</span></span>
<span id="cb119-11"><a href="inter-omics.html#cb119-11"></a><span class="kw">all</span>(<span class="kw">colnames</span>(cor_file) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(cor_file))</span>
<span id="cb119-12"><a href="inter-omics.html#cb119-12"></a><span class="kw">all</span>(<span class="kw">colnames</span>(p_vals) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(p_vals))</span>
<span id="cb119-13"><a href="inter-omics.html#cb119-13"></a></span>
<span id="cb119-14"><a href="inter-omics.html#cb119-14"></a><span class="co"># melt into long format, all vs all comparison: 289^2=83521 rows</span></span>
<span id="cb119-15"><a href="inter-omics.html#cb119-15"></a>cor_file_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(cor_file))</span>
<span id="cb119-16"><a href="inter-omics.html#cb119-16"></a>p_vals_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(p_vals))</span>
<span id="cb119-17"><a href="inter-omics.html#cb119-17"></a></span>
<span id="cb119-18"><a href="inter-omics.html#cb119-18"></a><span class="kw">all</span>(cor_file_m<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> </span>p_vals_m<span class="op">$</span>Var1)</span>
<span id="cb119-19"><a href="inter-omics.html#cb119-19"></a><span class="kw">all</span>(cor_file_m<span class="op">$</span>Var2 <span class="op">==</span><span class="st"> </span>p_vals_m<span class="op">$</span>Var2)</span>
<span id="cb119-20"><a href="inter-omics.html#cb119-20"></a></span>
<span id="cb119-21"><a href="inter-omics.html#cb119-21"></a><span class="co"># complete data set with p_vals and &#39;correlation coeff&#39;</span></span>
<span id="cb119-22"><a href="inter-omics.html#cb119-22"></a>cor_file_m[<span class="st">&quot;p_vals&quot;</span>] &lt;-<span class="st"> </span>p_vals_m<span class="op">$</span>value</span>
<span id="cb119-23"><a href="inter-omics.html#cb119-23"></a></span>
<span id="cb119-24"><a href="inter-omics.html#cb119-24"></a><span class="co"># This removes AB - BA duplicates but still contains self comprisons, AA, BB,CC etc.</span></span>
<span id="cb119-25"><a href="inter-omics.html#cb119-25"></a>cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;Var2&quot;</span>)</span>
<span id="cb119-26"><a href="inter-omics.html#cb119-26"></a>newdf &lt;-<span class="st"> </span>cor_file_m[, cols]  <span class="co">#generate new data set with just those two</span></span>
<span id="cb119-27"><a href="inter-omics.html#cb119-27"></a><span class="co"># a &lt;- Sys.time()</span></span>
<span id="cb119-28"><a href="inter-omics.html#cb119-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(cor_file_m)) {</span>
<span id="cb119-29"><a href="inter-omics.html#cb119-29"></a>    newdf[i, ] =<span class="st"> </span><span class="kw">sort</span>(cor_file_m[i, cols])</span>
<span id="cb119-30"><a href="inter-omics.html#cb119-30"></a>}</span>
<span id="cb119-31"><a href="inter-omics.html#cb119-31"></a><span class="co"># b &lt;- Sys.time() b-a</span></span>
<span id="cb119-32"><a href="inter-omics.html#cb119-32"></a></span>
<span id="cb119-33"><a href="inter-omics.html#cb119-33"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_m[<span class="op">!</span><span class="kw">duplicated</span>(newdf), ]  <span class="co">#and can be removed with duplicate</span></span>
<span id="cb119-34"><a href="inter-omics.html#cb119-34"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_shortened[<span class="kw">which</span>(cor_file_shortened<span class="op">$</span>Var1 <span class="op">!=</span><span class="st"> </span>cor_file_shortened<span class="op">$</span>Var2), ]  <span class="co"># removing self comparison</span></span>
<span id="cb119-35"><a href="inter-omics.html#cb119-35"></a><span class="kw">colnames</span>(cor_file_shortened) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Var1_SparCC&quot;</span>, <span class="st">&quot;Var2_SparCC&quot;</span>, <span class="st">&quot;SparCC&quot;</span>, <span class="st">&quot;pSparCC&quot;</span>)  <span class="co">#41616</span></span>
<span id="cb119-36"><a href="inter-omics.html#cb119-36"></a><span class="kw">write.csv</span>(cor_file_shortened, <span class="st">&quot;data/SparCC_for_networks.csv&quot;</span>)</span>
<span id="cb119-37"><a href="inter-omics.html#cb119-37"></a><span class="kw">rm</span>(cor_file_m, newdf, p_vals_m, i, cols)</span></code></pre></div>
</div>
<div id="maximal-information-coefficient-mic" class="section level4">
<h4><span class="header-section-number">4.2.1.4</span> Maximal information coefficient MIC</h4>
<p>MIC for pariwise interaction was calculated with the R package minearva. The MIC is part of a statistic called Maximal Information-Based Nonparametric Exploration (MINE).</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="inter-omics.html#cb120-1"></a><span class="kw">library</span>(minerva)</span>
<span id="cb120-2"><a href="inter-omics.html#cb120-2"></a></span>
<span id="cb120-3"><a href="inter-omics.html#cb120-3"></a>OTU &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb120-4"><a href="inter-omics.html#cb120-4"></a><span class="kw">rownames</span>(OTU) &lt;-<span class="st"> </span>OTU[, <span class="dv">1</span>]</span>
<span id="cb120-5"><a href="inter-omics.html#cb120-5"></a>OTU[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb120-6"><a href="inter-omics.html#cb120-6"></a>OTU &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(OTU))</span>
<span id="cb120-7"><a href="inter-omics.html#cb120-7"></a></span>
<span id="cb120-8"><a href="inter-omics.html#cb120-8"></a><span class="co"># Calculate MIC of original data set.</span></span>
<span id="cb120-9"><a href="inter-omics.html#cb120-9"></a>MINE &lt;-<span class="st"> </span><span class="kw">mine</span>(OTU)</span>
<span id="cb120-10"><a href="inter-omics.html#cb120-10"></a>MIC &lt;-<span class="st"> </span>MINE<span class="op">$</span>MIC  <span class="co">#dim(MIC): 289 289</span></span></code></pre></div>
<p>Obtaining p-values for this statistic can be achieved by premutation of the original OTU table as below or emprirically, by selecting the thousandth stronges interactions.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="inter-omics.html#cb121-1"></a><span class="co"># 10 needs to be replaced with 1000 for final version, three times!!!  reshuffling the OTU table, saving the MIC to</span></span>
<span id="cb121-2"><a href="inter-omics.html#cb121-2"></a><span class="co"># a list, a total of 1000 times</span></span>
<span id="cb121-3"><a href="inter-omics.html#cb121-3"></a>n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb121-4"><a href="inter-omics.html#cb121-4"></a>results &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb121-5"><a href="inter-omics.html#cb121-5"></a></span>
<span id="cb121-6"><a href="inter-omics.html#cb121-6"></a><span class="co"># For reproducibility, one could e.g.: set.seed(1984)</span></span>
<span id="cb121-7"><a href="inter-omics.html#cb121-7"></a></span>
<span id="cb121-8"><a href="inter-omics.html#cb121-8"></a><span class="co"># c &lt;- Sys.time()</span></span>
<span id="cb121-9"><a href="inter-omics.html#cb121-9"></a><span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) {</span>
<span id="cb121-10"><a href="inter-omics.html#cb121-10"></a>    n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb121-11"><a href="inter-omics.html#cb121-11"></a>    mock &lt;-<span class="st"> </span><span class="kw">apply</span>(OTU, <span class="dt">MARGIN =</span> <span class="dv">2</span>, sample)</span>
<span id="cb121-12"><a href="inter-omics.html#cb121-12"></a>    mock_mine &lt;-<span class="st"> </span><span class="kw">mine</span>(mock)</span>
<span id="cb121-13"><a href="inter-omics.html#cb121-13"></a>    results[[n]] &lt;-<span class="st"> </span>mock_mine<span class="op">$</span>MIC</span>
<span id="cb121-14"><a href="inter-omics.html#cb121-14"></a>}</span>
<span id="cb121-15"><a href="inter-omics.html#cb121-15"></a><span class="co"># d &lt;- Sys.time() d-c</span></span>
<span id="cb121-16"><a href="inter-omics.html#cb121-16"></a></span>
<span id="cb121-17"><a href="inter-omics.html#cb121-17"></a><span class="co"># for every element of the true matrix, go through all the same elements in the 1000 generated mock matrix MIC</span></span>
<span id="cb121-18"><a href="inter-omics.html#cb121-18"></a><span class="co"># indices and count how many of those are greater.</span></span>
<span id="cb121-19"><a href="inter-omics.html#cb121-19"></a>MIC &lt;-<span class="st"> </span>MINE<span class="op">$</span>MIC</span>
<span id="cb121-20"><a href="inter-omics.html#cb121-20"></a></span>
<span id="cb121-21"><a href="inter-omics.html#cb121-21"></a>e_values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="kw">nrow</span>(MIC), <span class="dt">ncol =</span> <span class="kw">ncol</span>(MIC), <span class="dt">data =</span> <span class="dv">0</span>)</span>
<span id="cb121-22"><a href="inter-omics.html#cb121-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(MIC)) {</span>
<span id="cb121-23"><a href="inter-omics.html#cb121-23"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(MIC)) {</span>
<span id="cb121-24"><a href="inter-omics.html#cb121-24"></a>        n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb121-25"><a href="inter-omics.html#cb121-25"></a>        <span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) {</span>
<span id="cb121-26"><a href="inter-omics.html#cb121-26"></a>            n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb121-27"><a href="inter-omics.html#cb121-27"></a>            <span class="cf">if</span> (results[[n]][i, j] <span class="op">&gt;=</span><span class="st"> </span>MIC[i, j]) {</span>
<span id="cb121-28"><a href="inter-omics.html#cb121-28"></a>                e_values[i, j] &lt;-<span class="st"> </span>e_values[i, j] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb121-29"><a href="inter-omics.html#cb121-29"></a>            }</span>
<span id="cb121-30"><a href="inter-omics.html#cb121-30"></a>        }</span>
<span id="cb121-31"><a href="inter-omics.html#cb121-31"></a>    }</span>
<span id="cb121-32"><a href="inter-omics.html#cb121-32"></a>}</span>
<span id="cb121-33"><a href="inter-omics.html#cb121-33"></a></span>
<span id="cb121-34"><a href="inter-omics.html#cb121-34"></a>e_values &lt;-<span class="st"> </span>e_values<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb121-35"><a href="inter-omics.html#cb121-35"></a><span class="co"># write.csv(e_values, &#39;data/MIC_e_values.csv&#39;)</span></span></code></pre></div>
<p>For n=1000, the first part takes about 8 mins on one core, the second part about 2 min. The relevant output is saved in the initial calculations of the MIC and the corresponding e-values are in e_values. These are symmetric matrices that will be reduced to a long table with unique OTUs/ASVs pairs, their MIC and the e-value. For clarity, all other files are removed.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="inter-omics.html#cb122-1"></a><span class="kw">rm</span>(MINE, mock, mock_mine, results)</span>
<span id="cb122-2"><a href="inter-omics.html#cb122-2"></a></span>
<span id="cb122-3"><a href="inter-omics.html#cb122-3"></a><span class="co"># transforming symmetric matrix to unique-pair long format</span></span>
<span id="cb122-4"><a href="inter-omics.html#cb122-4"></a>cor_file &lt;-<span class="st"> </span><span class="kw">data.frame</span>(MIC)</span>
<span id="cb122-5"><a href="inter-omics.html#cb122-5"></a>p_vals &lt;-<span class="st"> </span><span class="kw">data.frame</span>(e_values)</span>
<span id="cb122-6"><a href="inter-omics.html#cb122-6"></a></span>
<span id="cb122-7"><a href="inter-omics.html#cb122-7"></a><span class="co"># inspect the files, adapt them and test congruency</span></span>
<span id="cb122-8"><a href="inter-omics.html#cb122-8"></a><span class="kw">rownames</span>(p_vals) &lt;-<span class="st"> </span><span class="kw">rownames</span>(cor_file)</span>
<span id="cb122-9"><a href="inter-omics.html#cb122-9"></a><span class="kw">colnames</span>(p_vals) &lt;-<span class="st"> </span><span class="kw">colnames</span>(cor_file)</span>
<span id="cb122-10"><a href="inter-omics.html#cb122-10"></a><span class="kw">all</span>(<span class="kw">colnames</span>(cor_file) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(cor_file))</span>
<span id="cb122-11"><a href="inter-omics.html#cb122-11"></a></span>
<span id="cb122-12"><a href="inter-omics.html#cb122-12"></a><span class="co"># melt into long format, all vs all comparison: 289*289=83521 rows</span></span>
<span id="cb122-13"><a href="inter-omics.html#cb122-13"></a>cor_file_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(cor_file))</span>
<span id="cb122-14"><a href="inter-omics.html#cb122-14"></a><span class="kw">all</span>(<span class="kw">colnames</span>(p_vals) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(p_vals))</span>
<span id="cb122-15"><a href="inter-omics.html#cb122-15"></a>p_vals_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(p_vals))</span>
<span id="cb122-16"><a href="inter-omics.html#cb122-16"></a></span>
<span id="cb122-17"><a href="inter-omics.html#cb122-17"></a><span class="co"># complete data set with p_vals</span></span>
<span id="cb122-18"><a href="inter-omics.html#cb122-18"></a>cor_file_m[<span class="st">&quot;p_vals&quot;</span>] &lt;-<span class="st"> </span>p_vals_m<span class="op">$</span>value</span>
<span id="cb122-19"><a href="inter-omics.html#cb122-19"></a></span>
<span id="cb122-20"><a href="inter-omics.html#cb122-20"></a><span class="co"># This removes AB - BA duplicates but still contains self comprisons, AA, BB, etc.</span></span>
<span id="cb122-21"><a href="inter-omics.html#cb122-21"></a>cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;Var2&quot;</span>)</span>
<span id="cb122-22"><a href="inter-omics.html#cb122-22"></a>newdf &lt;-<span class="st"> </span>cor_file_m[, cols]  <span class="co">#generate new data set with just those two</span></span>
<span id="cb122-23"><a href="inter-omics.html#cb122-23"></a></span>
<span id="cb122-24"><a href="inter-omics.html#cb122-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(cor_file_m)) {</span>
<span id="cb122-25"><a href="inter-omics.html#cb122-25"></a>    newdf[i, ] &lt;-<span class="st"> </span><span class="kw">sort</span>(cor_file_m[i, cols])</span>
<span id="cb122-26"><a href="inter-omics.html#cb122-26"></a>}</span>
<span id="cb122-27"><a href="inter-omics.html#cb122-27"></a></span>
<span id="cb122-28"><a href="inter-omics.html#cb122-28"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_m[<span class="op">!</span><span class="kw">duplicated</span>(newdf), ]  <span class="co">#and can be removed with duplicate</span></span>
<span id="cb122-29"><a href="inter-omics.html#cb122-29"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_shortened[<span class="kw">which</span>(cor_file_shortened<span class="op">$</span>Var1 <span class="op">!=</span><span class="st"> </span>cor_file_shortened<span class="op">$</span>Var2), ]  <span class="co"># removing self comparison</span></span>
<span id="cb122-30"><a href="inter-omics.html#cb122-30"></a><span class="kw">rm</span>(cor_file_m, newdf, p_vals_m, i, cols)</span>
<span id="cb122-31"><a href="inter-omics.html#cb122-31"></a></span>
<span id="cb122-32"><a href="inter-omics.html#cb122-32"></a><span class="co"># write.csv(cor_file_shortened, &#39;data/MIC_for_networks.csv&#39;)</span></span></code></pre></div>
</div>
</div>
<div id="consolidation-of-the-different-networks" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Consolidation of the different networks</h3>
<div id="mic" class="section level4">
<h4><span class="header-section-number">4.2.2.1</span> MIC</h4>
<p>MIC allows to detect a variety of interactions. According to the manual of the R wrapper minerva, the resulting MIC score “is related to the relationship strenght and it can be interpreted as a correlation measure. It is symmetric and it ranges in [0,1], where it tends to 0 for statistically independent data and it approaches 1 in probability for noiseless functional relationships”. Thus, it also contains strong negative relationship up to mutual exclusivity, which we want to filter out.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="inter-omics.html#cb123-1"></a>mic &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MIC_for_networks.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb123-2"><a href="inter-omics.html#cb123-2"></a>mic<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb123-3"><a href="inter-omics.html#cb123-3"></a><span class="kw">colnames</span>(mic) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_mic&quot;</span>, <span class="st">&quot;node2_mic&quot;</span>, <span class="st">&quot;MIC&quot;</span>, <span class="st">&quot;pMIC&quot;</span>)</span></code></pre></div>
<p>Initially, the MIC network generated by the R wrapper minerva contained MIC values for all possible edges (i.e. 41616). Of those, 4370 edges/interactions had a p-value <span class="math inline">\(\leq\)</span> 0.05. As we will only include those edges in the final network, we select those and calculate the linear regression coefficient and p-value for the regression, to test whether we are able to distinguish negative from positive interaction.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="inter-omics.html#cb124-1"></a><span class="co"># Original OTU table for regressions</span></span>
<span id="cb124-2"><a href="inter-omics.html#cb124-2"></a>OTU &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb124-3"><a href="inter-omics.html#cb124-3"></a><span class="kw">rownames</span>(OTU) &lt;-<span class="st"> </span>OTU[, <span class="dv">1</span>]</span>
<span id="cb124-4"><a href="inter-omics.html#cb124-4"></a>OTU[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb124-5"><a href="inter-omics.html#cb124-5"></a>OTU[<span class="st">&quot;ID&quot;</span>] &lt;-<span class="st"> </span><span class="kw">row.names</span>(OTU)</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="inter-omics.html#cb125-1"></a><span class="co"># goal: in mic data frame, set to &#39;NA&#39; MIC and pMIC of edges with a significant p-value for MIC that have a</span></span>
<span id="cb125-2"><a href="inter-omics.html#cb125-2"></a><span class="co"># significant negative regression</span></span>
<span id="cb125-3"><a href="inter-omics.html#cb125-3"></a></span>
<span id="cb125-4"><a href="inter-omics.html#cb125-4"></a>mic[<span class="st">&quot;regression&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb125-5"><a href="inter-omics.html#cb125-5"></a>mic[<span class="st">&quot;p_regression&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb125-6"><a href="inter-omics.html#cb125-6"></a></span>
<span id="cb125-7"><a href="inter-omics.html#cb125-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mic)) {</span>
<span id="cb125-8"><a href="inter-omics.html#cb125-8"></a>    bac1 &lt;-<span class="st"> </span><span class="kw">factor</span>(mic[i, <span class="dv">1</span>])</span>
<span id="cb125-9"><a href="inter-omics.html#cb125-9"></a>    bac2 &lt;-<span class="st"> </span><span class="kw">factor</span>(mic[i, <span class="dv">2</span>])</span>
<span id="cb125-10"><a href="inter-omics.html#cb125-10"></a>    temp_ds &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">rbind</span>(OTU[OTU<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span>bac1, ], OTU[OTU<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span>bac2, ])))</span>
<span id="cb125-11"><a href="inter-omics.html#cb125-11"></a>    temp_ds &lt;-<span class="st"> </span>temp_ds[<span class="op">-</span><span class="kw">c</span>(<span class="dv">15</span>), ]</span>
<span id="cb125-12"><a href="inter-omics.html#cb125-12"></a>    temp_ds[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(temp_ds, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) </span>
<span id="cb125-13"><a href="inter-omics.html#cb125-13"></a>        <span class="kw">factor</span>(x) <span class="cf">else</span> x)  <span class="co"># removes factors, not sure if necessary</span></span>
<span id="cb125-14"><a href="inter-omics.html#cb125-14"></a>    mic<span class="op">$</span>regression[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">c</span>(temp_ds[, <span class="dv">1</span>]) <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(temp_ds[, <span class="dv">2</span>])))<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co">#slope</span></span>
<span id="cb125-15"><a href="inter-omics.html#cb125-15"></a>    mic<span class="op">$</span>p_regression[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">c</span>(temp_ds[, <span class="dv">1</span>]) <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(temp_ds[, <span class="dv">2</span>])))<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>]  <span class="co">#p-val</span></span>
<span id="cb125-16"><a href="inter-omics.html#cb125-16"></a>}</span>
<span id="cb125-17"><a href="inter-omics.html#cb125-17"></a></span>
<span id="cb125-18"><a href="inter-omics.html#cb125-18"></a>before &lt;-<span class="st"> </span><span class="kw">sum</span>(mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>)  <span class="co">#4370</span></span>
<span id="cb125-19"><a href="inter-omics.html#cb125-19"></a>mic<span class="op">$</span>MIC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>regression <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>p_regression <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="ot">NA</span>, mic<span class="op">$</span>MIC)</span>
<span id="cb125-20"><a href="inter-omics.html#cb125-20"></a>mic<span class="op">$</span>pMIC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>regression <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>p_regression <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="ot">NA</span>, mic<span class="op">$</span>pMIC)</span>
<span id="cb125-21"><a href="inter-omics.html#cb125-21"></a>after &lt;-<span class="st"> </span><span class="kw">sum</span>(mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> T)  <span class="co">#3522</span></span>
<span id="cb125-22"><a href="inter-omics.html#cb125-22"></a></span>
<span id="cb125-23"><a href="inter-omics.html#cb125-23"></a><span class="kw">write.csv</span>(mic, <span class="st">&quot;data/MIC.csv&quot;</span>)</span>
<span id="cb125-24"><a href="inter-omics.html#cb125-24"></a><span class="kw">rm</span>(temp_ds, bac1, bac2, i, mic)</span></code></pre></div>
<p>The MIC data set initially contained 41616 edges, 4370 of which were significant prior to the removal of negative correlations and leaving 3522 edges with a p-value <span class="math inline">\(\leq\)</span> 0.05.</p>
</div>
<div id="sparcc-1" class="section level4">
<h4><span class="header-section-number">4.2.2.2</span> SparCC</h4>
<p>The next network data set is based on the SparCC algorithm for computing correlations in compositional data.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="inter-omics.html#cb126-1"></a>sparcc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/SparCC_for_networks.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb126-2"><a href="inter-omics.html#cb126-2"></a>sparcc<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb126-3"><a href="inter-omics.html#cb126-3"></a><span class="kw">colnames</span>(sparcc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_sparcc&quot;</span>, <span class="st">&quot;node2_sparcc&quot;</span>, <span class="st">&quot;SparCC&quot;</span>, <span class="st">&quot;pSparCC&quot;</span>)</span>
<span id="cb126-4"><a href="inter-omics.html#cb126-4"></a><span class="co"># hist(sparcc$SparCC) hist(sparcc$pSparCC)</span></span>
<span id="cb126-5"><a href="inter-omics.html#cb126-5"></a>sparcc<span class="op">$</span>pSparCC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((sparcc<span class="op">$</span>SparCC <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, sparcc<span class="op">$</span>pSparCC)  <span class="co">#setting the p-values of negative interactions to NA</span></span>
<span id="cb126-6"><a href="inter-omics.html#cb126-6"></a>sparcc<span class="op">$</span>SparCC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((sparcc<span class="op">$</span>SparCC <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, sparcc<span class="op">$</span>SparCC)  <span class="co">#setting negative interactions to NA</span></span></code></pre></div>
<p>The network based on the SparCC algorithm contained 41616 edges of which 20420 negative interactions that were removed. 6622 significant positive edges remain.</p>
</div>
<div id="mena" class="section level4">
<h4><span class="header-section-number">4.2.2.3</span> MENA</h4>
<p>The next two network data sets are generated by MENA based on random matrix theory.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="inter-omics.html#cb127-1"></a>mena_pcc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MENA_0.800_PCC_edge_attribute.txt&quot;</span>, <span class="dt">header =</span> F, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb127-2"><a href="inter-omics.html#cb127-2"></a><span class="co"># &#39;np&#39; in V2 and -1 in V5 mean negative interaction, these should be removed.</span></span>
<span id="cb127-3"><a href="inter-omics.html#cb127-3"></a><span class="kw">dim</span>(mena_pcc)[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">dim</span>(mena_pcc[mena_pcc<span class="op">$</span>V5 <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>, ])[<span class="dv">1</span>]  <span class="co"># Number of pos interactions</span></span></code></pre></div>
<pre><code>## [1] 171</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="inter-omics.html#cb129-1"></a>mena_pcc[<span class="st">&quot;pMENA_PCC&quot;</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mena_pcc<span class="op">$</span>V5 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, <span class="fl">0.001</span>)</span>
<span id="cb129-2"><a href="inter-omics.html#cb129-2"></a>mena_pcc<span class="op">$</span>V2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb129-3"><a href="inter-omics.html#cb129-3"></a>mena_pcc<span class="op">$</span>V4 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb129-4"><a href="inter-omics.html#cb129-4"></a>mena_pcc<span class="op">$</span>V5 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb129-5"><a href="inter-omics.html#cb129-5"></a><span class="kw">colnames</span>(mena_pcc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_mena&quot;</span>, <span class="st">&quot;node2_mena&quot;</span>, <span class="st">&quot;pMENA_PCC&quot;</span>)</span>
<span id="cb129-6"><a href="inter-omics.html#cb129-6"></a></span>
<span id="cb129-7"><a href="inter-omics.html#cb129-7"></a>mena_scc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MENA_0.820_SCC_edge_attribute.txt&quot;</span>, <span class="dt">header =</span> F, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb129-8"><a href="inter-omics.html#cb129-8"></a><span class="kw">dim</span>(mena_scc)[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">dim</span>(mena_scc[mena_scc<span class="op">$</span>V5 <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>, ])[<span class="dv">1</span>]  <span class="co"># Number of pos interactions</span></span></code></pre></div>
<pre><code>## [1] 317</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="inter-omics.html#cb131-1"></a>mena_scc[<span class="st">&quot;pMENA_SCC&quot;</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mena_scc<span class="op">$</span>V5 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, <span class="fl">0.001</span>)</span>
<span id="cb131-2"><a href="inter-omics.html#cb131-2"></a>mena_scc<span class="op">$</span>V2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb131-3"><a href="inter-omics.html#cb131-3"></a>mena_scc<span class="op">$</span>V4 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb131-4"><a href="inter-omics.html#cb131-4"></a>mena_scc<span class="op">$</span>V5 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb131-5"><a href="inter-omics.html#cb131-5"></a><span class="kw">colnames</span>(mena_scc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_mena&quot;</span>, <span class="st">&quot;node2_mena&quot;</span>, <span class="st">&quot;pMENA_SCC&quot;</span>)</span></code></pre></div>
<p>MENA network with Pearson correlation contained 3582 edges of which 3411 negative interactions were removed. For Spearman correlations, the network contained 2216 edges of which 1899 negative interactions were removed.</p>
</div>
<div id="lsa" class="section level4">
<h4><span class="header-section-number">4.2.2.4</span> LSA</h4>
<p>The next network data set is based on local similarity. It does not contain any negative values for LSA, so we do not exclude any edges.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="inter-omics.html#cb132-1"></a>lsa &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/fastLSA_for_networks.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb132-2"><a href="inter-omics.html#cb132-2"></a>lsa<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb132-3"><a href="inter-omics.html#cb132-3"></a><span class="kw">colnames</span>(lsa) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_lsa&quot;</span>, <span class="st">&quot;node2_lsa&quot;</span>, <span class="st">&quot;LSA&quot;</span>, <span class="st">&quot;pLSA&quot;</span>)</span>
<span id="cb132-4"><a href="inter-omics.html#cb132-4"></a><span class="kw">dim</span>(lsa)[<span class="dv">1</span>]  <span class="co"># Number of edges</span></span></code></pre></div>
<pre><code>## [1] 208</code></pre>
</div>
<div id="integration-of-the-networks" class="section level4">
<h4><span class="header-section-number">4.2.2.5</span> Integration of the networks</h4>
<p>Now we combine all five networks into one data set.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="inter-omics.html#cb134-1"></a>mic &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MIC.csv&quot;</span>, <span class="dt">header =</span> T)</span>
<span id="cb134-2"><a href="inter-omics.html#cb134-2"></a>mic<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb134-3"><a href="inter-omics.html#cb134-3"></a>mic<span class="op">$</span>regression &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb134-4"><a href="inter-omics.html#cb134-4"></a>mic<span class="op">$</span>p_regression &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb134-5"><a href="inter-omics.html#cb134-5"></a>master_summary &lt;-<span class="st"> </span>mic</span>
<span id="cb134-6"><a href="inter-omics.html#cb134-6"></a></span>
<span id="cb134-7"><a href="inter-omics.html#cb134-7"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb134-8"><a href="inter-omics.html#cb134-8"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, lsa, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node2_lsa&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node1_lsa&quot;</span>))</span>
<span id="cb134-9"><a href="inter-omics.html#cb134-9"></a><span class="co"># sum(!is.na(master_summary$pLSA))==nrow(lsa) #TRUE</span></span>
<span id="cb134-10"><a href="inter-omics.html#cb134-10"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, sparcc, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node1_sparcc&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node2_sparcc&quot;</span>))</span>
<span id="cb134-11"><a href="inter-omics.html#cb134-11"></a><span class="co"># sum(!is.na(master_summary$pSparCC))==sum(!is.na(sparcc$pSparCC)) #TRUE</span></span>
<span id="cb134-12"><a href="inter-omics.html#cb134-12"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, mena_pcc, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node2_mena&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node1_mena&quot;</span>))</span>
<span id="cb134-13"><a href="inter-omics.html#cb134-13"></a><span class="co"># sum(!is.na(master_summary$pMENA_PCC))==sum(!is.na(mena_pcc$pMENA_PCC)) #TRUE</span></span>
<span id="cb134-14"><a href="inter-omics.html#cb134-14"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, mena_scc, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node2_mena&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node1_mena&quot;</span>))</span>
<span id="cb134-15"><a href="inter-omics.html#cb134-15"></a><span class="co"># sum(!is.na(master_summary$pMENA_SCC))==sum(!is.na(mena_scc$pMENA_SCC)) #TRUE</span></span>
<span id="cb134-16"><a href="inter-omics.html#cb134-16"></a>master_summary &lt;-<span class="st"> </span>master_summary[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)]  <span class="co">#reorder columns</span></span>
<span id="cb134-17"><a href="inter-omics.html#cb134-17"></a><span class="kw">head</span>(master_summary)</span>
<span id="cb134-18"><a href="inter-omics.html#cb134-18"></a><span class="co"># write.csv(master_summary, &#39;data/master_summary_networks_1.csv&#39;, row.names = FALSE)</span></span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="inter-omics.html#cb135-1"></a><span class="co"># For p-value merging: metap::sumlog, or EmpiricalBrownsMethod::EBM</span></span>
<span id="cb135-2"><a href="inter-omics.html#cb135-2"></a><span class="kw">library</span>(metap)</span>
<span id="cb135-3"><a href="inter-omics.html#cb135-3"></a></span>
<span id="cb135-4"><a href="inter-omics.html#cb135-4"></a>ms &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/master_summary_networks_1.csv&quot;</span>, <span class="dt">header =</span> T)</span>
<span id="cb135-5"><a href="inter-omics.html#cb135-5"></a><span class="kw">head</span>(ms)</span></code></pre></div>
<pre><code>##      node1_mic  node2_mic  pMIC pLSA pSparCC pMENA_PCC pMENA_SCC       MIC LSA     SparCC
## 1 OTU196900135 OTU1969004 0.918   NA     0.0        NA        NA 0.1601125  NA  0.5372737
## 2 OTU196900136 OTU1969004 0.068   NA     0.0        NA        NA 0.5087257  NA  0.6541941
## 3 OTU196900137 OTU1969004 0.008   NA     0.6        NA        NA 0.6052891  NA  0.5449118
## 4 OTU196900138 OTU1969004 0.222   NA     0.0        NA        NA 0.3705065  NA -0.5931877
## 5 OTU196900139 OTU1969004 0.247   NA     0.8        NA        NA 0.3705065  NA  0.0806820
## 6 OTU196900140 OTU1969004 0.015   NA     0.6        NA        NA 0.6893917  NA  0.1745214</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="inter-omics.html#cb137-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb137-2"><a href="inter-omics.html#cb137-2"></a><span class="kw">hist</span>(ms<span class="op">$</span>pMIC)</span>
<span id="cb137-3"><a href="inter-omics.html#cb137-3"></a><span class="kw">hist</span>(ms<span class="op">$</span>pLSA)  <span class="co">#xlim = range(0,1)</span></span>
<span id="cb137-4"><a href="inter-omics.html#cb137-4"></a><span class="kw">hist</span>(ms<span class="op">$</span>pSparCC)</span>
<span id="cb137-5"><a href="inter-omics.html#cb137-5"></a><span class="kw">plot</span>(ms<span class="op">$</span>pMENA_PCC)</span>
<span id="cb137-6"><a href="inter-omics.html#cb137-6"></a><span class="kw">plot</span>(ms<span class="op">$</span>pMENA_SCC)</span>
<span id="cb137-7"><a href="inter-omics.html#cb137-7"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/integration2-1.png" width="80%" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="inter-omics.html#cb138-1"></a><span class="co"># metap::sumlog doesn&#39;t think 0 is a valid p-value, replace all zeros with small non-zero values, e.g. half-minimum</span></span>
<span id="cb138-2"><a href="inter-omics.html#cb138-2"></a>ms<span class="op">$</span>pSparCC[ms<span class="op">$</span>pSparCC <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="fl">0.005</span></span>
<span id="cb138-3"><a href="inter-omics.html#cb138-3"></a>ms<span class="op">$</span>pMIC[ms<span class="op">$</span>pMIC <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="fl">5e-04</span></span>
<span id="cb138-4"><a href="inter-omics.html#cb138-4"></a></span>
<span id="cb138-5"><a href="inter-omics.html#cb138-5"></a>ms[<span class="st">&quot;NA_count&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb138-6"><a href="inter-omics.html#cb138-6"></a>ms[<span class="st">&quot;signif_0.05&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb138-7"><a href="inter-omics.html#cb138-7"></a>ms[<span class="st">&quot;signif_0.001&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb138-8"><a href="inter-omics.html#cb138-8"></a>ms[<span class="st">&quot;sumlog&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb138-9"><a href="inter-omics.html#cb138-9"></a></span>
<span id="cb138-10"><a href="inter-omics.html#cb138-10"></a>n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb138-11"><a href="inter-omics.html#cb138-11"></a>k &lt;-<span class="st"> </span><span class="kw">dim</span>(ms)[<span class="dv">1</span>]</span>
<span id="cb138-12"><a href="inter-omics.html#cb138-12"></a><span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span>k) {</span>
<span id="cb138-13"><a href="inter-omics.html#cb138-13"></a>    n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb138-14"><a href="inter-omics.html#cb138-14"></a>    ms<span class="op">$</span>NA_count[n] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">is.na</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb138-15"><a href="inter-omics.html#cb138-15"></a>    ms<span class="op">$</span>signif_<span class="fl">0.05</span>[n] &lt;-<span class="st"> </span><span class="kw">sum</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> T)</span>
<span id="cb138-16"><a href="inter-omics.html#cb138-16"></a>    ms<span class="op">$</span>signif_<span class="fl">0.001</span>[n] &lt;-<span class="st"> </span><span class="kw">sum</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.001</span>, <span class="dt">na.rm =</span> T)</span>
<span id="cb138-17"><a href="inter-omics.html#cb138-17"></a>    <span class="kw">ifelse</span>((ms<span class="op">$</span>NA_count[n] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>), (ms<span class="op">$</span>sumlog[n] &lt;-<span class="st"> </span><span class="kw">sumlog</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>][<span class="op">!</span><span class="kw">is.na</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>])])<span class="op">$</span>p), <span class="ot">NA</span>)</span>
<span id="cb138-18"><a href="inter-omics.html#cb138-18"></a>}</span>
<span id="cb138-19"><a href="inter-omics.html#cb138-19"></a><span class="kw">rm</span>(k, n)</span>
<span id="cb138-20"><a href="inter-omics.html#cb138-20"></a></span>
<span id="cb138-21"><a href="inter-omics.html#cb138-21"></a>ms[<span class="st">&quot;p.adjust_Bonferroni&quot;</span>] &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(ms<span class="op">$</span>sumlog, <span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb138-22"><a href="inter-omics.html#cb138-22"></a>ms[<span class="st">&quot;p.adjust_FDR&quot;</span>] &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(ms<span class="op">$</span>sumlog, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)  <span class="co">#aka Benjamini &amp; Hochberg</span></span>
<span id="cb138-23"><a href="inter-omics.html#cb138-23"></a></span>
<span id="cb138-24"><a href="inter-omics.html#cb138-24"></a><span class="kw">write.csv</span>(ms, <span class="st">&quot;data/master_summary_networks_2.csv&quot;</span>)</span>
<span id="cb138-25"><a href="inter-omics.html#cb138-25"></a></span>
<span id="cb138-26"><a href="inter-omics.html#cb138-26"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb138-27"><a href="inter-omics.html#cb138-27"></a><span class="kw">hist</span>(ms<span class="op">$</span>signif_<span class="fl">0.05</span>, <span class="dt">main =</span> <span class="st">&quot;p-values &lt;= 0.05&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Counts per edge &quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb138-28"><a href="inter-omics.html#cb138-28"></a><span class="kw">hist</span>(ms<span class="op">$</span>signif_<span class="fl">0.001</span>, <span class="dt">main =</span> <span class="st">&quot;p-values &lt;= 0.001&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Counts per edge &quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb138-29"><a href="inter-omics.html#cb138-29"></a><span class="kw">hist</span>(ms<span class="op">$</span>NA_count, <span class="dt">main =</span> <span class="st">&quot;NAs&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Counts per edge &quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/integration2-2.png" width="80%" /></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="inter-omics.html#cb139-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb139-2"><a href="inter-omics.html#cb139-2"></a></span>
<span id="cb139-3"><a href="inter-omics.html#cb139-3"></a>ds &lt;-<span class="st"> </span><span class="kw">split</span>(ms, ms<span class="op">$</span>signif_<span class="fl">0.05</span>)</span>
<span id="cb139-4"><a href="inter-omics.html#cb139-4"></a>raw_nodes &lt;-<span class="st"> </span><span class="kw">rbind</span>(ds<span class="op">$</span><span class="st">`</span><span class="dt">4</span><span class="st">`</span>, ds<span class="op">$</span><span class="st">`</span><span class="dt">5</span><span class="st">`</span>)  <span class="co"># Selection/inclusion criterion</span></span>
<span id="cb139-5"><a href="inter-omics.html#cb139-5"></a><span class="kw">rm</span>(ds)</span></code></pre></div>
<p>We selected all edges with at least 4 p-values <span class="math inline">\(\leq\)</span> 0.05 (n=155) to visualise in the network.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="inter-omics.html#cb140-1"></a><span class="kw">library</span>(igraph)</span>
<span id="cb140-2"><a href="inter-omics.html#cb140-2"></a></span>
<span id="cb140-3"><a href="inter-omics.html#cb140-3"></a>edges &lt;-<span class="st"> </span>raw_nodes[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb140-4"><a href="inter-omics.html#cb140-4"></a>nodes &lt;-<span class="st"> </span><span class="kw">union</span>(raw_nodes<span class="op">$</span>node1_mic, raw_nodes<span class="op">$</span>node2_mic)</span>
<span id="cb140-5"><a href="inter-omics.html#cb140-5"></a></span>
<span id="cb140-6"><a href="inter-omics.html#cb140-6"></a></span>
<span id="cb140-7"><a href="inter-omics.html#cb140-7"></a><span class="co">### K###</span></span>
<span id="cb140-8"><a href="inter-omics.html#cb140-8"></a>meta_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;~/Documents/Metabolomics/Depth_Gradient_study/R_depth_study/Network_analyses_R/gb_attributes_barettin_vip2.csv&quot;</span>, </span>
<span id="cb140-9"><a href="inter-omics.html#cb140-9"></a>    <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb140-10"><a href="inter-omics.html#cb140-10"></a><span class="co"># head(meta_data)</span></span>
<span id="cb140-11"><a href="inter-omics.html#cb140-11"></a>meta_data &lt;-<span class="st"> </span>meta_data[meta_data<span class="op">$</span>OTU_otu <span class="op">%in%</span><span class="st"> </span>nodes, ]</span>
<span id="cb140-12"><a href="inter-omics.html#cb140-12"></a><span class="co"># head(meta_data) str(meta_data)</span></span>
<span id="cb140-13"><a href="inter-omics.html#cb140-13"></a>meta_data<span class="op">$</span>OTU_num &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb140-14"><a href="inter-omics.html#cb140-14"></a>meta_data<span class="op">$</span>order &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb140-15"><a href="inter-omics.html#cb140-15"></a>nodes &lt;-<span class="st"> </span>meta_data</span>
<span id="cb140-16"><a href="inter-omics.html#cb140-16"></a>nodes<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb140-17"><a href="inter-omics.html#cb140-17"></a>nodes<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">ifelse</span>(nodes<span class="op">$</span>bar_scale_abs <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="kw">as.character</span>(nodes<span class="op">$</span>OTU_otu), <span class="ot">NA</span>)</span>
<span id="cb140-18"><a href="inter-omics.html#cb140-18"></a><span class="co"># sum(!is.na(nodes$labels)) #18 nodes$labels head(nodes, n=20)</span></span>
<span id="cb140-19"><a href="inter-omics.html#cb140-19"></a>nodes<span class="op">$</span>labels &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern =</span> <span class="st">&quot;OTU196900&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> nodes<span class="op">$</span>labels, <span class="dt">ignore.case =</span> F)</span>
<span id="cb140-20"><a href="inter-omics.html#cb140-20"></a>nodes[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(nodes, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) <span class="kw">factor</span>(x) <span class="cf">else</span> x)</span>
<span id="cb140-21"><a href="inter-omics.html#cb140-21"></a></span>
<span id="cb140-22"><a href="inter-omics.html#cb140-22"></a>net &lt;-<span class="st"> </span><span class="kw">graph_from_data_frame</span>(<span class="dt">d =</span> edges, <span class="dt">vertices =</span> nodes, <span class="dt">directed =</span> F)</span>
<span id="cb140-23"><a href="inter-omics.html#cb140-23"></a></span>
<span id="cb140-24"><a href="inter-omics.html#cb140-24"></a><span class="co"># plot(net) l &lt;- layout_with_kk(net) plot(net, edge.arrow.size=.4,vertex.label=NA, layout=l) #plot again</span></span>
<span id="cb140-25"><a href="inter-omics.html#cb140-25"></a></span>
<span id="cb140-26"><a href="inter-omics.html#cb140-26"></a><span class="co"># Barettin highligted (orange node size)</span></span>
<span id="cb140-27"><a href="inter-omics.html#cb140-27"></a>l &lt;-<span class="st"> </span><span class="kw">layout_with_kk</span>(net)</span>
<span id="cb140-28"><a href="inter-omics.html#cb140-28"></a><span class="kw">plot</span>(net, <span class="dt">edge.arrow.size =</span> <span class="fl">0.2</span>, <span class="dt">edge.color =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">vertex.color =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">vertex.frame.color =</span> <span class="st">&quot;#ffffff&quot;</span>, <span class="dt">vertex.label =</span> <span class="ot">NA</span>, </span>
<span id="cb140-29"><a href="inter-omics.html#cb140-29"></a>    <span class="dt">vertex.label.color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>bar_scale_rel <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">layout =</span> l)</span>
<span id="cb140-30"><a href="inter-omics.html#cb140-30"></a></span>
<span id="cb140-31"><a href="inter-omics.html#cb140-31"></a><span class="co"># node info and classification for all nodes correlated with barettin</span></span>
<span id="cb140-32"><a href="inter-omics.html#cb140-32"></a>node_info &lt;-<span class="st"> </span>nodes[, <span class="kw">c</span>(<span class="st">&quot;OTU_otu&quot;</span>, <span class="st">&quot;phylum&quot;</span>, <span class="st">&quot;class&quot;</span>)][nodes<span class="op">$</span>bar_scale_abs <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]</span>
<span id="cb140-33"><a href="inter-omics.html#cb140-33"></a>node_info[<span class="st">&quot;counter&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co">#for quick grasp with aggregate</span></span>
<span id="cb140-34"><a href="inter-omics.html#cb140-34"></a>node_info</span>
<span id="cb140-35"><a href="inter-omics.html#cb140-35"></a><span class="kw">nrow</span>(node_info)  <span class="co">#18</span></span>
<span id="cb140-36"><a href="inter-omics.html#cb140-36"></a>node_info[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(node_info, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) <span class="kw">factor</span>(x) <span class="cf">else</span> x)  <span class="co">#dropping factors from full data set for all columns</span></span>
<span id="cb140-37"><a href="inter-omics.html#cb140-37"></a>node_info[<span class="kw">order</span>(node_info<span class="op">$</span>phylum, node_info<span class="op">$</span>class), ]</span>
<span id="cb140-38"><a href="inter-omics.html#cb140-38"></a><span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>phylum, <span class="dt">data =</span> node_info, sum)</span>
<span id="cb140-39"><a href="inter-omics.html#cb140-39"></a><span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>class, <span class="dt">data =</span> node_info, sum)</span>
<span id="cb140-40"><a href="inter-omics.html#cb140-40"></a></span>
<span id="cb140-41"><a href="inter-omics.html#cb140-41"></a><span class="co"># Taxonomy coloring &amp; barettin: Phylum</span></span>
<span id="cb140-42"><a href="inter-omics.html#cb140-42"></a>ecol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;gray80&quot;</span>, <span class="kw">ecount</span>(net))</span>
<span id="cb140-43"><a href="inter-omics.html#cb140-43"></a>vcol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;grey40&quot;</span>, <span class="kw">vcount</span>(net))</span>
<span id="cb140-44"><a href="inter-omics.html#cb140-44"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>phylum <span class="op">==</span><span class="st"> &quot;Proteobacteria&quot;</span>] &lt;-<span class="st"> &quot;yellow&quot;</span></span>
<span id="cb140-45"><a href="inter-omics.html#cb140-45"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>phylum <span class="op">==</span><span class="st"> &quot;Acidobacteria&quot;</span>] &lt;-<span class="st"> &quot;purple&quot;</span></span>
<span id="cb140-46"><a href="inter-omics.html#cb140-46"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>phylum <span class="op">==</span><span class="st"> &quot;Chloroflexi&quot;</span>] &lt;-<span class="st"> &quot;blue&quot;</span></span>
<span id="cb140-47"><a href="inter-omics.html#cb140-47"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>phylum <span class="op">==</span><span class="st"> &quot;Gemmatimonadetes&quot;</span>] &lt;-<span class="st"> &quot;red&quot;</span></span>
<span id="cb140-48"><a href="inter-omics.html#cb140-48"></a><span class="co"># The unclassified OTU196900307 will be displayed in grey.</span></span>
<span id="cb140-49"><a href="inter-omics.html#cb140-49"></a><span class="kw">plot</span>(net, <span class="dt">vertex.color =</span> vcol, <span class="dt">edge.color =</span> ecol, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>bar_scale_rel <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">edge.width =</span> <span class="kw">E</span>(net)<span class="op">$</span>value<span class="op">^</span><span class="dv">2</span>, </span>
<span id="cb140-50"><a href="inter-omics.html#cb140-50"></a>    <span class="dt">vertex.label =</span> <span class="ot">NA</span>, <span class="dt">layout =</span> l)</span>
<span id="cb140-51"><a href="inter-omics.html#cb140-51"></a></span>
<span id="cb140-52"><a href="inter-omics.html#cb140-52"></a><span class="co"># PUBLICATION FIGURE Taxonomy coloring &amp; barettin: Class</span></span>
<span id="cb140-53"><a href="inter-omics.html#cb140-53"></a>ecol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;gray80&quot;</span>, <span class="kw">ecount</span>(net))</span>
<span id="cb140-54"><a href="inter-omics.html#cb140-54"></a>vcol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;grey40&quot;</span>, <span class="kw">vcount</span>(net))</span>
<span id="cb140-55"><a href="inter-omics.html#cb140-55"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;Holophagae&quot;</span>] &lt;-<span class="st"> &quot;#9e0142&quot;</span></span>
<span id="cb140-56"><a href="inter-omics.html#cb140-56"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;Subgroup_15&quot;</span>] &lt;-<span class="st"> &quot;#d53e4f&quot;</span></span>
<span id="cb140-57"><a href="inter-omics.html#cb140-57"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;Subgroup_6&quot;</span>] &lt;-<span class="st"> &quot;#f46d43&quot;</span></span>
<span id="cb140-58"><a href="inter-omics.html#cb140-58"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;Anaerolineae&quot;</span>] &lt;-<span class="st"> &quot;#fdae61&quot;</span></span>
<span id="cb140-59"><a href="inter-omics.html#cb140-59"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;JG30-KF-CM66&quot;</span>] &lt;-<span class="st"> &quot;#fee08b&quot;</span></span>
<span id="cb140-60"><a href="inter-omics.html#cb140-60"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;SAR202_clade&quot;</span>] &lt;-<span class="st"> &quot;#e6f598&quot;</span></span>
<span id="cb140-61"><a href="inter-omics.html#cb140-61"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;TK10&quot;</span>] &lt;-<span class="st"> &quot;#abdda4&quot;</span></span>
<span id="cb140-62"><a href="inter-omics.html#cb140-62"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;BD2-11_terrestrial_group&quot;</span>] &lt;-<span class="st"> &quot;#66c2a5&quot;</span></span>
<span id="cb140-63"><a href="inter-omics.html#cb140-63"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;Alphaproteobacteria&quot;</span>] &lt;-<span class="st"> &quot;#3288bd&quot;</span></span>
<span id="cb140-64"><a href="inter-omics.html#cb140-64"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;JTB23&quot;</span>] &lt;-<span class="st"> &quot;#5e4fa2&quot;</span></span>
<span id="cb140-65"><a href="inter-omics.html#cb140-65"></a></span>
<span id="cb140-66"><a href="inter-omics.html#cb140-66"></a>colrs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#9e0142&quot;</span>, <span class="st">&quot;#d53e4f&quot;</span>, <span class="st">&quot;#f46d43&quot;</span>, <span class="st">&quot;#fdae61&quot;</span>, <span class="st">&quot;#fee08b&quot;</span>, <span class="st">&quot;#e6f598&quot;</span>, <span class="st">&quot;#abdda4&quot;</span>, <span class="st">&quot;#66c2a5&quot;</span>, <span class="st">&quot;#3288bd&quot;</span>, <span class="st">&quot;#5e4fa2&quot;</span>)</span>
<span id="cb140-67"><a href="inter-omics.html#cb140-67"></a><span class="kw">V</span>(net)<span class="op">$</span>color &lt;-<span class="st"> </span>colrs[<span class="kw">V</span>(net)<span class="op">$</span>class]</span>
<span id="cb140-68"><a href="inter-omics.html#cb140-68"></a></span>
<span id="cb140-69"><a href="inter-omics.html#cb140-69"></a><span class="co"># PUBLICATION FIGURE</span></span>
<span id="cb140-70"><a href="inter-omics.html#cb140-70"></a><span class="kw">plot</span>(net, <span class="dt">vertex.color =</span> vcol, <span class="dt">edge.color =</span> ecol, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>bar_scale_rel <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">edge.width =</span> <span class="kw">E</span>(net)<span class="op">$</span>value<span class="op">^</span><span class="dv">2</span>, </span>
<span id="cb140-71"><a href="inter-omics.html#cb140-71"></a>    <span class="dt">vertex.label =</span> <span class="ot">NA</span>, <span class="dt">layout =</span> l)</span>
<span id="cb140-72"><a href="inter-omics.html#cb140-72"></a><span class="co"># legend(x=-2.1, y=0.5, c(&#39;Holophagae (Acidobacteria)&#39;,&#39;Subgroup_15 (Acidobacteria)&#39;, &#39;Subgroup_6 (Acidobacteria)&#39;,</span></span>
<span id="cb140-73"><a href="inter-omics.html#cb140-73"></a><span class="co"># &#39;Anaerolineae (Chloroflexi)&#39;, &#39;JG30-KF-CM66 (Chloroflexi)&#39;, &#39;SAR202_clade (Chloroflexi)&#39;, &#39;TK10 (Chloroflexi)&#39;,</span></span>
<span id="cb140-74"><a href="inter-omics.html#cb140-74"></a><span class="co"># &#39;BD2-11_terrestrial_group (Gemmatimonadetes)&#39;, &#39;Alphaproteobacteria (Proteobacteria)&#39;, &#39;JTB23 (Proteobacteria)&#39;),</span></span>
<span id="cb140-75"><a href="inter-omics.html#cb140-75"></a><span class="co"># pt.bg=colrs, pch=21,col=&#39;#777777&#39;, pt.cex=2, cex=.8, bty=&#39;n&#39;, ncol=1)</span></span>
<span id="cb140-76"><a href="inter-omics.html#cb140-76"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="fl">-2.9</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="kw">c</span>(<span class="st">&quot;Holophagae (Acidobacteria)&quot;</span>, <span class="st">&quot;Subgroup_15 (Acidobacteria)&quot;</span>, <span class="st">&quot;Subgroup_6 (Acidobacteria)&quot;</span>, </span>
<span id="cb140-77"><a href="inter-omics.html#cb140-77"></a>    <span class="st">&quot;Anaerolineae (Chloroflexi)&quot;</span>, <span class="st">&quot;JG30-KF-CM66 (Chloroflexi)&quot;</span>, <span class="st">&quot;SAR202_clade (Chloroflexi)&quot;</span>, <span class="st">&quot;TK10 (Chloroflexi)&quot;</span>, </span>
<span id="cb140-78"><a href="inter-omics.html#cb140-78"></a>    <span class="st">&quot;BD2-11_terrestrial_group (Gemmatimonadetes)&quot;</span>, <span class="st">&quot;Alphaproteobacteria (Proteobacteria)&quot;</span>, <span class="st">&quot;JTB23 (Proteobacteria)&quot;</span>), </span>
<span id="cb140-79"><a href="inter-omics.html#cb140-79"></a>    <span class="dt">pt.bg =</span> colrs, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="dt">pt.cex =</span> <span class="fl">1.5</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb140-80"><a href="inter-omics.html#cb140-80"></a></span>
<span id="cb140-81"><a href="inter-omics.html#cb140-81"></a><span class="co"># Labels, personal use</span></span>
<span id="cb140-82"><a href="inter-omics.html#cb140-82"></a><span class="kw">plot</span>(net, <span class="dt">vertex.color =</span> vcol, <span class="dt">edge.color =</span> ecol, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>bar_scale_rel <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">edge.width =</span> <span class="kw">E</span>(net)<span class="op">$</span>value<span class="op">^</span><span class="dv">2</span>, </span>
<span id="cb140-83"><a href="inter-omics.html#cb140-83"></a>    <span class="dt">vertex.label =</span> <span class="kw">V</span>(net)<span class="op">$</span>labels, <span class="dt">layout =</span> l)</span>
<span id="cb140-84"><a href="inter-omics.html#cb140-84"></a><span class="co"># legend(x=-2.1, y=0.5, c(&#39;Holophagae (Acidobacteria)&#39;,&#39;Subgroup_15 (Acidobacteria)&#39;, &#39;Subgroup_6 (Acidobacteria)&#39;,</span></span>
<span id="cb140-85"><a href="inter-omics.html#cb140-85"></a><span class="co"># &#39;Anaerolineae (Chloroflexi)&#39;, &#39;JG30-KF-CM66 (Chloroflexi)&#39;, &#39;SAR202_clade (Chloroflexi)&#39;, &#39;TK10 (Chloroflexi)&#39;,</span></span>
<span id="cb140-86"><a href="inter-omics.html#cb140-86"></a><span class="co"># &#39;BD2-11_terrestrial_group (Gemmatimonadetes)&#39;, &#39;Alphaproteobacteria (Proteobacteria)&#39;, &#39;JTB23 (Proteobacteria)&#39;),</span></span>
<span id="cb140-87"><a href="inter-omics.html#cb140-87"></a><span class="co"># pt.bg=colrs, pch=21,col=&#39;#777777&#39;, pt.cex=2, cex=.8, bty=&#39;n&#39;, ncol=1)</span></span>
<span id="cb140-88"><a href="inter-omics.html#cb140-88"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="fl">-2.9</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="kw">c</span>(<span class="st">&quot;Holophagae (Acidobacteria)&quot;</span>, <span class="st">&quot;Subgroup_15 (Acidobacteria)&quot;</span>, <span class="st">&quot;Subgroup_6 (Acidobacteria)&quot;</span>, </span>
<span id="cb140-89"><a href="inter-omics.html#cb140-89"></a>    <span class="st">&quot;Anaerolineae (Chloroflexi)&quot;</span>, <span class="st">&quot;JG30-KF-CM66 (Chloroflexi)&quot;</span>, <span class="st">&quot;SAR202_clade (Chloroflexi)&quot;</span>, <span class="st">&quot;TK10 (Chloroflexi)&quot;</span>, </span>
<span id="cb140-90"><a href="inter-omics.html#cb140-90"></a>    <span class="st">&quot;BD2-11_terrestrial_group (Gemmatimonadetes)&quot;</span>, <span class="st">&quot;Alphaproteobacteria (Proteobacteria)&quot;</span>, <span class="st">&quot;JTB23 (Proteobacteria)&quot;</span>), </span>
<span id="cb140-91"><a href="inter-omics.html#cb140-91"></a>    <span class="dt">pt.bg =</span> colrs, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="dt">pt.cex =</span> <span class="fl">1.5</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb140-92"><a href="inter-omics.html#cb140-92"></a></span>
<span id="cb140-93"><a href="inter-omics.html#cb140-93"></a></span>
<span id="cb140-94"><a href="inter-omics.html#cb140-94"></a><span class="co"># VIPs</span></span>
<span id="cb140-95"><a href="inter-omics.html#cb140-95"></a>l &lt;-<span class="st"> </span><span class="kw">layout_with_kk</span>(net)</span>
<span id="cb140-96"><a href="inter-omics.html#cb140-96"></a><span class="kw">plot</span>(net, <span class="dt">edge.arrow.size =</span> <span class="fl">0.2</span>, <span class="dt">edge.color =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">vertex.color =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">vertex.frame.color =</span> <span class="st">&quot;#ffffff&quot;</span>, <span class="dt">vertex.label =</span> <span class="ot">NA</span>, </span>
<span id="cb140-97"><a href="inter-omics.html#cb140-97"></a>    <span class="dt">vertex.label.color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>vip_scale_rel <span class="op">*</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">layout =</span> l)</span></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="inter-omics.html#cb141-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.14.6
## 
## Matrix products: default
## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] metap_1.3               minerva_1.5.8           reshape_0.8.8           rnaturalearthdata_0.1.0
##  [5] rnaturalearth_0.1.0     sf_0.8-1                ggrepel_0.8.2           marmap_1.0.3           
##  [9] mapdata_2.3.0           maps_3.3.0              ggmap_3.0.0.901         bookdown_0.18          
## [13] reshape2_1.4.3          vegan_2.5-6             lattice_0.20-41         permute_0.9-5          
## [17] forcats_0.5.0           stringr_1.4.0           purrr_0.3.3             readr_1.3.1            
## [21] tidyr_1.0.2             tibble_3.0.0            tidyverse_1.3.0         ropls_1.14.1           
## [25] kableExtra_1.1.0.9000   dplyr_0.8.5             usdm_1.1-18             raster_3.0-12          
## [29] sp_1.4-1                gridExtra_2.3           ggplot2_3.3.0           knitr_1.28             
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.3.1        backports_1.1.5     sn_1.6-1            plyr_1.8.6          splines_3.5.1      
##   [6] TH.data_1.0-10      usethis_1.5.1       digest_0.6.25       htmltools_0.4.0     fansi_0.4.1        
##  [11] magrittr_1.5        memoise_1.1.0       cluster_2.1.0       remotes_2.1.1       modelr_0.1.6       
##  [16] sandwich_2.5-1      prettyunits_1.1.1   jpeg_0.1-8.1        colorspace_1.4-1    blob_1.2.1         
##  [21] rvest_0.3.5         haven_2.2.0         xfun_0.13.1         callr_3.4.3         crayon_1.3.4       
##  [26] jsonlite_1.6.1      survival_3.1-11     zoo_1.8-7           glue_1.3.2          gtable_0.3.0       
##  [31] webshot_0.5.2       pkgbuild_1.0.6      shape_1.4.4         BiocGenerics_0.28.0 scales_1.1.0       
##  [36] mvtnorm_1.1-0       DBI_1.1.0           bibtex_0.4.2.2      Rcpp_1.0.4          plotrix_3.7-7      
##  [41] isoband_0.2.0       viridisLite_0.3.0   units_0.6-6         bit_1.1-15.2        stats4_3.5.1       
##  [46] httr_1.4.1          TFisher_0.2.0       ellipsis_0.3.0      pkgconfig_2.0.3     farver_2.0.3       
##  [51] dbplyr_1.4.2        utf8_1.1.4          tidyselect_1.0.0    labeling_0.3        rlang_0.4.5        
##  [56] munsell_0.5.0       cellranger_1.1.0    tools_3.5.1         cli_2.0.2           generics_0.0.2     
##  [61] RSQLite_2.2.0       devtools_2.2.2      broom_0.5.5         evaluate_0.14       yaml_2.2.1         
##  [66] processx_3.4.2      bit64_0.9-7         fs_1.4.0            RgoogleMaps_1.4.5.3 ncdf4_1.17         
##  [71] nlme_3.1-145        formatR_1.7         xml2_1.3.0          compiler_3.5.1      rstudioapi_0.11    
##  [76] curl_4.3            png_0.1-7           e1071_1.7-3         testthat_2.3.2      reprex_0.3.0       
##  [81] stringi_1.4.6       highr_0.8           ps_1.3.2            desc_1.2.0          rgeos_0.5-2        
##  [86] Matrix_1.2-18       classInt_0.4-2      multtest_2.38.0     vctrs_0.2.4         mutoss_0.1-12      
##  [91] pillar_1.4.3        lifecycle_0.2.0     Rdpack_0.11-1       bitops_1.0-6        gbRd_0.4-11        
##  [96] R6_2.4.1            KernSmooth_2.23-16  sessioninfo_1.1.1   codetools_0.2-16    MASS_7.3-51.5      
## [101] assertthat_0.2.1    pkgload_1.0.2       rprojroot_1.3-2     rjson_0.2.20        withr_2.1.2        
## [106] mnormt_1.5-6        multcomp_1.4-12     adehabitatMA_0.3.14 mgcv_1.8-31         parallel_3.5.1     
## [111] hms_0.5.3           class_7.3-16        rmarkdown_2.1       numDeriv_2016.8-1.1 Biobase_2.42.0     
## [116] lubridate_1.7.4</code></pre>


</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="microbiota.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="funding-disclaimer.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges.pdf", "Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
