<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges</title>
  <meta name="description" content="4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Inter-omics | Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges" />
  
  
  

<meta name="author" content="Karin Steffen" />


<meta name="date" content="2020-07-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="microbiota.html"/>
<link rel="next" href="funding-disclaimer.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SUPPLEMENTARY MATERIAL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Content</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#experimental-setup"><i class="fa fa-check"></i><b>1.1</b> Experimental setup</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#map"><i class="fa fa-check"></i><b>1.1.1</b> Map</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#water-masses"><i class="fa fa-check"></i><b>1.1.2</b> Water masses</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#sponges"><i class="fa fa-check"></i><b>1.1.3</b> Sponges</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sample-metadata-analysis"><i class="fa fa-check"></i><b>1.2</b> Sample metadata analysis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#index_cor_vif"><i class="fa fa-check"></i><b>1.2.1</b> Correlations, visual inspection and variance inflation factors (VIF) across all samples</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#correlations-visual-inspection-and-variance-inflation-factors-vif-across-g.-barretti-samples"><i class="fa fa-check"></i><b>1.2.2</b> Correlations, visual inspection and variance inflation factors (VIF) across <em>G. barretti</em> samples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="metabolomics.html"><a href="metabolomics.html"><i class="fa fa-check"></i><b>2</b> Metabolomics</a><ul>
<li class="chapter" data-level="2.1" data-path="metabolomics.html"><a href="metabolomics.html#experimental-methods-and-detailed-description"><i class="fa fa-check"></i><b>2.1</b> Experimental methods and detailed description</a></li>
<li class="chapter" data-level="2.2" data-path="metabolomics.html"><a href="metabolomics.html#data-processing"><i class="fa fa-check"></i><b>2.2</b> Data processing</a><ul>
<li class="chapter" data-level="2.2.1" data-path="metabolomics.html"><a href="metabolomics.html#peak-picking-with-xcms-and-annotation-with-camera"><i class="fa fa-check"></i><b>2.2.1</b> Peak picking with XCMS and annotation with CAMERA</a></li>
<li class="chapter" data-level="2.2.2" data-path="metabolomics.html"><a href="metabolomics.html#hilic-hydrophilic-interaction-chromatography-column-with-positive-esi-electron-spray-ionisation"><i class="fa fa-check"></i><b>2.2.2</b> HILIC (Hydrophilic interaction chromatography) column with positive ESI (electron spray ionisation)</a></li>
<li class="chapter" data-level="2.2.3" data-path="metabolomics.html"><a href="metabolomics.html#hilic-chromatography-with-negative-esi"><i class="fa fa-check"></i><b>2.2.3</b> HILIC Chromatography with negative ESI</a></li>
<li class="chapter" data-level="2.2.4" data-path="metabolomics.html"><a href="metabolomics.html#rp-reversed-phase-chromatography-with-positive-esi"><i class="fa fa-check"></i><b>2.2.4</b> RP (Reversed phase) Chromatography with positive ESI</a></li>
<li class="chapter" data-level="2.2.5" data-path="metabolomics.html"><a href="metabolomics.html#rp-chromatography-with-negative-esi"><i class="fa fa-check"></i><b>2.2.5</b> RP Chromatography with negative ESI</a></li>
<li class="chapter" data-level="2.2.6" data-path="metabolomics.html"><a href="metabolomics.html#filtering-of-the-raw-data-set"><i class="fa fa-check"></i><b>2.2.6</b> Filtering of the raw data set</a></li>
<li class="chapter" data-level="2.2.7" data-path="metabolomics.html"><a href="metabolomics.html#data-quality-control"><i class="fa fa-check"></i><b>2.2.7</b> Data quality control</a></li>
<li class="chapter" data-level="2.2.8" data-path="metabolomics.html"><a href="metabolomics.html#summary-of-data-processing"><i class="fa fa-check"></i><b>2.2.8</b> Summary of data processing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="metabolomics.html"><a href="metabolomics.html#chromatorgrams"><i class="fa fa-check"></i><b>2.3</b> Chromatorgrams</a></li>
<li class="chapter" data-level="2.4" data-path="metabolomics.html"><a href="metabolomics.html#multivariate-analyses"><i class="fa fa-check"></i><b>2.4</b> Multivariate analyses</a></li>
<li class="chapter" data-level="2.5" data-path="metabolomics.html"><a href="metabolomics.html#vips"><i class="fa fa-check"></i><b>2.5</b> VIPS</a></li>
<li class="chapter" data-level="2.6" data-path="metabolomics.html"><a href="metabolomics.html#metabolites-and-correlations"><i class="fa fa-check"></i><b>2.6</b> Metabolites and correlations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="microbiota.html"><a href="microbiota.html"><i class="fa fa-check"></i><b>3</b> Microbiota</a><ul>
<li class="chapter" data-level="3.1" data-path="microbiota.html"><a href="microbiota.html#otu-table-overview"><i class="fa fa-check"></i><b>3.1</b> OTU table overview</a></li>
<li class="chapter" data-level="3.2" data-path="microbiota.html"><a href="microbiota.html#alpha-diversity"><i class="fa fa-check"></i><b>3.2</b> Alpha diversity</a></li>
<li class="chapter" data-level="3.3" data-path="microbiota.html"><a href="microbiota.html#beta-diversity"><i class="fa fa-check"></i><b>3.3</b> Beta diversity</a></li>
<li class="chapter" data-level="3.4" data-path="microbiota.html"><a href="microbiota.html#EnvMod"><i class="fa fa-check"></i><b>3.4</b> Environmental modelling</a><ul>
<li class="chapter" data-level="3.4.1" data-path="microbiota.html"><a href="microbiota.html#constrained"><i class="fa fa-check"></i><b>3.4.1</b> Constrained modelling approach Automatic stepwise model building</a></li>
<li class="chapter" data-level="3.4.2" data-path="microbiota.html"><a href="microbiota.html#unconstrained"><i class="fa fa-check"></i><b>3.4.2</b> Unconstrained modelling approach</a></li>
<li class="chapter" data-level="3.4.3" data-path="microbiota.html"><a href="microbiota.html#Hclust"><i class="fa fa-check"></i><b>3.4.3</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="3.4.4" data-path="microbiota.html"><a href="microbiota.html#watermasses"><i class="fa fa-check"></i><b>3.4.4</b> Oceanographic setting: water masses</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="microbiota.html"><a href="microbiota.html#relative-abundances"><i class="fa fa-check"></i><b>3.5</b> Relative abundances</a><ul>
<li class="chapter" data-level="3.5.1" data-path="microbiota.html"><a href="microbiota.html#bar-plots"><i class="fa fa-check"></i><b>3.5.1</b> Bar plots</a></li>
<li class="chapter" data-level="3.5.2" data-path="microbiota.html"><a href="microbiota.html#tabular-overview"><i class="fa fa-check"></i><b>3.5.2</b> Tabular overview</a></li>
<li class="chapter" data-level="3.5.3" data-path="microbiota.html"><a href="microbiota.html#statistical-comparison-at-phylum-and-class-level"><i class="fa fa-check"></i><b>3.5.3</b> Statistical comparison at phylum and class level</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="microbiota.html"><a href="microbiota.html#depth-response-otu-perspective"><i class="fa fa-check"></i><b>3.6</b> Depth response: OTU perspective</a></li>
<li class="chapter" data-level="3.7" data-path="microbiota.html"><a href="microbiota.html#sequence-similarity"><i class="fa fa-check"></i><b>3.7</b> Sequence similarity</a></li>
<li class="chapter" data-level="3.8" data-path="microbiota.html"><a href="microbiota.html#annotated-phylogeny"><i class="fa fa-check"></i><b>3.8</b> Annotated phylogeny</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inter-omics.html"><a href="inter-omics.html"><i class="fa fa-check"></i><b>4</b> Inter-omics</a><ul>
<li class="chapter" data-level="4.1" data-path="inter-omics.html"><a href="inter-omics.html#mantel-test-and-procrustes-rotations"><i class="fa fa-check"></i><b>4.1</b> Mantel test and procrustes rotations</a><ul>
<li class="chapter" data-level="4.1.1" data-path="inter-omics.html"><a href="inter-omics.html#libraries-and-functions"><i class="fa fa-check"></i><b>4.1.1</b> Libraries and functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="inter-omics.html"><a href="inter-omics.html#data-sets"><i class="fa fa-check"></i><b>4.1.2</b> Data sets</a></li>
<li class="chapter" data-level="4.1.3" data-path="inter-omics.html"><a href="inter-omics.html#mantel-test-code-and-tabular-output"><i class="fa fa-check"></i><b>4.1.3</b> Mantel test code and tabular output</a></li>
<li class="chapter" data-level="4.1.4" data-path="inter-omics.html"><a href="inter-omics.html#procrustes-rotation-and-protest-code-and-tabular-output"><i class="fa fa-check"></i><b>4.1.4</b> Procrustes rotation and protest code and tabular output</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="inter-omics.html"><a href="inter-omics.html#correlating-barettin-and-prokaryotic-relative-abundance"><i class="fa fa-check"></i><b>4.2</b> Correlating barettin and prokaryotic relative abundance</a></li>
<li class="chapter" data-level="4.3" data-path="inter-omics.html"><a href="inter-omics.html#microbial-interaction-network"><i class="fa fa-check"></i><b>4.3</b> Microbial interaction network</a><ul>
<li class="chapter" data-level="4.3.1" data-path="inter-omics.html"><a href="inter-omics.html#generating-network-based-on-different-algorithms"><i class="fa fa-check"></i><b>4.3.1</b> Generating network based on different algorithms</a></li>
<li class="chapter" data-level="4.3.2" data-path="inter-omics.html"><a href="inter-omics.html#consolidation-of-the-different-networks"><i class="fa fa-check"></i><b>4.3.2</b> Consolidation of the different networks</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="inter-omics.html"><a href="inter-omics.html#shortlist"><i class="fa fa-check"></i><b>4.4</b> Shortlist</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="funding-disclaimer.html"><a href="funding-disclaimer.html"><i class="fa fa-check"></i><b>5</b> Funding disclaimer</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Oceanographic setting influences the prokaryote community and metabolome in deep-sea sponges</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inter-omics" class="section level1">
<h1><span class="header-section-number">4</span> Inter-omics</h1>
<p>The inter-omics analyses are comprised of three parts. In the first part, we evaluate congruency of the prokaryotic and metabolomic data set as a whole using numerical methods (Mantel test) and ordination (Procrustes rotation and Protest). The second part consists of generating a microbial interaction network and annotating it with depth response of the OTUs and correlation with the barettin signal. In the third part, we rank OTUs based on properties hypothesised to be true for the producer of barettin.</p>
<div id="mantel-test-and-procrustes-rotations" class="section level2">
<h2><span class="header-section-number">4.1</span> Mantel test and procrustes rotations</h2>
<div id="libraries-and-functions" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Libraries and functions</h3>
</div>
<div id="data-sets" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Data sets</h3>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="inter-omics.html#cb174-1"></a><span class="co"># LOAD DATA</span></span>
<span id="cb174-2"><a href="inter-omics.html#cb174-2"></a>micro &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/OTU_all_R.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb174-3"><a href="inter-omics.html#cb174-3"></a><span class="kw">colnames</span>(micro)[<span class="kw">colnames</span>(micro) <span class="op">==</span><span class="st"> &quot;Sample_ID&quot;</span>] &lt;-<span class="st"> &quot;unified_ID&quot;</span></span>
<span id="cb174-4"><a href="inter-omics.html#cb174-4"></a>micro &lt;-<span class="st"> </span>micro[<span class="kw">order</span>(micro<span class="op">$</span>unified_ID), ]</span>
<span id="cb174-5"><a href="inter-omics.html#cb174-5"></a><span class="kw">rownames</span>(micro) &lt;-<span class="st"> </span>micro<span class="op">$</span>unified_ID</span>
<span id="cb174-6"><a href="inter-omics.html#cb174-6"></a>micro[<span class="st">&quot;spec&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(micro<span class="op">$</span>unified_ID, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb174-7"><a href="inter-omics.html#cb174-7"></a></span>
<span id="cb174-8"><a href="inter-omics.html#cb174-8"></a>meta_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/PANGAEA_Final.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb174-9"><a href="inter-omics.html#cb174-9"></a>masslynx &lt;-<span class="st"> </span>meta_data</span>
<span id="cb174-10"><a href="inter-omics.html#cb174-10"></a>masslynx &lt;-<span class="st"> </span>masslynx[<span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;LC.MS.HILIC.positive&quot;</span>, <span class="st">&quot;LC.MS.HILIC.negative&quot;</span>, <span class="st">&quot;LC.MS.RP.positive&quot;</span>, <span class="st">&quot;LC.MS.RP.negative&quot;</span>)]</span>
<span id="cb174-11"><a href="inter-omics.html#cb174-11"></a><span class="kw">colnames</span>(masslynx) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;H_p&quot;</span>, <span class="st">&quot;H_n&quot;</span>, <span class="st">&quot;R_p&quot;</span>, <span class="st">&quot;R_n&quot;</span>)</span>
<span id="cb174-12"><a href="inter-omics.html#cb174-12"></a>masslynx &lt;-<span class="st"> </span><span class="kw">na.omit</span>(masslynx)</span>
<span id="cb174-13"><a href="inter-omics.html#cb174-13"></a>masslynx[<span class="st">&quot;HILIC_pos&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>H_p, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb174-14"><a href="inter-omics.html#cb174-14"></a>masslynx[<span class="st">&quot;HILIC_neg&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>H_n, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb174-15"><a href="inter-omics.html#cb174-15"></a>masslynx[<span class="st">&quot;RP_pos&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>R_p, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb174-16"><a href="inter-omics.html#cb174-16"></a>masslynx[<span class="st">&quot;RP_neg&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(masslynx<span class="op">$</span>R_n, <span class="dv">1</span>, <span class="dv">-3</span>)</span>
<span id="cb174-17"><a href="inter-omics.html#cb174-17"></a></span>
<span id="cb174-18"><a href="inter-omics.html#cb174-18"></a><span class="co"># load one set of experiments at a time, i.e. CLEANED, ION or PC_GROUPS</span></span>
<span id="cb174-19"><a href="inter-omics.html#cb174-19"></a></span>
<span id="cb174-20"><a href="inter-omics.html#cb174-20"></a><span class="co">### CLEANED</span></span>
<span id="cb174-21"><a href="inter-omics.html#cb174-21"></a>hilic_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_pos_20190417_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-22"><a href="inter-omics.html#cb174-22"></a>hilic_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_neg_20190421_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-23"><a href="inter-omics.html#cb174-23"></a>rp_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_pos_20190421_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-24"><a href="inter-omics.html#cb174-24"></a>rp_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_neg_20190422_cleaned.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-25"><a href="inter-omics.html#cb174-25"></a></span>
<span id="cb174-26"><a href="inter-omics.html#cb174-26"></a><span class="co">### ION</span></span>
<span id="cb174-27"><a href="inter-omics.html#cb174-27"></a>hilic_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_pos_20190417_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-28"><a href="inter-omics.html#cb174-28"></a>hilic_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_neg_20190421_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-29"><a href="inter-omics.html#cb174-29"></a>rp_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_pos_20190421_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-30"><a href="inter-omics.html#cb174-30"></a>rp_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_neg_20190422_cleaned_MH.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-31"><a href="inter-omics.html#cb174-31"></a></span>
<span id="cb174-32"><a href="inter-omics.html#cb174-32"></a><span class="co">### PC_GROUPS</span></span>
<span id="cb174-33"><a href="inter-omics.html#cb174-33"></a>hilic_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_pos_20190417_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-34"><a href="inter-omics.html#cb174-34"></a>hilic_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/HILIC_neg_20190421_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-35"><a href="inter-omics.html#cb174-35"></a>rp_pos &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_pos_20190421_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb174-36"><a href="inter-omics.html#cb174-36"></a>rp_neg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/RP_neg_20190422_cleaned_pcgroup.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
</div>
<div id="mantel-test-code-and-tabular-output" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Mantel test code and tabular output</h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="inter-omics.html#cb175-1"></a><span class="co">### =============================== MANTEL </span><span class="al">TEST</span><span class="co">=================================</span></span>
<span id="cb175-2"><a href="inter-omics.html#cb175-2"></a></span>
<span id="cb175-3"><a href="inter-omics.html#cb175-3"></a><span class="co"># run one of this at a time</span></span>
<span id="cb175-4"><a href="inter-omics.html#cb175-4"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_pos, <span class="st">&quot;H_p&quot;</span>)</span>
<span id="cb175-5"><a href="inter-omics.html#cb175-5"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_neg, <span class="st">&quot;H_n&quot;</span>)</span>
<span id="cb175-6"><a href="inter-omics.html#cb175-6"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_pos, <span class="st">&quot;R_p&quot;</span>)</span>
<span id="cb175-7"><a href="inter-omics.html#cb175-7"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_neg, <span class="st">&quot;R_n&quot;</span>)</span>
<span id="cb175-8"><a href="inter-omics.html#cb175-8"></a></span>
<span id="cb175-9"><a href="inter-omics.html#cb175-9"></a><span class="co"># run this</span></span>
<span id="cb175-10"><a href="inter-omics.html#cb175-10"></a>congruent_dfs &lt;-<span class="st"> </span><span class="kw">congruency</span>(metabolomes)</span>
<span id="cb175-11"><a href="inter-omics.html#cb175-11"></a></span>
<span id="cb175-12"><a href="inter-omics.html#cb175-12"></a><span class="co"># run one of these: MANTEL </span><span class="al">TEST</span></span>
<span id="cb175-13"><a href="inter-omics.html#cb175-13"></a>diagnostics_hp_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb175-14"><a href="inter-omics.html#cb175-14"></a>diagnostics_hn_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb175-15"><a href="inter-omics.html#cb175-15"></a>diagnostics_rp_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb175-16"><a href="inter-omics.html#cb175-16"></a>diagnostics_rn_cleaned &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb175-17"><a href="inter-omics.html#cb175-17"></a></span>
<span id="cb175-18"><a href="inter-omics.html#cb175-18"></a>diagnostics_hp_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb175-19"><a href="inter-omics.html#cb175-19"></a>diagnostics_hn_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb175-20"><a href="inter-omics.html#cb175-20"></a>diagnostics_rp_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb175-21"><a href="inter-omics.html#cb175-21"></a>diagnostics_rn_ion &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb175-22"><a href="inter-omics.html#cb175-22"></a></span>
<span id="cb175-23"><a href="inter-omics.html#cb175-23"></a>diagnostics_hp_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb175-24"><a href="inter-omics.html#cb175-24"></a>diagnostics_hn_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb175-25"><a href="inter-omics.html#cb175-25"></a>diagnostics_rp_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb175-26"><a href="inter-omics.html#cb175-26"></a>diagnostics_rn_pc_group &lt;-<span class="st"> </span><span class="kw">cloak</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb175-27"><a href="inter-omics.html#cb175-27"></a></span>
<span id="cb175-28"><a href="inter-omics.html#cb175-28"></a></span>
<span id="cb175-29"><a href="inter-omics.html#cb175-29"></a><span class="co">### Combine all test results into one file</span></span>
<span id="cb175-30"><a href="inter-omics.html#cb175-30"></a></span>
<span id="cb175-31"><a href="inter-omics.html#cb175-31"></a>diagnostics &lt;-<span class="st"> </span>diagnostics_hp_cleaned</span>
<span id="cb175-32"><a href="inter-omics.html#cb175-32"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">rbind</span>(diagnostics, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_pc_group, diagnostics_hn_pc_group, diagnostics_rp_pc_group, </span>
<span id="cb175-33"><a href="inter-omics.html#cb175-33"></a>    diagnostics_rn_pc_group, diagnostics_hp_ion, diagnostics_hn_ion, diagnostics_rp_ion, diagnostics_rn_ion)</span>
<span id="cb175-34"><a href="inter-omics.html#cb175-34"></a>diagnostics</span>
<span id="cb175-35"><a href="inter-omics.html#cb175-35"></a><span class="kw">write.csv</span>(diagnostics, <span class="st">&quot;mantel_stats_FUN.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="inter-omics.html#cb176-1"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/mantel_stats_FUN.csv&quot;</span>)</span>
<span id="cb176-2"><a href="inter-omics.html#cb176-2"></a>diagnostics<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb176-3"><a href="inter-omics.html#cb176-3"></a>diagnostics &lt;-<span class="st"> </span>diagnostics[, <span class="kw">c</span>(<span class="st">&quot;statistic&quot;</span>, <span class="st">&quot;signif&quot;</span>, <span class="st">&quot;micro_samples&quot;</span>, <span class="st">&quot;micro_OTUs&quot;</span>, <span class="st">&quot;meta_samples&quot;</span>, <span class="st">&quot;meta_features&quot;</span>, <span class="st">&quot;Sponge.species&quot;</span>, <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data.set&quot;</span>)]</span>
<span id="cb176-4"><a href="inter-omics.html#cb176-4"></a></span>
<span id="cb176-5"><a href="inter-omics.html#cb176-5"></a><span class="kw">options</span>(<span class="dt">kableExtra.html.bsTable =</span> T)</span>
<span id="cb176-6"><a href="inter-omics.html#cb176-6"></a><span class="kw">kable</span>(diagnostics, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Mantel statistic r&quot;</span>, <span class="st">&quot;significance&quot;</span>, <span class="st">&quot;N microbiome samples&quot;</span>, <span class="st">&quot;N OTUs&quot;</span>, <span class="st">&quot;N metabolome samples&quot;</span>, <span class="st">&quot;N features&quot;</span>, <span class="st">&quot;Sponge species&quot;</span>, </span>
<span id="cb176-7"><a href="inter-omics.html#cb176-7"></a>    <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data set&quot;</span>), <span class="dt">longtable =</span> T, <span class="dt">booktabs =</span> T, <span class="dt">caption =</span> <span class="st">&quot;Mantel test diagnostics diagnositcs comparing the microbiome and metabolome of the same sponge specimens&quot;</span>, </span>
<span id="cb176-8"><a href="inter-omics.html#cb176-8"></a>    <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="dt">Diagnostics =</span> <span class="dv">6</span>, <span class="st">`</span><span class="dt">Data set attribution</span><span class="st">`</span> =<span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;bordered&quot;</span>, </span>
<span id="cb176-9"><a href="inter-omics.html#cb176-9"></a>    <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">font_size =</span> <span class="dv">12</span>, <span class="dt">full_width =</span> F, <span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;scale_down&quot;</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="14%" />
<col width="10%" />
<col width="16%" />
<col width="5%" />
<col width="16%" />
<col width="8%" />
<col width="13%" />
<col width="8%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Mantel statistic r</th>
<th align="right">significance</th>
<th align="right">N microbiome samples</th>
<th align="right">N OTUs</th>
<th align="right">N metabolome samples</th>
<th align="right">N features</th>
<th align="left">Sponge species</th>
<th align="left">Experiment</th>
<th align="left">data set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6076416</td>
<td align="right">0.004</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">3507</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.3857788</td>
<td align="right">0.011</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">3507</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.4576405</td>
<td align="right">0.008</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">3507</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.4516469</td>
<td align="right">0.006</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">2808</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.1513297</td>
<td align="right">0.186</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">2808</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.1854966</td>
<td align="right">0.168</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">2808</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">-0.2014493</td>
<td align="right">0.833</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">4673</td>
<td align="left">Geodia barretti</td>
<td align="left">RP pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.3127632</td>
<td align="right">0.064</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">4673</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.3323657</td>
<td align="right">0.035</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">4673</td>
<td align="left">Weberella bursa</td>
<td align="left">RP pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">-0.2465894</td>
<td align="right">0.845</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">3166</td>
<td align="left">Geodia barretti</td>
<td align="left">RP neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.1960950</td>
<td align="right">0.173</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">3166</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.1721750</td>
<td align="right">0.174</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">3166</td>
<td align="left">Weberella bursa</td>
<td align="left">RP neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.5836627</td>
<td align="right">0.009</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">2212</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.4082626</td>
<td align="right">0.016</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">2212</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.4483931</td>
<td align="right">0.012</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">2212</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.3951252</td>
<td align="right">0.018</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">1351</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.3211093</td>
<td align="right">0.040</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">1351</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.0315675</td>
<td align="right">0.414</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">1351</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">-0.1600791</td>
<td align="right">0.774</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">2736</td>
<td align="left">Geodia barretti</td>
<td align="left">RP pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.3181249</td>
<td align="right">0.064</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">2736</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.3008501</td>
<td align="right">0.067</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">2736</td>
<td align="left">Weberella bursa</td>
<td align="left">RP pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">-0.1879022</td>
<td align="right">0.790</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">1678</td>
<td align="left">Geodia barretti</td>
<td align="left">RP neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.2034548</td>
<td align="right">0.156</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">1678</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.1507257</td>
<td align="right">0.198</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">1678</td>
<td align="left">Weberella bursa</td>
<td align="left">RP neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.3351779</td>
<td align="right">0.050</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">105</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.2908357</td>
<td align="right">0.086</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">105</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC pos</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.4683599</td>
<td align="right">0.010</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">105</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.4429513</td>
<td align="right">0.005</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">123</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC neg</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.0727247</td>
<td align="right">0.320</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">123</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC neg</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.2320236</td>
<td align="right">0.115</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">123</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC neg</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">-0.2569170</td>
<td align="right">0.908</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">171</td>
<td align="left">Geodia barretti</td>
<td align="left">RP pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.3070980</td>
<td align="right">0.083</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">171</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP pos</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.2656853</td>
<td align="right">0.072</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">171</td>
<td align="left">Weberella bursa</td>
<td align="left">RP pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">-0.1220077</td>
<td align="right">0.703</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">105</td>
<td align="left">Geodia barretti</td>
<td align="left">RP neg</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">-0.0505950</td>
<td align="right">0.597</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">105</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP neg</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.1218225</td>
<td align="right">0.217</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">105</td>
<td align="left">Weberella bursa</td>
<td align="left">RP neg</td>
<td align="left">ion</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="inter-omics.html#cb177-1"></a>dig &lt;-<span class="st"> </span>diagnostics[diagnostics<span class="op">$</span>signif <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, ]</span>
<span id="cb177-2"><a href="inter-omics.html#cb177-2"></a>a &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dig, <span class="dt">by =</span> <span class="kw">list</span>(dig<span class="op">$</span>Sponge.species, dig<span class="op">$</span>Experiment, dig<span class="op">$</span>data.set), <span class="dt">FUN =</span> <span class="st">&quot;length&quot;</span>)</span>
<span id="cb177-3"><a href="inter-omics.html#cb177-3"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Geodia barretti Stryphnus fortis  Weberella bursa 
##                6                3                4</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="inter-omics.html#cb179-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## HILIC neg HILIC pos    RP neg    RP pos 
##         4         8         0         1</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="inter-omics.html#cb181-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  cleaned      ion pc_group 
##        5        3        5</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="inter-omics.html#cb183-1"></a><span class="kw">rm</span>(diagnostics_hp_cleaned, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_ion, diagnostics_hn_ion, diagnostics_rp_ion, </span>
<span id="cb183-2"><a href="inter-omics.html#cb183-2"></a>    diagnostics_rn_ion, diagnostics_hp_pc_group, diagnostics_hn_pc_group, diagnostics_rp_pc_group, diagnostics_rn_pc_group)</span>
<span id="cb183-3"><a href="inter-omics.html#cb183-3"></a><span class="kw">rm</span>(hilic_pos, hilic_neg, rp_pos, rp_neg)</span></code></pre></div>
<p>As we can see from the table, in 13 cases, the Mantel test returns a significant correlation between the two matrices. Above you can see the the significant tests broken down by sponge species, HPCL-experiment and filtering approach.</p>
</div>
<div id="procrustes-rotation-and-protest-code-and-tabular-output" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Procrustes rotation and protest code and tabular output</h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="inter-omics.html#cb184-1"></a><span class="co">### =============================== PROTEST ====================================</span></span>
<span id="cb184-2"><a href="inter-omics.html#cb184-2"></a></span>
<span id="cb184-3"><a href="inter-omics.html#cb184-3"></a><span class="co"># run one of this at a time</span></span>
<span id="cb184-4"><a href="inter-omics.html#cb184-4"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_pos, <span class="st">&quot;H_p&quot;</span>)</span>
<span id="cb184-5"><a href="inter-omics.html#cb184-5"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(hilic_neg, <span class="st">&quot;H_n&quot;</span>)</span>
<span id="cb184-6"><a href="inter-omics.html#cb184-6"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_pos, <span class="st">&quot;R_p&quot;</span>)</span>
<span id="cb184-7"><a href="inter-omics.html#cb184-7"></a>metabolomes &lt;-<span class="st"> </span><span class="kw">gymnastics</span>(rp_neg, <span class="st">&quot;R_n&quot;</span>)</span>
<span id="cb184-8"><a href="inter-omics.html#cb184-8"></a></span>
<span id="cb184-9"><a href="inter-omics.html#cb184-9"></a><span class="co"># run this</span></span>
<span id="cb184-10"><a href="inter-omics.html#cb184-10"></a>congruent_dfs &lt;-<span class="st"> </span><span class="kw">congruency</span>(metabolomes)</span>
<span id="cb184-11"><a href="inter-omics.html#cb184-11"></a></span>
<span id="cb184-12"><a href="inter-omics.html#cb184-12"></a><span class="co"># run one of these: PROTEST </span><span class="al">TEST</span></span>
<span id="cb184-13"><a href="inter-omics.html#cb184-13"></a>diagnostics_hp_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb184-14"><a href="inter-omics.html#cb184-14"></a>diagnostics_hn_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb184-15"><a href="inter-omics.html#cb184-15"></a>diagnostics_rp_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb184-16"><a href="inter-omics.html#cb184-16"></a>diagnostics_rn_cleaned &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;cleaned&quot;</span>)</span>
<span id="cb184-17"><a href="inter-omics.html#cb184-17"></a></span>
<span id="cb184-18"><a href="inter-omics.html#cb184-18"></a>diagnostics_hp_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb184-19"><a href="inter-omics.html#cb184-19"></a>diagnostics_hn_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb184-20"><a href="inter-omics.html#cb184-20"></a>diagnostics_rp_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb184-21"><a href="inter-omics.html#cb184-21"></a>diagnostics_rn_ion &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;ion&quot;</span>)</span>
<span id="cb184-22"><a href="inter-omics.html#cb184-22"></a></span>
<span id="cb184-23"><a href="inter-omics.html#cb184-23"></a>diagnostics_hp_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb184-24"><a href="inter-omics.html#cb184-24"></a>diagnostics_hn_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;HILIC neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb184-25"><a href="inter-omics.html#cb184-25"></a>diagnostics_rp_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP pos&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb184-26"><a href="inter-omics.html#cb184-26"></a>diagnostics_rn_pc_group &lt;-<span class="st"> </span><span class="kw">ordination</span>(<span class="dt">congruent_dfs =</span> congruent_dfs, <span class="dt">experiment =</span> <span class="st">&quot;RP neg&quot;</span>, <span class="dt">filtering =</span> <span class="st">&quot;pc_group&quot;</span>)</span>
<span id="cb184-27"><a href="inter-omics.html#cb184-27"></a></span>
<span id="cb184-28"><a href="inter-omics.html#cb184-28"></a></span>
<span id="cb184-29"><a href="inter-omics.html#cb184-29"></a><span class="co">### Combine all test results into one file</span></span>
<span id="cb184-30"><a href="inter-omics.html#cb184-30"></a></span>
<span id="cb184-31"><a href="inter-omics.html#cb184-31"></a>diagnostics &lt;-<span class="st"> </span>diagnostics_hp_cleaned</span>
<span id="cb184-32"><a href="inter-omics.html#cb184-32"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">rbind</span>(diagnostics, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_pc_group, diagnostics_hn_pc_group, diagnostics_rp_pc_group, </span>
<span id="cb184-33"><a href="inter-omics.html#cb184-33"></a>    diagnostics_rn_pc_group, diagnostics_hp_ion, diagnostics_hn_ion, diagnostics_rp_ion, diagnostics_rn_ion)</span>
<span id="cb184-34"><a href="inter-omics.html#cb184-34"></a>diagnostics</span>
<span id="cb184-35"><a href="inter-omics.html#cb184-35"></a></span>
<span id="cb184-36"><a href="inter-omics.html#cb184-36"></a><span class="kw">write.csv</span>(diagnostics, <span class="st">&quot;protest_stats_FUN.csv&quot;</span>)</span>
<span id="cb184-37"><a href="inter-omics.html#cb184-37"></a></span>
<span id="cb184-38"><a href="inter-omics.html#cb184-38"></a><span class="kw">rm</span>(diagnostics_hp_cleaned, diagnostics_hn_cleaned, diagnostics_rp_cleaned, diagnostics_rn_cleaned, diagnostics_hp_ion, diagnostics_hn_ion, diagnostics_rp_ion, </span>
<span id="cb184-39"><a href="inter-omics.html#cb184-39"></a>    diagnostics_rn_ion, diagnostics_hp_pc_group, diagnostics_hn_pc_group, diagnostics_rp_pc_group, diagnostics_rn_pc_group, diagnostics)</span>
<span id="cb184-40"><a href="inter-omics.html#cb184-40"></a><span class="kw">rm</span>(hilic_pos, hilic_neg, rp_pos, rp_neg)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="inter-omics.html#cb185-1"></a>diagnostics &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/protest_stats_FUN.csv&quot;</span>)</span>
<span id="cb185-2"><a href="inter-omics.html#cb185-2"></a>diagnostics<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb185-3"><a href="inter-omics.html#cb185-3"></a>diagnostics &lt;-<span class="st"> </span>diagnostics[, <span class="kw">c</span>(<span class="st">&quot;Procrustes.SS&quot;</span>, <span class="st">&quot;correlation.in.sym..rotation&quot;</span>, <span class="st">&quot;signif&quot;</span>, <span class="st">&quot;micro_samples&quot;</span>, <span class="st">&quot;micro_OTUs&quot;</span>, <span class="st">&quot;meta_samples&quot;</span>, <span class="st">&quot;meta_features&quot;</span>, <span class="st">&quot;Sponge.species&quot;</span>, </span>
<span id="cb185-4"><a href="inter-omics.html#cb185-4"></a>    <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data.set&quot;</span>)]</span>
<span id="cb185-5"><a href="inter-omics.html#cb185-5"></a></span>
<span id="cb185-6"><a href="inter-omics.html#cb185-6"></a><span class="kw">options</span>(<span class="dt">kableExtra.html.bsTable =</span> T)</span>
<span id="cb185-7"><a href="inter-omics.html#cb185-7"></a><span class="kw">kable</span>(diagnostics, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Procrustes sum of squares&quot;</span>, <span class="st">&quot;correlation in symmetric rotation&quot;</span>, <span class="st">&quot;significance&quot;</span>, <span class="st">&quot;N microbiome samples&quot;</span>, <span class="st">&quot;N OTUs&quot;</span>, <span class="st">&quot;N metabolome samples&quot;</span>, </span>
<span id="cb185-8"><a href="inter-omics.html#cb185-8"></a>    <span class="st">&quot;N features&quot;</span>, <span class="st">&quot;Sponge species&quot;</span>, <span class="st">&quot;Experiment&quot;</span>, <span class="st">&quot;data set&quot;</span>), <span class="dt">longtable =</span> T, <span class="dt">booktabs =</span> T, <span class="dt">caption =</span> <span class="st">&quot;Protest diagnostics comparing the microbiome and metabolome of the same sponge specimens&quot;</span>, </span>
<span id="cb185-9"><a href="inter-omics.html#cb185-9"></a>    <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="dt">Diagnostics =</span> <span class="dv">7</span>, <span class="st">`</span><span class="dt">Data set attribution</span><span class="st">`</span> =<span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;bordered&quot;</span>, </span>
<span id="cb185-10"><a href="inter-omics.html#cb185-10"></a>    <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">font_size =</span> <span class="dv">12</span>, <span class="dt">full_width =</span> F, <span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;scale_down&quot;</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="15%" />
<col width="20%" />
<col width="7%" />
<col width="12%" />
<col width="4%" />
<col width="12%" />
<col width="6%" />
<col width="10%" />
<col width="6%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Procrustes sum of squares</th>
<th align="right">correlation in symmetric rotation</th>
<th align="right">significance</th>
<th align="right">N microbiome samples</th>
<th align="right">N OTUs</th>
<th align="right">N metabolome samples</th>
<th align="right">N features</th>
<th align="left">Sponge species</th>
<th align="left">Experiment</th>
<th align="left">data set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4901473</td>
<td align="right">0.7140397</td>
<td align="right">0.009</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">3507</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.3360196</td>
<td align="right">0.8148499</td>
<td align="right">0.001</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">3507</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.6451196</td>
<td align="right">0.5957184</td>
<td align="right">0.009</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">3507</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.5056719</td>
<td align="right">0.7030847</td>
<td align="right">0.015</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">2808</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.7144829</td>
<td align="right">0.5343380</td>
<td align="right">0.043</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">2808</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.6454847</td>
<td align="right">0.5954119</td>
<td align="right">0.003</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">2808</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.7241690</td>
<td align="right">0.5251961</td>
<td align="right">0.124</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">4673</td>
<td align="left">Geodia barretti</td>
<td align="left">RP pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.5535784</td>
<td align="right">0.6681479</td>
<td align="right">0.005</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">4673</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.9089831</td>
<td align="right">0.3016901</td>
<td align="right">0.513</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">4673</td>
<td align="left">Weberella bursa</td>
<td align="left">RP pos</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.7744081</td>
<td align="right">0.4749652</td>
<td align="right">0.229</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">3166</td>
<td align="left">Geodia barretti</td>
<td align="left">RP neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.7769037</td>
<td align="right">0.4723307</td>
<td align="right">0.107</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">3166</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="even">
<td align="right">0.9426954</td>
<td align="right">0.2393838</td>
<td align="right">0.656</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">3166</td>
<td align="left">Weberella bursa</td>
<td align="left">RP neg</td>
<td align="left">cleaned</td>
</tr>
<tr class="odd">
<td align="right">0.4903060</td>
<td align="right">0.7139285</td>
<td align="right">0.008</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">2212</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.6122646</td>
<td align="right">0.6226840</td>
<td align="right">0.009</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">2212</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.5611609</td>
<td align="right">0.6624494</td>
<td align="right">0.002</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">2212</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.4442919</td>
<td align="right">0.7454583</td>
<td align="right">0.007</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">1351</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.6072203</td>
<td align="right">0.6267214</td>
<td align="right">0.013</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">1351</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.7647882</td>
<td align="right">0.4849864</td>
<td align="right">0.062</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">1351</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.7332277</td>
<td align="right">0.5165001</td>
<td align="right">0.146</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">2736</td>
<td align="left">Geodia barretti</td>
<td align="left">RP pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.5557670</td>
<td align="right">0.6665081</td>
<td align="right">0.002</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">2736</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.9184545</td>
<td align="right">0.2855616</td>
<td align="right">0.579</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">2736</td>
<td align="left">Weberella bursa</td>
<td align="left">RP pos</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.7952845</td>
<td align="right">0.4524550</td>
<td align="right">0.314</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">1678</td>
<td align="left">Geodia barretti</td>
<td align="left">RP neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.7513407</td>
<td align="right">0.4986575</td>
<td align="right">0.089</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">1678</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="even">
<td align="right">0.9669093</td>
<td align="right">0.1819085</td>
<td align="right">0.851</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">1678</td>
<td align="left">Weberella bursa</td>
<td align="left">RP neg</td>
<td align="left">pc_group</td>
</tr>
<tr class="odd">
<td align="right">0.7744285</td>
<td align="right">0.4749437</td>
<td align="right">0.254</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">3166</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.7768298</td>
<td align="right">0.4724090</td>
<td align="right">0.119</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">3166</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC pos</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.9427350</td>
<td align="right">0.2393010</td>
<td align="right">0.671</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">3166</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.3977778</td>
<td align="right">0.7760297</td>
<td align="right">0.005</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">123</td>
<td align="left">Geodia barretti</td>
<td align="left">HILIC neg</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.7620196</td>
<td align="right">0.4878323</td>
<td align="right">0.101</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">123</td>
<td align="left">Stryphnus fortis</td>
<td align="left">HILIC neg</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.6263664</td>
<td align="right">0.6112558</td>
<td align="right">0.007</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">123</td>
<td align="left">Weberella bursa</td>
<td align="left">HILIC neg</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.6879735</td>
<td align="right">0.5585933</td>
<td align="right">0.083</td>
<td align="right">10</td>
<td align="right">420</td>
<td align="right">10</td>
<td align="right">171</td>
<td align="left">Geodia barretti</td>
<td align="left">RP pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.6735153</td>
<td align="right">0.5713884</td>
<td align="right">0.038</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">171</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP pos</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.9830213</td>
<td align="right">0.1303022</td>
<td align="right">0.961</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">171</td>
<td align="left">Weberella bursa</td>
<td align="left">RP pos</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.7788793</td>
<td align="right">0.4702347</td>
<td align="right">0.271</td>
<td align="right">9</td>
<td align="right">420</td>
<td align="right">9</td>
<td align="right">105</td>
<td align="left">Geodia barretti</td>
<td align="left">RP neg</td>
<td align="left">ion</td>
</tr>
<tr class="odd">
<td align="right">0.9754054</td>
<td align="right">0.1568265</td>
<td align="right">0.767</td>
<td align="right">13</td>
<td align="right">461</td>
<td align="right">13</td>
<td align="right">105</td>
<td align="left">Stryphnus fortis</td>
<td align="left">RP neg</td>
<td align="left">ion</td>
</tr>
<tr class="even">
<td align="right">0.9595716</td>
<td align="right">0.2010681</td>
<td align="right">0.791</td>
<td align="right">15</td>
<td align="right">135</td>
<td align="right">15</td>
<td align="right">105</td>
<td align="left">Weberella bursa</td>
<td align="left">RP neg</td>
<td align="left">ion</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="inter-omics.html#cb186-1"></a>dig &lt;-<span class="st"> </span>diagnostics[diagnostics<span class="op">$</span>signif <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, ]</span>
<span id="cb186-2"><a href="inter-omics.html#cb186-2"></a>a &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dig, <span class="dt">by =</span> <span class="kw">list</span>(dig<span class="op">$</span>Sponge.species, dig<span class="op">$</span>Experiment, dig<span class="op">$</span>data.set), <span class="dt">FUN =</span> <span class="st">&quot;length&quot;</span>)</span>
<span id="cb186-3"><a href="inter-omics.html#cb186-3"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Geodia barretti Stryphnus fortis  Weberella bursa 
##                5                7                4</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="inter-omics.html#cb188-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## HILIC neg HILIC pos    RP neg    RP pos 
##         7         6         0         3</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="inter-omics.html#cb190-1"></a><span class="kw">summary</span>(a<span class="op">$</span>Group<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  cleaned      ion pc_group 
##        7        3        6</code></pre>
<p>Out of the 36 tests performed, 16 are significant (<em>p</em> <span class="math inline">\(\leq\)</span> 0.05). Immediately above you can see the the significant tests broken down by sponge species, HPCL-experiment and filtering approach.</p>
</div>
</div>
<div id="correlating-barettin-and-prokaryotic-relative-abundance" class="section level2">
<h2><span class="header-section-number">4.2</span> Correlating barettin and prokaryotic relative abundance</h2>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="inter-omics.html#cb192-1"></a>cmp &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/metabolite_master_20190605.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb192-2"><a href="inter-omics.html#cb192-2"></a>cmp<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb192-3"><a href="inter-omics.html#cb192-3"></a>meta_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Steffen_et_al_metadata_PANGAEA.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb192-4"><a href="inter-omics.html#cb192-4"></a>micro &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/OTU_all_R.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb192-5"><a href="inter-omics.html#cb192-5"></a></span>
<span id="cb192-6"><a href="inter-omics.html#cb192-6"></a><span class="co"># preparing meta data</span></span>
<span id="cb192-7"><a href="inter-omics.html#cb192-7"></a>meta_data_prep &lt;-<span class="st"> </span><span class="cf">function</span>(meta_data) {</span>
<span id="cb192-8"><a href="inter-omics.html#cb192-8"></a>    meta_data &lt;-<span class="st"> </span>meta_data[, <span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;Depth&quot;</span>, <span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;MeanBottomTemp_Cdeg&quot;</span>, <span class="st">&quot;MeanBotSalinity_PSU&quot;</span>, <span class="st">&quot;YEAR&quot;</span>)]</span>
<span id="cb192-9"><a href="inter-omics.html#cb192-9"></a>    <span class="kw">colnames</span>(meta_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;Depth&quot;</span>, <span class="st">&quot;Latitude&quot;</span>, <span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Temperature&quot;</span>, <span class="st">&quot;Salinity&quot;</span>, <span class="st">&quot;Year&quot;</span>)</span>
<span id="cb192-10"><a href="inter-omics.html#cb192-10"></a>    meta_data &lt;-<span class="st"> </span>meta_data[<span class="op">!</span>(<span class="kw">str_sub</span>(meta_data<span class="op">$</span>unified_ID, <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;QC&quot;</span>), ]</span>
<span id="cb192-11"><a href="inter-omics.html#cb192-11"></a>    meta_data[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(meta_data, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) </span>
<span id="cb192-12"><a href="inter-omics.html#cb192-12"></a>        <span class="kw">factor</span>(x) <span class="cf">else</span> x)</span>
<span id="cb192-13"><a href="inter-omics.html#cb192-13"></a>    <span class="co"># Gb12, Gb20 and Gb21 are missing temperature and salinity. Imputing data from closeby samples:</span></span>
<span id="cb192-14"><a href="inter-omics.html#cb192-14"></a>    meta_data<span class="op">$</span>Salinity[meta_data<span class="op">$</span>unified_ID <span class="op">==</span><span class="st"> &quot;Gb12&quot;</span>] &lt;-<span class="st"> </span><span class="fl">34.92</span></span>
<span id="cb192-15"><a href="inter-omics.html#cb192-15"></a>    meta_data<span class="op">$</span>Salinity[meta_data<span class="op">$</span>unified_ID <span class="op">==</span><span class="st"> &quot;Gb20&quot;</span>] &lt;-<span class="st"> </span><span class="fl">34.92</span></span>
<span id="cb192-16"><a href="inter-omics.html#cb192-16"></a>    meta_data<span class="op">$</span>Salinity[meta_data<span class="op">$</span>unified_ID <span class="op">==</span><span class="st"> &quot;Gb21&quot;</span>] &lt;-<span class="st"> </span><span class="fl">34.56</span></span>
<span id="cb192-17"><a href="inter-omics.html#cb192-17"></a>    meta_data<span class="op">$</span>Temperature[meta_data<span class="op">$</span>unified_ID <span class="op">==</span><span class="st"> &quot;Gb12&quot;</span>] &lt;-<span class="st"> </span><span class="fl">3.71</span></span>
<span id="cb192-18"><a href="inter-omics.html#cb192-18"></a>    meta_data<span class="op">$</span>Temperature[meta_data<span class="op">$</span>unified_ID <span class="op">==</span><span class="st"> &quot;Gb20&quot;</span>] &lt;-<span class="st"> </span><span class="fl">3.65</span></span>
<span id="cb192-19"><a href="inter-omics.html#cb192-19"></a>    meta_data<span class="op">$</span>Temperature[meta_data<span class="op">$</span>unified_ID <span class="op">==</span><span class="st"> &quot;Gb21&quot;</span>] &lt;-<span class="st"> </span><span class="fl">2.32</span></span>
<span id="cb192-20"><a href="inter-omics.html#cb192-20"></a>    meta_data[<span class="st">&quot;spec&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_sub</span>(meta_data<span class="op">$</span>unified_ID, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb192-21"><a href="inter-omics.html#cb192-21"></a>    meta_data &lt;-<span class="st"> </span>meta_data[<span class="kw">order</span>(meta_data<span class="op">$</span>unified_ID), ]</span>
<span id="cb192-22"><a href="inter-omics.html#cb192-22"></a>    <span class="kw">return</span>(meta_data)</span>
<span id="cb192-23"><a href="inter-omics.html#cb192-23"></a>}</span>
<span id="cb192-24"><a href="inter-omics.html#cb192-24"></a></span>
<span id="cb192-25"><a href="inter-omics.html#cb192-25"></a>meta_data &lt;-<span class="st"> </span><span class="kw">meta_data_prep</span>(meta_data)</span>
<span id="cb192-26"><a href="inter-omics.html#cb192-26"></a></span>
<span id="cb192-27"><a href="inter-omics.html#cb192-27"></a><span class="co"># separating OTU tables by sponge</span></span>
<span id="cb192-28"><a href="inter-omics.html#cb192-28"></a>OTU_prep_sqrt &lt;-<span class="st"> </span><span class="cf">function</span>(micro) {</span>
<span id="cb192-29"><a href="inter-omics.html#cb192-29"></a>    <span class="kw">rownames</span>(micro) &lt;-<span class="st"> </span>micro<span class="op">$</span>Sample_ID</span>
<span id="cb192-30"><a href="inter-omics.html#cb192-30"></a>    micro<span class="op">$</span>Sample_ID &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb192-31"><a href="inter-omics.html#cb192-31"></a>    <span class="co"># micro &lt;- sqrt(micro) #sqrt could be toggled on/off here</span></span>
<span id="cb192-32"><a href="inter-omics.html#cb192-32"></a>    </span>
<span id="cb192-33"><a href="inter-omics.html#cb192-33"></a>    micro_gb &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Gb&quot;</span>), ]</span>
<span id="cb192-34"><a href="inter-omics.html#cb192-34"></a>    micro_sf &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Sf&quot;</span>), ]</span>
<span id="cb192-35"><a href="inter-omics.html#cb192-35"></a>    micro_wb &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Wb&quot;</span>), ]</span>
<span id="cb192-36"><a href="inter-omics.html#cb192-36"></a>    </span>
<span id="cb192-37"><a href="inter-omics.html#cb192-37"></a>    micro_gb &lt;-<span class="st"> </span>micro_gb[, <span class="kw">colSums</span>(micro_gb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb192-38"><a href="inter-omics.html#cb192-38"></a>    micro_sf &lt;-<span class="st"> </span>micro_sf[, <span class="kw">colSums</span>(micro_sf <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb192-39"><a href="inter-omics.html#cb192-39"></a>    micro_wb &lt;-<span class="st"> </span>micro_wb[, <span class="kw">colSums</span>(micro_wb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb192-40"><a href="inter-omics.html#cb192-40"></a>    micros &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">gb =</span> micro_gb, <span class="dt">sf =</span> micro_sf, <span class="dt">wb =</span> micro_wb)</span>
<span id="cb192-41"><a href="inter-omics.html#cb192-41"></a>    <span class="kw">return</span>(micros)</span>
<span id="cb192-42"><a href="inter-omics.html#cb192-42"></a>}</span>
<span id="cb192-43"><a href="inter-omics.html#cb192-43"></a></span>
<span id="cb192-44"><a href="inter-omics.html#cb192-44"></a>micro_ds &lt;-<span class="st"> </span><span class="kw">OTU_prep_sqrt</span>(micro)</span>
<span id="cb192-45"><a href="inter-omics.html#cb192-45"></a></span>
<span id="cb192-46"><a href="inter-omics.html#cb192-46"></a><span class="co"># calculating overall relative abundance of each OTU per sample</span></span>
<span id="cb192-47"><a href="inter-omics.html#cb192-47"></a>overall_rabdc &lt;-<span class="st"> </span><span class="cf">function</span>(micros) {</span>
<span id="cb192-48"><a href="inter-omics.html#cb192-48"></a>    mic &lt;-<span class="st"> </span>micros</span>
<span id="cb192-49"><a href="inter-omics.html#cb192-49"></a>    n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb192-50"><a href="inter-omics.html#cb192-50"></a>    k &lt;-<span class="st"> </span><span class="kw">dim</span>(mic)[<span class="dv">1</span>]</span>
<span id="cb192-51"><a href="inter-omics.html#cb192-51"></a>    mic[<span class="st">&quot;rowsum&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(mic, <span class="dv">1</span>, sum)</span>
<span id="cb192-52"><a href="inter-omics.html#cb192-52"></a>    </span>
<span id="cb192-53"><a href="inter-omics.html#cb192-53"></a>    <span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span>k) {</span>
<span id="cb192-54"><a href="inter-omics.html#cb192-54"></a>        n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb192-55"><a href="inter-omics.html#cb192-55"></a>        mic[n, ] &lt;-<span class="st"> </span>mic[n, ]<span class="op">/</span>(mic<span class="op">$</span>rowsum[n])</span>
<span id="cb192-56"><a href="inter-omics.html#cb192-56"></a>    }</span>
<span id="cb192-57"><a href="inter-omics.html#cb192-57"></a>    </span>
<span id="cb192-58"><a href="inter-omics.html#cb192-58"></a>    mic<span class="op">$</span>rowsum &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb192-59"><a href="inter-omics.html#cb192-59"></a>    mic &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(mic))</span>
<span id="cb192-60"><a href="inter-omics.html#cb192-60"></a>    <span class="co"># mic[&#39;avg_rel_abdc&#39;] &lt;- apply(mic, 1, mean) mic[&#39;occurrence&#39;] &lt;- ifelse(mic$avg&gt;0.0025, &#39;common&#39;, &#39;rare&#39;)</span></span>
<span id="cb192-61"><a href="inter-omics.html#cb192-61"></a>    <span class="kw">return</span>(mic)</span>
<span id="cb192-62"><a href="inter-omics.html#cb192-62"></a>}</span>
<span id="cb192-63"><a href="inter-omics.html#cb192-63"></a></span>
<span id="cb192-64"><a href="inter-omics.html#cb192-64"></a>rabdc &lt;-<span class="st"> </span><span class="kw">lapply</span>(micro_ds, overall_rabdc)</span>
<span id="cb192-65"><a href="inter-omics.html#cb192-65"></a></span>
<span id="cb192-66"><a href="inter-omics.html#cb192-66"></a><span class="co"># preparing congruent data sets</span></span>
<span id="cb192-67"><a href="inter-omics.html#cb192-67"></a>common_samples &lt;-<span class="st"> </span><span class="kw">intersect</span>(<span class="kw">colnames</span>(rabdc<span class="op">$</span>gb), cmp<span class="op">$</span>unified_ID)</span>
<span id="cb192-68"><a href="inter-omics.html#cb192-68"></a>rabdc &lt;-<span class="st"> </span>rabdc<span class="op">$</span>gb[, <span class="kw">colnames</span>(rabdc<span class="op">$</span>gb) <span class="op">%in%</span><span class="st"> </span>common_samples]</span>
<span id="cb192-69"><a href="inter-omics.html#cb192-69"></a>rabdc &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(rabdc))</span>
<span id="cb192-70"><a href="inter-omics.html#cb192-70"></a></span>
<span id="cb192-71"><a href="inter-omics.html#cb192-71"></a>cmp &lt;-<span class="st"> </span>cmp[cmp<span class="op">$</span>unified_ID <span class="op">%in%</span><span class="st"> </span>common_samples, ]</span>
<span id="cb192-72"><a href="inter-omics.html#cb192-72"></a>cmp[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(cmp, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) <span class="kw">factor</span>(x) <span class="cf">else</span> x)</span>
<span id="cb192-73"><a href="inter-omics.html#cb192-73"></a>cmp &lt;-<span class="st"> </span>cmp[<span class="kw">order</span>((cmp<span class="op">$</span>unified_ID)), ]</span>
<span id="cb192-74"><a href="inter-omics.html#cb192-74"></a></span>
<span id="cb192-75"><a href="inter-omics.html#cb192-75"></a><span class="co"># all(rownames(rabdc)==cmp$unified_ID)</span></span>
<span id="cb192-76"><a href="inter-omics.html#cb192-76"></a></span>
<span id="cb192-77"><a href="inter-omics.html#cb192-77"></a><span class="co"># CORRELATION for Gb and Sf</span></span>
<span id="cb192-78"><a href="inter-omics.html#cb192-78"></a></span>
<span id="cb192-79"><a href="inter-omics.html#cb192-79"></a>bar_cor &lt;-<span class="st"> </span><span class="cf">function</span>(rabdc_df, cmp) {</span>
<span id="cb192-80"><a href="inter-omics.html#cb192-80"></a>    barettin &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">colnames</span>(rabdc_df))</span>
<span id="cb192-81"><a href="inter-omics.html#cb192-81"></a>    <span class="kw">colnames</span>(barettin) &lt;-<span class="st"> &quot;XOTU&quot;</span></span>
<span id="cb192-82"><a href="inter-omics.html#cb192-82"></a>    barettin[<span class="st">&quot;barettin_estimate_P&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb192-83"><a href="inter-omics.html#cb192-83"></a>    barettin[<span class="st">&quot;barettin_p_val_P&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb192-84"><a href="inter-omics.html#cb192-84"></a>    barettin[<span class="st">&quot;barettin_estimate_S&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb192-85"><a href="inter-omics.html#cb192-85"></a>    barettin[<span class="st">&quot;barettin_p_val_S&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb192-86"><a href="inter-omics.html#cb192-86"></a>    </span>
<span id="cb192-87"><a href="inter-omics.html#cb192-87"></a>    n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb192-88"><a href="inter-omics.html#cb192-88"></a>    k &lt;-<span class="st"> </span><span class="kw">dim</span>(barettin)[<span class="dv">1</span>]</span>
<span id="cb192-89"><a href="inter-omics.html#cb192-89"></a>    <span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span>k) {</span>
<span id="cb192-90"><a href="inter-omics.html#cb192-90"></a>        n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb192-91"><a href="inter-omics.html#cb192-91"></a>        barettin<span class="op">$</span>barettin_estimate_P[n] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(<span class="kw">as.numeric</span>(rabdc_df[, n]), cmp<span class="op">$</span>bar, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>estimate</span>
<span id="cb192-92"><a href="inter-omics.html#cb192-92"></a>        barettin<span class="op">$</span>barettin_p_val_P[n] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(<span class="kw">as.numeric</span>(rabdc_df[, n]), cmp<span class="op">$</span>bar, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>p.value</span>
<span id="cb192-93"><a href="inter-omics.html#cb192-93"></a>        barettin<span class="op">$</span>barettin_estimate_S[n] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(<span class="kw">as.numeric</span>(rabdc_df[, n]), cmp<span class="op">$</span>bar, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>estimate</span>
<span id="cb192-94"><a href="inter-omics.html#cb192-94"></a>        barettin<span class="op">$</span>barettin_p_val_S[n] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(<span class="kw">as.numeric</span>(rabdc_df[, n]), cmp<span class="op">$</span>bar, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value</span>
<span id="cb192-95"><a href="inter-omics.html#cb192-95"></a>    }</span>
<span id="cb192-96"><a href="inter-omics.html#cb192-96"></a>    </span>
<span id="cb192-97"><a href="inter-omics.html#cb192-97"></a>    barettin[<span class="st">&quot;barettin_fdr_P&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb192-98"><a href="inter-omics.html#cb192-98"></a>    barettin[<span class="st">&quot;barettin_fdr_S&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb192-99"><a href="inter-omics.html#cb192-99"></a>    barettin<span class="op">$</span>barettin_fdr_P &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(barettin<span class="op">$</span>barettin_p_val_P, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb192-100"><a href="inter-omics.html#cb192-100"></a>    barettin<span class="op">$</span>barettin_fdr_S &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(barettin<span class="op">$</span>barettin_p_val_S, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb192-101"><a href="inter-omics.html#cb192-101"></a>    <span class="kw">return</span>(barettin)</span>
<span id="cb192-102"><a href="inter-omics.html#cb192-102"></a>}</span>
<span id="cb192-103"><a href="inter-omics.html#cb192-103"></a></span>
<span id="cb192-104"><a href="inter-omics.html#cb192-104"></a>barettin_cor &lt;-<span class="st"> </span><span class="kw">bar_cor</span>(rabdc, cmp)</span>
<span id="cb192-105"><a href="inter-omics.html#cb192-105"></a></span>
<span id="cb192-106"><a href="inter-omics.html#cb192-106"></a><span class="co"># write.csv(barettin_cor, &#39;data/GB_OTU_barettin_correlation.csv&#39;, row.names = F)</span></span>
<span id="cb192-107"><a href="inter-omics.html#cb192-107"></a></span>
<span id="cb192-108"><a href="inter-omics.html#cb192-108"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb192-109"><a href="inter-omics.html#cb192-109"></a><span class="kw">hist</span>(barettin_cor<span class="op">$</span>barettin_estimate_P, <span class="dt">main =</span> <span class="st">&quot;Pearson&#39;s pmcc: </span><span class="ch">\n</span><span class="st"> OTU rel abdc ~ barettin signal&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Product moment </span><span class="ch">\n</span><span class="st"> correlation coefficient&quot;</span>)</span>
<span id="cb192-110"><a href="inter-omics.html#cb192-110"></a><span class="kw">hist</span>(barettin_cor<span class="op">$</span>barettin_p_val_P, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Pearson&#39;s pmcc p-value&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;p-value&quot;</span>)</span>
<span id="cb192-111"><a href="inter-omics.html#cb192-111"></a><span class="kw">hist</span>(barettin_cor<span class="op">$</span>barettin_fdr_P, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Pearson&#39;s pmcc </span><span class="ch">\n</span><span class="st"> fdr corrected p-value&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;FDR corrected p-value&quot;</span>)</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/barettin-correlation-1.png" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="inter-omics.html#cb193-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb193-2"><a href="inter-omics.html#cb193-2"></a></span>
<span id="cb193-3"><a href="inter-omics.html#cb193-3"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb193-4"><a href="inter-omics.html#cb193-4"></a><span class="kw">hist</span>(barettin_cor<span class="op">$</span>barettin_estimate_S, <span class="dt">main =</span> <span class="st">&quot;Spearman&#39;s rho: </span><span class="ch">\n</span><span class="st"> OTU rel abdc ~ barettin signal&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Rho&quot;</span>)</span>
<span id="cb193-5"><a href="inter-omics.html#cb193-5"></a><span class="kw">hist</span>(barettin_cor<span class="op">$</span>barettin_p_val_S, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Spearman&#39;s rho p-value&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;p-value&quot;</span>)</span>
<span id="cb193-6"><a href="inter-omics.html#cb193-6"></a><span class="kw">hist</span>(barettin_cor<span class="op">$</span>barettin_fdr_S, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Spearman&#39;s rho </span><span class="ch">\n</span><span class="st"> fdr corrected p-value&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;FDR corrected p-value&quot;</span>)</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/barettin-correlation-2.png" width="672" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="inter-omics.html#cb194-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb194-2"><a href="inter-omics.html#cb194-2"></a></span>
<span id="cb194-3"><a href="inter-omics.html#cb194-3"></a><span class="co"># For Sf, for shortlist</span></span>
<span id="cb194-4"><a href="inter-omics.html#cb194-4"></a>cmp &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/metabolite_master_20190605.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb194-5"><a href="inter-omics.html#cb194-5"></a>cmp<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb194-6"><a href="inter-omics.html#cb194-6"></a>rabdc &lt;-<span class="st"> </span><span class="kw">lapply</span>(micro_ds, overall_rabdc)</span>
<span id="cb194-7"><a href="inter-omics.html#cb194-7"></a>common_samples &lt;-<span class="st"> </span><span class="kw">intersect</span>(<span class="kw">colnames</span>(rabdc<span class="op">$</span>sf), cmp<span class="op">$</span>unified_ID)</span>
<span id="cb194-8"><a href="inter-omics.html#cb194-8"></a>rabdc &lt;-<span class="st"> </span>rabdc<span class="op">$</span>sf[, <span class="kw">colnames</span>(rabdc<span class="op">$</span>sf) <span class="op">%in%</span><span class="st"> </span>common_samples]</span>
<span id="cb194-9"><a href="inter-omics.html#cb194-9"></a>rabdc &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(rabdc))</span>
<span id="cb194-10"><a href="inter-omics.html#cb194-10"></a></span>
<span id="cb194-11"><a href="inter-omics.html#cb194-11"></a>cmp &lt;-<span class="st"> </span>cmp[cmp<span class="op">$</span>unified_ID <span class="op">%in%</span><span class="st"> </span>common_samples, ]</span>
<span id="cb194-12"><a href="inter-omics.html#cb194-12"></a>cmp[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(cmp, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) <span class="kw">factor</span>(x) <span class="cf">else</span> x)</span>
<span id="cb194-13"><a href="inter-omics.html#cb194-13"></a>cmp &lt;-<span class="st"> </span>cmp[<span class="kw">order</span>((cmp<span class="op">$</span>unified_ID)), ]</span>
<span id="cb194-14"><a href="inter-omics.html#cb194-14"></a><span class="kw">all</span>(<span class="kw">rownames</span>(rabdc) <span class="op">==</span><span class="st"> </span>cmp<span class="op">$</span>unified_ID)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="inter-omics.html#cb196-1"></a>barettin_cor &lt;-<span class="st"> </span><span class="kw">bar_cor</span>(rabdc, cmp)</span>
<span id="cb196-2"><a href="inter-omics.html#cb196-2"></a><span class="co"># write.csv(barettin_cor, &#39;data/SF_OTU_barettin_correlation.csv&#39;, row.names = F)</span></span></code></pre></div>
</div>
<div id="microbial-interaction-network" class="section level2">
<h2><span class="header-section-number">4.3</span> Microbial interaction network</h2>
<div id="generating-network-based-on-different-algorithms" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Generating network based on different algorithms</h3>
<p>The overall goal of the subsequent seqctions of code is to produce a microbial interation network for <em>Geodia barretti</em>. Nodes will be OTUs/ASVs from <em>Geodia barretti</em> samples and edges represent an interaction between those OTUs/ASVs. In this first part, we will employ different algorithms for network building. Network building algorithms are mannifold and their results not uncontroversial, thus the recommended strategy is to use different methods and merge the resulting networks to one consensus representation (Weiss <em>et al</em>., 2016), which we will do in the second part.</p>
<p>The original data set from 14 specimens of <em>Geodia barretti</em> contained 420 OTUs/ASVs. To reduce sparsity, we removed OTUs/ASVs with two or less non-zero values resulting in a data set containing 289 OTUs/ASVs. This data set was used for network inference with the following methods:</p>
<ol style="list-style-type: decimal">
<li>MENA Pipeline</li>
<li>fastLSA</li>
<li>SparCC</li>
<li>Maximal information coefficient MIC</li>
</ol>
<div id="molecular-ecological-network-analysis-mena-pipeline" class="section level4">
<h4><span class="header-section-number">4.3.1.1</span> Molecular Ecological Network Analysis (MENA) Pipeline</h4>
<p>The implementation of MENA (Deng <em>et al</em>., 2012; Zhou, Deng <em>et al</em>., 2010; Zhou, Deng <em>et al</em>.,2011) can be accessed at <a href="http://ieg4.rccc.ou.edu/mena" class="uri">http://ieg4.rccc.ou.edu/mena</a>. The data set was saved as tab separated values and all zeros were converted to blanks.
No further filtering for non-zero values was done (more than two non-zero values). For data preparation, default settings were applied, i.e.missing data was only filled with 0.01 in blanks with paired valid values, logarithm was taken, Pearson correlation coefficient was selected. Likewise, Random matrix theory settings were kept at defaults, decreasing the cutoff from the top using Regress Poisson distribution only. The cutoff of 0.800 was chosen for the similarity matrix to construct the network, corresponding to a Chi-square test on Poisson distribution of 99.191 and a p-value of 0.001. This resulted in a network with 241 nodes and 3582 edges.</p>
<p>A second analysis was produced with the same settings except building the similarity matrix based on Spearmans Rho. The cutoff of 0.820 was chosen for the similarity matrix to construct the network, corresponding to a Chi-square test on Poisson distribution of 98.417 and a p-value of 0.001. This resulted in a network with 252 nodes and 2216 edges.</p>
<p>Network properties and parameters are summarized in MENA_network_parameters_Feb2019.xlsx.</p>
</div>
<div id="local-similarity-analysis-fastlsa" class="section level4">
<h4><span class="header-section-number">4.3.1.2</span> Local Similarity Analysis: fastLSA</h4>
<p>The command line program for calcularing local similarity (Durno <em>et al</em>., 2013) was downloaded from <a href="http://hallam.microbiology.ubc.ca/fastLSA/install/index.html" class="uri">http://hallam.microbiology.ubc.ca/fastLSA/install/index.html</a> and run specifying the input file, no time lag (-d 0) and significance level alpha (-a 0.05). All other paramters were kept at their default values. The input data set was a tab delimited text file stripped of OTU labels or sample IDs.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb197-1"><a href="inter-omics.html#cb197-1"></a>$ <span class="ex">./fastLSA</span> -i ../gb_289_feb2019.txt -d 0 -a 0.05 -o ../gb_289_feb2019.out</span></code></pre></div>
<p>The output file, as specified on the website, containes five columns. index1 and index2 represent the significant paired indices ranging from 0 to n-1 (OTUs/ASVs). LSA denotes the LSA statistic of each pair, lag was set to 0 with the -d flag and the p-valueBound column provides the p-values upper boundary for the significantly paired p-value.</p>
<p>To produce comparable data sets, we replaced the indices with their OTU IDs and removed superfluous columns.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="inter-omics.html#cb198-1"></a>fastLSA &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289_feb2019.out&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb198-2"><a href="inter-omics.html#cb198-2"></a>key &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/fastLSA_index_otu_CORRECTEDfeb2019.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb198-3"><a href="inter-omics.html#cb198-3"></a></span>
<span id="cb198-4"><a href="inter-omics.html#cb198-4"></a>fastLSA<span class="op">$</span>index1_otu &lt;-<span class="st"> </span>key<span class="op">$</span>fastLSA_OTU[<span class="kw">match</span>(fastLSA<span class="op">$</span>index1, key<span class="op">$</span>fastLSA_index)]</span>
<span id="cb198-5"><a href="inter-omics.html#cb198-5"></a>fastLSA<span class="op">$</span>index2_otu &lt;-<span class="st"> </span>key<span class="op">$</span>fastLSA_OTU[<span class="kw">match</span>(fastLSA<span class="op">$</span>index2, key<span class="op">$</span>fastLSA_index)]</span>
<span id="cb198-6"><a href="inter-omics.html#cb198-6"></a></span>
<span id="cb198-7"><a href="inter-omics.html#cb198-7"></a>fastLSA<span class="op">$</span>index1 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb198-8"><a href="inter-omics.html#cb198-8"></a>fastLSA<span class="op">$</span>index2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb198-9"><a href="inter-omics.html#cb198-9"></a>fastLSA<span class="op">$</span>lag &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb198-10"><a href="inter-omics.html#cb198-10"></a>fastLSA<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb198-11"><a href="inter-omics.html#cb198-11"></a>fastLSA &lt;-<span class="st"> </span>fastLSA[, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb198-12"><a href="inter-omics.html#cb198-12"></a>fastLSA &lt;-<span class="st"> </span>fastLSA[<span class="kw">order</span>(fastLSA<span class="op">$</span>p.valueBound), ]</span>
<span id="cb198-13"><a href="inter-omics.html#cb198-13"></a></span>
<span id="cb198-14"><a href="inter-omics.html#cb198-14"></a><span class="co"># write.csv(fastLSA, &#39;fastLSA_for_networks.csv&#39;)</span></span>
<span id="cb198-15"><a href="inter-omics.html#cb198-15"></a><span class="kw">rm</span>(key)</span></code></pre></div>
<p>LSA scores range from -1 for strong negatively correlations to 1, for strong positive correlations. There were no negative correlations in this data setand we refrained from scaleding the LSA score furhter.
The resulting network contrained 129 nodes and 207 edges.</p>
</div>
<div id="sparcc" class="section level4">
<h4><span class="header-section-number">4.3.1.3</span> SparCC</h4>
<p>SparCC (Friedman and Alm, 2012) is a network building algorithm for compositional data and can be found at <a href="https://bitbucket.org/yonatanf/sparcc" class="uri">https://bitbucket.org/yonatanf/sparcc</a>.</p>
<p>Prior to running it I had to get help as there was a minor issue during compilation. SparCC needed specific versions of numpy, panda and python to run properly, which is easiest accomodated in a specific environment. The OTU table needs to be windows formatted text. The embedded code is an example, for the analysis, 500 iterations were combined.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb199-1"><a href="inter-omics.html#cb199-1"></a>$ <span class="bu">cd</span> to working directory with SparCC and the data set gb_289.csv</span>
<span id="cb199-2"><a href="inter-omics.html#cb199-2"></a>$ <span class="bu">source</span> activate sparcc</span>
<span id="cb199-3"><a href="inter-omics.html#cb199-3"></a><span class="ex">python</span> SparCC.py ../gb_sparcc.txt -c ../gb_sparcc_cor_file.txt -v </span>
<span id="cb199-4"><a href="inter-omics.html#cb199-4"></a><span class="ex">../gb_sparcc_coverage_file.txt</span> -i 5</span>
<span id="cb199-5"><a href="inter-omics.html#cb199-5"></a>$ <span class="ex">deactivate</span></span></code></pre></div>
<p>Create a results directory and redirect all the output there. Pseudo p-value Calculation, generates -n shuffled data sets:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb200-1"><a href="inter-omics.html#cb200-1"></a>$ <span class="fu">mkdir</span> results <span class="co">#creates output directory</span></span>
<span id="cb200-2"><a href="inter-omics.html#cb200-2"></a>$ <span class="ex">python</span> MakeBootstraps.py ../gb_sparcc.txt -n 5 -t permutation_#.txt -p ../results/ </span></code></pre></div>
<p>And run SparCC.py on all the re-shuffled data sets:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb201-1"><a href="inter-omics.html#cb201-1"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_0.txt -i 5 --cor_file=../results/perm_cor_0.txt</span>
<span id="cb201-2"><a href="inter-omics.html#cb201-2"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_1.txt -i 5 --cor_file=../results/perm_cor_1.txt</span>
<span id="cb201-3"><a href="inter-omics.html#cb201-3"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_2.txt -i 5 --cor_file=../results/perm_cor_2.txt</span>
<span id="cb201-4"><a href="inter-omics.html#cb201-4"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_3.txt -i 5 --cor_file=../results/perm_cor_3.txt</span>
<span id="cb201-5"><a href="inter-omics.html#cb201-5"></a>$ <span class="ex">python</span> SparCC.py ../results/permutation_4.txt -i 5 --cor_file=../results/perm_cor_4.txt</span></code></pre></div>
<p>Generate p-values:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb202-1"><a href="inter-omics.html#cb202-1"></a>$ <span class="ex">python</span> PseudoPvals.py ../results/gb_sparcc_cor_file.txt ../results/perm_cor_#.txt 5 </span>
<span id="cb202-2"><a href="inter-omics.html#cb202-2"></a><span class="ex">-o</span> ../results/pvals.two_sided.txt -t two_sided</span></code></pre></div>
<p>Formatting the resulting data set like so:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="inter-omics.html#cb203-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb203-2"><a href="inter-omics.html#cb203-2"></a>cor_file &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_sparcc_cor_file_289.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb203-3"><a href="inter-omics.html#cb203-3"></a>p_vals &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289_pvals.two_sided.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb203-4"><a href="inter-omics.html#cb203-4"></a></span>
<span id="cb203-5"><a href="inter-omics.html#cb203-5"></a><span class="co"># make OTU ID the rowname</span></span>
<span id="cb203-6"><a href="inter-omics.html#cb203-6"></a><span class="kw">rownames</span>(cor_file) &lt;-<span class="st"> </span>cor_file[, <span class="dv">1</span>]</span>
<span id="cb203-7"><a href="inter-omics.html#cb203-7"></a>cor_file[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb203-8"><a href="inter-omics.html#cb203-8"></a><span class="kw">rownames</span>(p_vals) &lt;-<span class="st"> </span>p_vals[, <span class="dv">1</span>]</span>
<span id="cb203-9"><a href="inter-omics.html#cb203-9"></a>p_vals[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb203-10"><a href="inter-omics.html#cb203-10"></a><span class="co"># check ds congruency</span></span>
<span id="cb203-11"><a href="inter-omics.html#cb203-11"></a><span class="kw">all</span>(<span class="kw">colnames</span>(cor_file) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(cor_file))</span>
<span id="cb203-12"><a href="inter-omics.html#cb203-12"></a><span class="kw">all</span>(<span class="kw">colnames</span>(p_vals) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(p_vals))</span>
<span id="cb203-13"><a href="inter-omics.html#cb203-13"></a></span>
<span id="cb203-14"><a href="inter-omics.html#cb203-14"></a><span class="co"># melt into long format, all vs all comparison: 289^2=83521 rows</span></span>
<span id="cb203-15"><a href="inter-omics.html#cb203-15"></a>cor_file_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(cor_file))</span>
<span id="cb203-16"><a href="inter-omics.html#cb203-16"></a>p_vals_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(p_vals))</span>
<span id="cb203-17"><a href="inter-omics.html#cb203-17"></a></span>
<span id="cb203-18"><a href="inter-omics.html#cb203-18"></a><span class="kw">all</span>(cor_file_m<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> </span>p_vals_m<span class="op">$</span>Var1)</span>
<span id="cb203-19"><a href="inter-omics.html#cb203-19"></a><span class="kw">all</span>(cor_file_m<span class="op">$</span>Var2 <span class="op">==</span><span class="st"> </span>p_vals_m<span class="op">$</span>Var2)</span>
<span id="cb203-20"><a href="inter-omics.html#cb203-20"></a></span>
<span id="cb203-21"><a href="inter-omics.html#cb203-21"></a><span class="co"># complete data set with p_vals and &#39;correlation coeff&#39;</span></span>
<span id="cb203-22"><a href="inter-omics.html#cb203-22"></a>cor_file_m[<span class="st">&quot;p_vals&quot;</span>] &lt;-<span class="st"> </span>p_vals_m<span class="op">$</span>value</span>
<span id="cb203-23"><a href="inter-omics.html#cb203-23"></a></span>
<span id="cb203-24"><a href="inter-omics.html#cb203-24"></a><span class="co"># This removes AB - BA duplicates but still contains self comprisons, AA, BB,CC etc.</span></span>
<span id="cb203-25"><a href="inter-omics.html#cb203-25"></a>cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;Var2&quot;</span>)</span>
<span id="cb203-26"><a href="inter-omics.html#cb203-26"></a>newdf &lt;-<span class="st"> </span>cor_file_m[, cols]  <span class="co">#generate new data set with just those two</span></span>
<span id="cb203-27"><a href="inter-omics.html#cb203-27"></a><span class="co"># a &lt;- Sys.time()</span></span>
<span id="cb203-28"><a href="inter-omics.html#cb203-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(cor_file_m)) {</span>
<span id="cb203-29"><a href="inter-omics.html#cb203-29"></a>    newdf[i, ] =<span class="st"> </span><span class="kw">sort</span>(cor_file_m[i, cols])</span>
<span id="cb203-30"><a href="inter-omics.html#cb203-30"></a>}</span>
<span id="cb203-31"><a href="inter-omics.html#cb203-31"></a><span class="co"># b &lt;- Sys.time() b-a</span></span>
<span id="cb203-32"><a href="inter-omics.html#cb203-32"></a></span>
<span id="cb203-33"><a href="inter-omics.html#cb203-33"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_m[<span class="op">!</span><span class="kw">duplicated</span>(newdf), ]  <span class="co">#and can be removed with duplicate</span></span>
<span id="cb203-34"><a href="inter-omics.html#cb203-34"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_shortened[<span class="kw">which</span>(cor_file_shortened<span class="op">$</span>Var1 <span class="op">!=</span><span class="st"> </span>cor_file_shortened<span class="op">$</span>Var2), ]  <span class="co"># removing self comparison</span></span>
<span id="cb203-35"><a href="inter-omics.html#cb203-35"></a><span class="kw">colnames</span>(cor_file_shortened) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Var1_SparCC&quot;</span>, <span class="st">&quot;Var2_SparCC&quot;</span>, <span class="st">&quot;SparCC&quot;</span>, <span class="st">&quot;pSparCC&quot;</span>)  <span class="co">#41616</span></span>
<span id="cb203-36"><a href="inter-omics.html#cb203-36"></a><span class="kw">write.csv</span>(cor_file_shortened, <span class="st">&quot;data/SparCC_for_networks.csv&quot;</span>)</span>
<span id="cb203-37"><a href="inter-omics.html#cb203-37"></a><span class="kw">rm</span>(cor_file_m, newdf, p_vals_m, i, cols)</span></code></pre></div>
</div>
<div id="maximal-information-coefficient-mic" class="section level4">
<h4><span class="header-section-number">4.3.1.4</span> Maximal information coefficient MIC</h4>
<p>MIC for pairwise interaction was calculated with the R package minearva. The MIC is part of a statistic called Maximal Information-Based Nonparametric Exploration (MINE).</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="inter-omics.html#cb204-1"></a><span class="kw">library</span>(minerva)</span>
<span id="cb204-2"><a href="inter-omics.html#cb204-2"></a></span>
<span id="cb204-3"><a href="inter-omics.html#cb204-3"></a>OTU &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb204-4"><a href="inter-omics.html#cb204-4"></a><span class="kw">rownames</span>(OTU) &lt;-<span class="st"> </span>OTU[, <span class="dv">1</span>]</span>
<span id="cb204-5"><a href="inter-omics.html#cb204-5"></a>OTU[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb204-6"><a href="inter-omics.html#cb204-6"></a>OTU &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(OTU))</span>
<span id="cb204-7"><a href="inter-omics.html#cb204-7"></a></span>
<span id="cb204-8"><a href="inter-omics.html#cb204-8"></a><span class="co"># Calculate MIC of original data set.</span></span>
<span id="cb204-9"><a href="inter-omics.html#cb204-9"></a>MINE &lt;-<span class="st"> </span><span class="kw">mine</span>(OTU)</span>
<span id="cb204-10"><a href="inter-omics.html#cb204-10"></a>MIC &lt;-<span class="st"> </span>MINE<span class="op">$</span>MIC  <span class="co">#dim(MIC): 289 289</span></span></code></pre></div>
<p>Obtaining p-values for this statistic can be achieved by permutation of the original OTU table as below or empirically, by selecting the thousand strongest interactions.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="inter-omics.html#cb205-1"></a><span class="co"># 10 needs to be replaced with 1000 for final version, three times!!!  reshuffling the OTU table, saving the MIC to a list, a total of 1000 times</span></span>
<span id="cb205-2"><a href="inter-omics.html#cb205-2"></a>n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb205-3"><a href="inter-omics.html#cb205-3"></a>results &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb205-4"><a href="inter-omics.html#cb205-4"></a></span>
<span id="cb205-5"><a href="inter-omics.html#cb205-5"></a><span class="co"># For reproducibility, one could e.g.: set.seed(1984)</span></span>
<span id="cb205-6"><a href="inter-omics.html#cb205-6"></a></span>
<span id="cb205-7"><a href="inter-omics.html#cb205-7"></a><span class="co"># c &lt;- Sys.time()</span></span>
<span id="cb205-8"><a href="inter-omics.html#cb205-8"></a><span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) {</span>
<span id="cb205-9"><a href="inter-omics.html#cb205-9"></a>    n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb205-10"><a href="inter-omics.html#cb205-10"></a>    mock &lt;-<span class="st"> </span><span class="kw">apply</span>(OTU, <span class="dt">MARGIN =</span> <span class="dv">2</span>, sample)</span>
<span id="cb205-11"><a href="inter-omics.html#cb205-11"></a>    mock_mine &lt;-<span class="st"> </span><span class="kw">mine</span>(mock)</span>
<span id="cb205-12"><a href="inter-omics.html#cb205-12"></a>    results[[n]] &lt;-<span class="st"> </span>mock_mine<span class="op">$</span>MIC</span>
<span id="cb205-13"><a href="inter-omics.html#cb205-13"></a>}</span>
<span id="cb205-14"><a href="inter-omics.html#cb205-14"></a><span class="co"># d &lt;- Sys.time() d-c</span></span>
<span id="cb205-15"><a href="inter-omics.html#cb205-15"></a></span>
<span id="cb205-16"><a href="inter-omics.html#cb205-16"></a><span class="co"># for every element of the true matrix, go through all the same elements in the 1000 generated mock matrix MIC indices and count how many of those are</span></span>
<span id="cb205-17"><a href="inter-omics.html#cb205-17"></a><span class="co"># greater.</span></span>
<span id="cb205-18"><a href="inter-omics.html#cb205-18"></a>MIC &lt;-<span class="st"> </span>MINE<span class="op">$</span>MIC</span>
<span id="cb205-19"><a href="inter-omics.html#cb205-19"></a></span>
<span id="cb205-20"><a href="inter-omics.html#cb205-20"></a>e_values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="kw">nrow</span>(MIC), <span class="dt">ncol =</span> <span class="kw">ncol</span>(MIC), <span class="dt">data =</span> <span class="dv">0</span>)</span>
<span id="cb205-21"><a href="inter-omics.html#cb205-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(MIC)) {</span>
<span id="cb205-22"><a href="inter-omics.html#cb205-22"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(MIC)) {</span>
<span id="cb205-23"><a href="inter-omics.html#cb205-23"></a>        n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb205-24"><a href="inter-omics.html#cb205-24"></a>        <span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) {</span>
<span id="cb205-25"><a href="inter-omics.html#cb205-25"></a>            n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb205-26"><a href="inter-omics.html#cb205-26"></a>            <span class="cf">if</span> (results[[n]][i, j] <span class="op">&gt;=</span><span class="st"> </span>MIC[i, j]) {</span>
<span id="cb205-27"><a href="inter-omics.html#cb205-27"></a>                e_values[i, j] &lt;-<span class="st"> </span>e_values[i, j] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb205-28"><a href="inter-omics.html#cb205-28"></a>            }</span>
<span id="cb205-29"><a href="inter-omics.html#cb205-29"></a>        }</span>
<span id="cb205-30"><a href="inter-omics.html#cb205-30"></a>    }</span>
<span id="cb205-31"><a href="inter-omics.html#cb205-31"></a>}</span>
<span id="cb205-32"><a href="inter-omics.html#cb205-32"></a></span>
<span id="cb205-33"><a href="inter-omics.html#cb205-33"></a>e_values &lt;-<span class="st"> </span>e_values<span class="op">/</span><span class="dv">1000</span></span>
<span id="cb205-34"><a href="inter-omics.html#cb205-34"></a><span class="co"># write.csv(e_values, &#39;data/MIC_e_values.csv&#39;)</span></span></code></pre></div>
<p>For n=1000, the first part takes about 8 mins on one core, the second part about 2 min. The relevant output is saved in the initial calculations of the MIC and the corresponding e-values are in e_values. These are symmetric matrices that will be reduced to a long table with unique OTUs/ASVs pairs, their MIC and the e-value. For clarity, all other files are removed.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="inter-omics.html#cb206-1"></a><span class="kw">rm</span>(MINE, mock, mock_mine, results)</span>
<span id="cb206-2"><a href="inter-omics.html#cb206-2"></a></span>
<span id="cb206-3"><a href="inter-omics.html#cb206-3"></a><span class="co"># transforming symmetric matrix to unique-pair long format</span></span>
<span id="cb206-4"><a href="inter-omics.html#cb206-4"></a>cor_file &lt;-<span class="st"> </span><span class="kw">data.frame</span>(MIC)</span>
<span id="cb206-5"><a href="inter-omics.html#cb206-5"></a>p_vals &lt;-<span class="st"> </span><span class="kw">data.frame</span>(e_values)</span>
<span id="cb206-6"><a href="inter-omics.html#cb206-6"></a></span>
<span id="cb206-7"><a href="inter-omics.html#cb206-7"></a><span class="co"># inspect the files, adapt them and test congruency</span></span>
<span id="cb206-8"><a href="inter-omics.html#cb206-8"></a><span class="kw">rownames</span>(p_vals) &lt;-<span class="st"> </span><span class="kw">rownames</span>(cor_file)</span>
<span id="cb206-9"><a href="inter-omics.html#cb206-9"></a><span class="kw">colnames</span>(p_vals) &lt;-<span class="st"> </span><span class="kw">colnames</span>(cor_file)</span>
<span id="cb206-10"><a href="inter-omics.html#cb206-10"></a><span class="kw">all</span>(<span class="kw">colnames</span>(cor_file) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(cor_file))</span>
<span id="cb206-11"><a href="inter-omics.html#cb206-11"></a></span>
<span id="cb206-12"><a href="inter-omics.html#cb206-12"></a><span class="co"># melt into long format, all vs all comparison: 289*289=83521 rows</span></span>
<span id="cb206-13"><a href="inter-omics.html#cb206-13"></a>cor_file_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(cor_file))</span>
<span id="cb206-14"><a href="inter-omics.html#cb206-14"></a><span class="kw">all</span>(<span class="kw">colnames</span>(p_vals) <span class="op">==</span><span class="st"> </span><span class="kw">rownames</span>(p_vals))</span>
<span id="cb206-15"><a href="inter-omics.html#cb206-15"></a>p_vals_m &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">as.matrix</span>(p_vals))</span>
<span id="cb206-16"><a href="inter-omics.html#cb206-16"></a></span>
<span id="cb206-17"><a href="inter-omics.html#cb206-17"></a><span class="co"># complete data set with p_vals</span></span>
<span id="cb206-18"><a href="inter-omics.html#cb206-18"></a>cor_file_m[<span class="st">&quot;p_vals&quot;</span>] &lt;-<span class="st"> </span>p_vals_m<span class="op">$</span>value</span>
<span id="cb206-19"><a href="inter-omics.html#cb206-19"></a></span>
<span id="cb206-20"><a href="inter-omics.html#cb206-20"></a><span class="co"># This removes AB - BA duplicates but still contains self comprisons, AA, BB, etc.</span></span>
<span id="cb206-21"><a href="inter-omics.html#cb206-21"></a>cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>, <span class="st">&quot;Var2&quot;</span>)</span>
<span id="cb206-22"><a href="inter-omics.html#cb206-22"></a>newdf &lt;-<span class="st"> </span>cor_file_m[, cols]  <span class="co">#generate new data set with just those two</span></span>
<span id="cb206-23"><a href="inter-omics.html#cb206-23"></a></span>
<span id="cb206-24"><a href="inter-omics.html#cb206-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(cor_file_m)) {</span>
<span id="cb206-25"><a href="inter-omics.html#cb206-25"></a>    newdf[i, ] &lt;-<span class="st"> </span><span class="kw">sort</span>(cor_file_m[i, cols])</span>
<span id="cb206-26"><a href="inter-omics.html#cb206-26"></a>}</span>
<span id="cb206-27"><a href="inter-omics.html#cb206-27"></a></span>
<span id="cb206-28"><a href="inter-omics.html#cb206-28"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_m[<span class="op">!</span><span class="kw">duplicated</span>(newdf), ]  <span class="co">#and can be removed with duplicate</span></span>
<span id="cb206-29"><a href="inter-omics.html#cb206-29"></a>cor_file_shortened &lt;-<span class="st"> </span>cor_file_shortened[<span class="kw">which</span>(cor_file_shortened<span class="op">$</span>Var1 <span class="op">!=</span><span class="st"> </span>cor_file_shortened<span class="op">$</span>Var2), ]  <span class="co"># removing self comparison</span></span>
<span id="cb206-30"><a href="inter-omics.html#cb206-30"></a><span class="kw">rm</span>(cor_file_m, newdf, p_vals_m, i, cols)</span>
<span id="cb206-31"><a href="inter-omics.html#cb206-31"></a></span>
<span id="cb206-32"><a href="inter-omics.html#cb206-32"></a><span class="co"># write.csv(cor_file_shortened, &#39;data/MIC_for_networks.csv&#39;)</span></span></code></pre></div>
</div>
</div>
<div id="consolidation-of-the-different-networks" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Consolidation of the different networks</h3>
<div id="mic" class="section level4">
<h4><span class="header-section-number">4.3.2.1</span> MIC</h4>
<p>MIC allows to detect a variety of interactions. According to the manual of the R wrapper minerva, the resulting MIC score is related to the relationship strenght and it can be interpreted as a correlation measure. It is symmetric and it ranges in [0,1], where it tends to 0 for statistically independent data and it approaches 1 in probability for noiseless functional relationships. Thus, it also contains strong negative relationship up to mutual exclusivity, which we want to filter out.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="inter-omics.html#cb207-1"></a>mic &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MIC_for_networks.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb207-2"><a href="inter-omics.html#cb207-2"></a>mic<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb207-3"><a href="inter-omics.html#cb207-3"></a><span class="kw">colnames</span>(mic) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_mic&quot;</span>, <span class="st">&quot;node2_mic&quot;</span>, <span class="st">&quot;MIC&quot;</span>, <span class="st">&quot;pMIC&quot;</span>)</span></code></pre></div>
<p>Initially, the MIC network generated by the R wrapper minerva contained MIC values for all possible edges (i.e.41616). Of those, 4370 edges/interactions had a p-value <span class="math inline">\(\leq\)</span> 0.05. As we will only include those edges in the final network, we select those and calculate the linear regression coefficient and p-value for the regression, to test whether we are able to distinguish negative from positive interaction.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="inter-omics.html#cb208-1"></a><span class="co"># Original OTU table for regressions</span></span>
<span id="cb208-2"><a href="inter-omics.html#cb208-2"></a>OTU &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_289.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb208-3"><a href="inter-omics.html#cb208-3"></a><span class="kw">rownames</span>(OTU) &lt;-<span class="st"> </span>OTU[, <span class="dv">1</span>]</span>
<span id="cb208-4"><a href="inter-omics.html#cb208-4"></a>OTU[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb208-5"><a href="inter-omics.html#cb208-5"></a>OTU[<span class="st">&quot;ID&quot;</span>] &lt;-<span class="st"> </span><span class="kw">row.names</span>(OTU)</span></code></pre></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="inter-omics.html#cb209-1"></a><span class="co"># goal: in mic data frame, set to &#39;NA&#39; MIC and pMIC of edges with a significant p-value for MIC that have a significant negative regression</span></span>
<span id="cb209-2"><a href="inter-omics.html#cb209-2"></a></span>
<span id="cb209-3"><a href="inter-omics.html#cb209-3"></a>mic[<span class="st">&quot;regression&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb209-4"><a href="inter-omics.html#cb209-4"></a>mic[<span class="st">&quot;p_regression&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb209-5"><a href="inter-omics.html#cb209-5"></a></span>
<span id="cb209-6"><a href="inter-omics.html#cb209-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mic)) {</span>
<span id="cb209-7"><a href="inter-omics.html#cb209-7"></a>    bac1 &lt;-<span class="st"> </span><span class="kw">factor</span>(mic[i, <span class="dv">1</span>])</span>
<span id="cb209-8"><a href="inter-omics.html#cb209-8"></a>    bac2 &lt;-<span class="st"> </span><span class="kw">factor</span>(mic[i, <span class="dv">2</span>])</span>
<span id="cb209-9"><a href="inter-omics.html#cb209-9"></a>    temp_ds &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">rbind</span>(OTU[OTU<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span>bac1, ], OTU[OTU<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span>bac2, ])))</span>
<span id="cb209-10"><a href="inter-omics.html#cb209-10"></a>    temp_ds &lt;-<span class="st"> </span>temp_ds[<span class="op">-</span><span class="kw">c</span>(<span class="dv">15</span>), ]</span>
<span id="cb209-11"><a href="inter-omics.html#cb209-11"></a>    temp_ds[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(temp_ds, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) </span>
<span id="cb209-12"><a href="inter-omics.html#cb209-12"></a>        <span class="kw">factor</span>(x) <span class="cf">else</span> x)  <span class="co"># removes factors, not sure if necessary</span></span>
<span id="cb209-13"><a href="inter-omics.html#cb209-13"></a>    mic<span class="op">$</span>regression[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">c</span>(temp_ds[, <span class="dv">1</span>]) <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(temp_ds[, <span class="dv">2</span>])))<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co">#slope</span></span>
<span id="cb209-14"><a href="inter-omics.html#cb209-14"></a>    mic<span class="op">$</span>p_regression[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">c</span>(temp_ds[, <span class="dv">1</span>]) <span class="op">~</span><span class="st"> </span><span class="kw">c</span>(temp_ds[, <span class="dv">2</span>])))<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">4</span>]  <span class="co">#p-val</span></span>
<span id="cb209-15"><a href="inter-omics.html#cb209-15"></a>}</span>
<span id="cb209-16"><a href="inter-omics.html#cb209-16"></a></span>
<span id="cb209-17"><a href="inter-omics.html#cb209-17"></a>before &lt;-<span class="st"> </span><span class="kw">sum</span>(mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>)  <span class="co">#4370</span></span>
<span id="cb209-18"><a href="inter-omics.html#cb209-18"></a>mic<span class="op">$</span>MIC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>regression <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>p_regression <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="ot">NA</span>, mic<span class="op">$</span>MIC)</span>
<span id="cb209-19"><a href="inter-omics.html#cb209-19"></a>mic<span class="op">$</span>pMIC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>regression <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>mic<span class="op">$</span>p_regression <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>), <span class="ot">NA</span>, mic<span class="op">$</span>pMIC)</span>
<span id="cb209-20"><a href="inter-omics.html#cb209-20"></a>after &lt;-<span class="st"> </span><span class="kw">sum</span>(mic<span class="op">$</span>pMIC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> T)  <span class="co">#3522</span></span>
<span id="cb209-21"><a href="inter-omics.html#cb209-21"></a></span>
<span id="cb209-22"><a href="inter-omics.html#cb209-22"></a><span class="kw">write.csv</span>(mic, <span class="st">&quot;data/MIC.csv&quot;</span>)</span>
<span id="cb209-23"><a href="inter-omics.html#cb209-23"></a><span class="kw">rm</span>(temp_ds, bac1, bac2, i, mic)</span></code></pre></div>
<p>The MIC data set initially contained 41616 edges, 4370 of which were significant prior to the removal of negative correlations and leaving 3522 edges with a p-value <span class="math inline">\(\leq\)</span> 0.05.</p>
</div>
<div id="sparcc-1" class="section level4">
<h4><span class="header-section-number">4.3.2.2</span> SparCC</h4>
<p>The next network data set is based on the SparCC algorithm for computing correlations in compositional data.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="inter-omics.html#cb210-1"></a>sparcc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/SparCC_for_networks.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb210-2"><a href="inter-omics.html#cb210-2"></a>sparcc<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb210-3"><a href="inter-omics.html#cb210-3"></a><span class="kw">colnames</span>(sparcc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_sparcc&quot;</span>, <span class="st">&quot;node2_sparcc&quot;</span>, <span class="st">&quot;SparCC&quot;</span>, <span class="st">&quot;pSparCC&quot;</span>)</span>
<span id="cb210-4"><a href="inter-omics.html#cb210-4"></a><span class="co"># hist(sparcc$SparCC) hist(sparcc$pSparCC)</span></span>
<span id="cb210-5"><a href="inter-omics.html#cb210-5"></a>sparcc<span class="op">$</span>pSparCC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((sparcc<span class="op">$</span>SparCC <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, sparcc<span class="op">$</span>pSparCC)  <span class="co">#setting the p-values of negative interactions to NA</span></span>
<span id="cb210-6"><a href="inter-omics.html#cb210-6"></a>sparcc<span class="op">$</span>SparCC &lt;-<span class="st"> </span><span class="kw">ifelse</span>((sparcc<span class="op">$</span>SparCC <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, sparcc<span class="op">$</span>SparCC)  <span class="co">#setting negative interactions to NA</span></span></code></pre></div>
<p>The network based on the SparCC algorithm contained 41616 edges of which 20420 negative interactions that were removed. 6622 significant positive edges remain.</p>
</div>
<div id="mena" class="section level4">
<h4><span class="header-section-number">4.3.2.3</span> MENA</h4>
<p>The next two network data sets are generated by MENA based on random matrix theory.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="inter-omics.html#cb211-1"></a>mena_pcc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MENA_0.800_PCC_edge_attribute.txt&quot;</span>, <span class="dt">header =</span> F, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb211-2"><a href="inter-omics.html#cb211-2"></a><span class="co"># &#39;np&#39; in V2 and -1 in V5 mean negative interaction, these should be removed.</span></span>
<span id="cb211-3"><a href="inter-omics.html#cb211-3"></a><span class="kw">dim</span>(mena_pcc)[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">dim</span>(mena_pcc[mena_pcc<span class="op">$</span>V5 <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>, ])[<span class="dv">1</span>]  <span class="co"># Number of pos interactions</span></span></code></pre></div>
<pre><code>## [1] 171</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="inter-omics.html#cb213-1"></a>mena_pcc[<span class="st">&quot;pMENA_PCC&quot;</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mena_pcc<span class="op">$</span>V5 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, <span class="fl">0.001</span>)</span>
<span id="cb213-2"><a href="inter-omics.html#cb213-2"></a>mena_pcc<span class="op">$</span>V2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb213-3"><a href="inter-omics.html#cb213-3"></a>mena_pcc<span class="op">$</span>V4 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb213-4"><a href="inter-omics.html#cb213-4"></a>mena_pcc<span class="op">$</span>V5 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb213-5"><a href="inter-omics.html#cb213-5"></a><span class="kw">colnames</span>(mena_pcc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_mena&quot;</span>, <span class="st">&quot;node2_mena&quot;</span>, <span class="st">&quot;pMENA_PCC&quot;</span>)</span>
<span id="cb213-6"><a href="inter-omics.html#cb213-6"></a></span>
<span id="cb213-7"><a href="inter-omics.html#cb213-7"></a>mena_scc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MENA_0.820_SCC_edge_attribute.txt&quot;</span>, <span class="dt">header =</span> F, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb213-8"><a href="inter-omics.html#cb213-8"></a><span class="kw">dim</span>(mena_scc)[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">dim</span>(mena_scc[mena_scc<span class="op">$</span>V5 <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>, ])[<span class="dv">1</span>]  <span class="co"># Number of pos interactions</span></span></code></pre></div>
<pre><code>## [1] 317</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="inter-omics.html#cb215-1"></a>mena_scc[<span class="st">&quot;pMENA_SCC&quot;</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>((mena_scc<span class="op">$</span>V5 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>), <span class="ot">NA</span>, <span class="fl">0.001</span>)</span>
<span id="cb215-2"><a href="inter-omics.html#cb215-2"></a>mena_scc<span class="op">$</span>V2 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb215-3"><a href="inter-omics.html#cb215-3"></a>mena_scc<span class="op">$</span>V4 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb215-4"><a href="inter-omics.html#cb215-4"></a>mena_scc<span class="op">$</span>V5 &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb215-5"><a href="inter-omics.html#cb215-5"></a><span class="kw">colnames</span>(mena_scc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_mena&quot;</span>, <span class="st">&quot;node2_mena&quot;</span>, <span class="st">&quot;pMENA_SCC&quot;</span>)</span></code></pre></div>
<p>MENA network with Pearson correlation contained 3582 edges of which 3411 negative interactions were removed. For Spearman correlations, the network contained 2216 edges of which 1899 negative interactions were removed.</p>
</div>
<div id="lsa" class="section level4">
<h4><span class="header-section-number">4.3.2.4</span> LSA</h4>
<p>The next network data set is based on local similarity. It does not contain any negative values for LSA, so we do not exclude any edges.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="inter-omics.html#cb216-1"></a>lsa &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/fastLSA_for_networks.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb216-2"><a href="inter-omics.html#cb216-2"></a>lsa<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb216-3"><a href="inter-omics.html#cb216-3"></a><span class="kw">colnames</span>(lsa) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;node1_lsa&quot;</span>, <span class="st">&quot;node2_lsa&quot;</span>, <span class="st">&quot;LSA&quot;</span>, <span class="st">&quot;pLSA&quot;</span>)</span>
<span id="cb216-4"><a href="inter-omics.html#cb216-4"></a><span class="kw">dim</span>(lsa)[<span class="dv">1</span>]  <span class="co"># Number of edges</span></span></code></pre></div>
<pre><code>## [1] 208</code></pre>
</div>
<div id="integration-of-the-networks" class="section level4">
<h4><span class="header-section-number">4.3.2.5</span> Integration of the networks</h4>
<p>Now we combine all five networks into one data set.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="inter-omics.html#cb218-1"></a>mic &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/MIC.csv&quot;</span>, <span class="dt">header =</span> T)</span>
<span id="cb218-2"><a href="inter-omics.html#cb218-2"></a>mic<span class="op">$</span>X &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb218-3"><a href="inter-omics.html#cb218-3"></a>mic<span class="op">$</span>regression &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb218-4"><a href="inter-omics.html#cb218-4"></a>mic<span class="op">$</span>p_regression &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb218-5"><a href="inter-omics.html#cb218-5"></a>master_summary &lt;-<span class="st"> </span>mic</span>
<span id="cb218-6"><a href="inter-omics.html#cb218-6"></a></span>
<span id="cb218-7"><a href="inter-omics.html#cb218-7"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb218-8"><a href="inter-omics.html#cb218-8"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, lsa, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node2_lsa&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node1_lsa&quot;</span>))</span>
<span id="cb218-9"><a href="inter-omics.html#cb218-9"></a><span class="co"># sum(!is.na(master_summary$pLSA))==nrow(lsa) #TRUE</span></span>
<span id="cb218-10"><a href="inter-omics.html#cb218-10"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, sparcc, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node1_sparcc&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node2_sparcc&quot;</span>))</span>
<span id="cb218-11"><a href="inter-omics.html#cb218-11"></a><span class="co"># sum(!is.na(master_summary$pSparCC))==sum(!is.na(sparcc$pSparCC)) #TRUE</span></span>
<span id="cb218-12"><a href="inter-omics.html#cb218-12"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, mena_pcc, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node2_mena&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node1_mena&quot;</span>))</span>
<span id="cb218-13"><a href="inter-omics.html#cb218-13"></a><span class="co"># sum(!is.na(master_summary$pMENA_PCC))==sum(!is.na(mena_pcc$pMENA_PCC)) #TRUE</span></span>
<span id="cb218-14"><a href="inter-omics.html#cb218-14"></a>master_summary &lt;-<span class="st"> </span><span class="kw">full_join</span>(master_summary, mena_scc, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">node1_mic =</span> <span class="st">&quot;node2_mena&quot;</span>, <span class="dt">node2_mic =</span> <span class="st">&quot;node1_mena&quot;</span>))</span>
<span id="cb218-15"><a href="inter-omics.html#cb218-15"></a><span class="co"># sum(!is.na(master_summary$pMENA_SCC))==sum(!is.na(mena_scc$pMENA_SCC)) #TRUE</span></span>
<span id="cb218-16"><a href="inter-omics.html#cb218-16"></a>master_summary &lt;-<span class="st"> </span>master_summary[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>)]  <span class="co">#reorder columns</span></span>
<span id="cb218-17"><a href="inter-omics.html#cb218-17"></a><span class="kw">head</span>(master_summary)</span>
<span id="cb218-18"><a href="inter-omics.html#cb218-18"></a><span class="co"># write.csv(master_summary, &#39;data/master_summary_networks_1.csv&#39;, row.names = FALSE)</span></span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="inter-omics.html#cb219-1"></a><span class="co"># For p-value merging: metap::sumlog, or EmpiricalBrownsMethod::EBM</span></span>
<span id="cb219-2"><a href="inter-omics.html#cb219-2"></a><span class="kw">library</span>(metap)</span>
<span id="cb219-3"><a href="inter-omics.html#cb219-3"></a></span>
<span id="cb219-4"><a href="inter-omics.html#cb219-4"></a>ms &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/master_summary_networks_1.csv&quot;</span>, <span class="dt">header =</span> T)</span>
<span id="cb219-5"><a href="inter-omics.html#cb219-5"></a></span>
<span id="cb219-6"><a href="inter-omics.html#cb219-6"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb219-7"><a href="inter-omics.html#cb219-7"></a><span class="kw">hist</span>(ms<span class="op">$</span>pMIC)</span>
<span id="cb219-8"><a href="inter-omics.html#cb219-8"></a><span class="kw">hist</span>(ms<span class="op">$</span>pLSA)  <span class="co">#xlim = range(0,1)</span></span>
<span id="cb219-9"><a href="inter-omics.html#cb219-9"></a><span class="kw">hist</span>(ms<span class="op">$</span>pSparCC)</span>
<span id="cb219-10"><a href="inter-omics.html#cb219-10"></a><span class="kw">plot</span>(ms<span class="op">$</span>pMENA_PCC)</span>
<span id="cb219-11"><a href="inter-omics.html#cb219-11"></a><span class="kw">plot</span>(ms<span class="op">$</span>pMENA_SCC)</span>
<span id="cb219-12"><a href="inter-omics.html#cb219-12"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/integration2-1.png" width="80%" /></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="inter-omics.html#cb220-1"></a><span class="co"># metap::sumlog doesn&#39;t think 0 is a valid p-value, replace all zeros with small non-zero values, e.g. half-minimum</span></span>
<span id="cb220-2"><a href="inter-omics.html#cb220-2"></a>ms<span class="op">$</span>pSparCC[ms<span class="op">$</span>pSparCC <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="fl">0.005</span></span>
<span id="cb220-3"><a href="inter-omics.html#cb220-3"></a>ms<span class="op">$</span>pMIC[ms<span class="op">$</span>pMIC <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="fl">5e-04</span></span>
<span id="cb220-4"><a href="inter-omics.html#cb220-4"></a></span>
<span id="cb220-5"><a href="inter-omics.html#cb220-5"></a>ms[<span class="st">&quot;NA_count&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb220-6"><a href="inter-omics.html#cb220-6"></a>ms[<span class="st">&quot;signif_0.05&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb220-7"><a href="inter-omics.html#cb220-7"></a>ms[<span class="st">&quot;signif_0.001&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb220-8"><a href="inter-omics.html#cb220-8"></a>ms[<span class="st">&quot;sumlog&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb220-9"><a href="inter-omics.html#cb220-9"></a></span>
<span id="cb220-10"><a href="inter-omics.html#cb220-10"></a>n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb220-11"><a href="inter-omics.html#cb220-11"></a>k &lt;-<span class="st"> </span><span class="kw">dim</span>(ms)[<span class="dv">1</span>]</span>
<span id="cb220-12"><a href="inter-omics.html#cb220-12"></a><span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span>k) {</span>
<span id="cb220-13"><a href="inter-omics.html#cb220-13"></a>    n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb220-14"><a href="inter-omics.html#cb220-14"></a>    ms<span class="op">$</span>NA_count[n] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">is.na</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb220-15"><a href="inter-omics.html#cb220-15"></a>    ms<span class="op">$</span>signif_<span class="fl">0.05</span>[n] &lt;-<span class="st"> </span><span class="kw">sum</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> T)</span>
<span id="cb220-16"><a href="inter-omics.html#cb220-16"></a>    ms<span class="op">$</span>signif_<span class="fl">0.001</span>[n] &lt;-<span class="st"> </span><span class="kw">sum</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.001</span>, <span class="dt">na.rm =</span> T)</span>
<span id="cb220-17"><a href="inter-omics.html#cb220-17"></a>    <span class="kw">ifelse</span>((ms<span class="op">$</span>NA_count[n] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>), (ms<span class="op">$</span>sumlog[n] &lt;-<span class="st"> </span><span class="kw">sumlog</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>][<span class="op">!</span><span class="kw">is.na</span>(ms[n, <span class="dv">3</span><span class="op">:</span><span class="dv">7</span>])])<span class="op">$</span>p), <span class="ot">NA</span>)</span>
<span id="cb220-18"><a href="inter-omics.html#cb220-18"></a>}</span>
<span id="cb220-19"><a href="inter-omics.html#cb220-19"></a><span class="kw">rm</span>(k, n)</span>
<span id="cb220-20"><a href="inter-omics.html#cb220-20"></a></span>
<span id="cb220-21"><a href="inter-omics.html#cb220-21"></a>ms[<span class="st">&quot;p.adjust_Bonferroni&quot;</span>] &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(ms<span class="op">$</span>sumlog, <span class="dt">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb220-22"><a href="inter-omics.html#cb220-22"></a>ms[<span class="st">&quot;p.adjust_FDR&quot;</span>] &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(ms<span class="op">$</span>sumlog, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)  <span class="co">#aka Benjamini &amp; Hochberg</span></span>
<span id="cb220-23"><a href="inter-omics.html#cb220-23"></a></span>
<span id="cb220-24"><a href="inter-omics.html#cb220-24"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb220-25"><a href="inter-omics.html#cb220-25"></a><span class="kw">hist</span>(ms<span class="op">$</span>signif_<span class="fl">0.05</span>, <span class="dt">main =</span> <span class="st">&quot;p-values &lt;= 0.05&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Counts per edge &quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb220-26"><a href="inter-omics.html#cb220-26"></a><span class="kw">hist</span>(ms<span class="op">$</span>signif_<span class="fl">0.001</span>, <span class="dt">main =</span> <span class="st">&quot;p-values &lt;= 0.001&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Counts per edge &quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb220-27"><a href="inter-omics.html#cb220-27"></a><span class="kw">hist</span>(ms<span class="op">$</span>NA_count, <span class="dt">main =</span> <span class="st">&quot;NAs&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Counts per edge &quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/integration2-2.png" width="80%" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="inter-omics.html#cb221-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb221-2"><a href="inter-omics.html#cb221-2"></a></span>
<span id="cb221-3"><a href="inter-omics.html#cb221-3"></a>ds &lt;-<span class="st"> </span><span class="kw">split</span>(ms, ms<span class="op">$</span>signif_<span class="fl">0.05</span>)</span>
<span id="cb221-4"><a href="inter-omics.html#cb221-4"></a>raw_nodes &lt;-<span class="st"> </span><span class="kw">rbind</span>(ds<span class="op">$</span><span class="st">`</span><span class="dt">4</span><span class="st">`</span>, ds<span class="op">$</span><span class="st">`</span><span class="dt">5</span><span class="st">`</span>)  <span class="co"># Selection/inclusion criterion</span></span>
<span id="cb221-5"><a href="inter-omics.html#cb221-5"></a><span class="kw">rm</span>(ds)</span>
<span id="cb221-6"><a href="inter-omics.html#cb221-6"></a></span>
<span id="cb221-7"><a href="inter-omics.html#cb221-7"></a>edges &lt;-<span class="st"> </span>raw_nodes[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb221-8"><a href="inter-omics.html#cb221-8"></a>nodes &lt;-<span class="st"> </span><span class="kw">union</span>(raw_nodes<span class="op">$</span>node1_mic, raw_nodes<span class="op">$</span>node2_mic)</span>
<span id="cb221-9"><a href="inter-omics.html#cb221-9"></a></span>
<span id="cb221-10"><a href="inter-omics.html#cb221-10"></a><span class="kw">write.csv</span>(edges, <span class="st">&quot;data/master_summary_networks_2.csv&quot;</span>, <span class="dt">row.names =</span> F)</span></code></pre></div>
<p>We selected all edges with at least 4 p-values <span class="math inline">\(\leq\)</span> 0.05 to visualise in the network. This consensus network has 136 edges and 113 nodes. Below are two versions of the network. In the first version, all OTUs correlating with barettin are colour-coded by class. In the second version, all OTUs increasing/decreasing woth depth are highlighted by colour.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="inter-omics.html#cb222-1"></a><span class="co"># THANK YOU: https://kateto.net/networks-r-igraph</span></span>
<span id="cb222-2"><a href="inter-omics.html#cb222-2"></a></span>
<span id="cb222-3"><a href="inter-omics.html#cb222-3"></a>edges &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/master_summary_networks_2.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb222-4"><a href="inter-omics.html#cb222-4"></a>nodes &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">union</span>(raw_nodes<span class="op">$</span>node1_mic, raw_nodes<span class="op">$</span>node2_mic))</span>
<span id="cb222-5"><a href="inter-omics.html#cb222-5"></a></span>
<span id="cb222-6"><a href="inter-omics.html#cb222-6"></a><span class="co"># annotation data required: inc-dec/depth response, taxonomy, barettin corelation hex color code</span></span>
<span id="cb222-7"><a href="inter-omics.html#cb222-7"></a>depth &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_OTUs_overall_rabdc_annotated.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb222-8"><a href="inter-omics.html#cb222-8"></a>taxonomy &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/microbiome_taxonomy.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb222-9"><a href="inter-omics.html#cb222-9"></a>barettin &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/GB_OTU_barettin_correlation.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb222-10"><a href="inter-omics.html#cb222-10"></a></span>
<span id="cb222-11"><a href="inter-omics.html#cb222-11"></a><span class="co"># matching IDs</span></span>
<span id="cb222-12"><a href="inter-omics.html#cb222-12"></a><span class="kw">colnames</span>(nodes) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;OTU_long&quot;</span>)</span>
<span id="cb222-13"><a href="inter-omics.html#cb222-13"></a>nodes[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(nodes<span class="op">$</span>OTU_long, <span class="st">&quot;OTU196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb222-14"><a href="inter-omics.html#cb222-14"></a>depth[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(depth<span class="op">$</span>XOTU, <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb222-15"><a href="inter-omics.html#cb222-15"></a>taxonomy[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(taxonomy<span class="op">$</span>OTU_ID, <span class="st">&quot;196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb222-16"><a href="inter-omics.html#cb222-16"></a>barettin[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(barettin<span class="op">$</span>XOTU, <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb222-17"><a href="inter-omics.html#cb222-17"></a></span>
<span id="cb222-18"><a href="inter-omics.html#cb222-18"></a><span class="co"># downsizing to relevant columns nodes$OTU_long &lt;- NULL</span></span>
<span id="cb222-19"><a href="inter-omics.html#cb222-19"></a>depth &lt;-<span class="st"> </span>depth[, <span class="kw">c</span>(<span class="st">&quot;ttest_pval&quot;</span>, <span class="st">&quot;ttest_fdr&quot;</span>, <span class="st">&quot;inc_dec_estimate&quot;</span>, <span class="st">&quot;inc_dec_p_val&quot;</span>, <span class="st">&quot;fdr&quot;</span>, <span class="st">&quot;classification&quot;</span>, <span class="st">&quot;OTU&quot;</span>)]</span>
<span id="cb222-20"><a href="inter-omics.html#cb222-20"></a><span class="kw">colnames</span>(depth) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ttest_pval&quot;</span>, <span class="st">&quot;ttest_fdr&quot;</span>, <span class="st">&quot;inc_dec_estimate&quot;</span>, <span class="st">&quot;inc_dec_p_val&quot;</span>, <span class="st">&quot;inc_dec_fdr&quot;</span>, <span class="st">&quot;inc_dec_classification&quot;</span>, <span class="st">&quot;OTU&quot;</span>)</span>
<span id="cb222-21"><a href="inter-omics.html#cb222-21"></a>barettin<span class="op">$</span>XOTU &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb222-22"><a href="inter-omics.html#cb222-22"></a>taxonomy &lt;-<span class="st"> </span>taxonomy[, <span class="kw">c</span>(<span class="st">&quot;Kingdom&quot;</span>, <span class="st">&quot;Phylum&quot;</span>, <span class="st">&quot;Class&quot;</span>, <span class="st">&quot;OTU&quot;</span>)]</span>
<span id="cb222-23"><a href="inter-omics.html#cb222-23"></a>taxonomy[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(taxonomy, str_trim)</span>
<span id="cb222-24"><a href="inter-omics.html#cb222-24"></a></span>
<span id="cb222-25"><a href="inter-omics.html#cb222-25"></a>nodes &lt;-<span class="st"> </span><span class="kw">left_join</span>(nodes, depth)</span>
<span id="cb222-26"><a href="inter-omics.html#cb222-26"></a>nodes &lt;-<span class="st"> </span><span class="kw">left_join</span>(nodes, barettin)</span>
<span id="cb222-27"><a href="inter-omics.html#cb222-27"></a>nodes &lt;-<span class="st"> </span><span class="kw">left_join</span>(nodes, taxonomy)</span>
<span id="cb222-28"><a href="inter-omics.html#cb222-28"></a></span>
<span id="cb222-29"><a href="inter-omics.html#cb222-29"></a><span class="co"># Adding categorical information nodes[&#39;barettin_c&#39;] &lt;- ifelse(nodes$barettin_estimate_P&gt;0 &amp; nodes$barettin_p_val_P&lt;0.05, 1, 0) # for scaling node size</span></span>
<span id="cb222-30"><a href="inter-omics.html#cb222-30"></a>nodes[<span class="st">&quot;barettin_c&quot;</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(nodes<span class="op">$</span>barettin_p_val_P <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># for scaling node size; both significant pos and neg this time</span></span>
<span id="cb222-31"><a href="inter-omics.html#cb222-31"></a>nodes[<span class="st">&quot;barettin_resp&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># new: classifier for pos or neg barettin interaction</span></span>
<span id="cb222-32"><a href="inter-omics.html#cb222-32"></a>nodes<span class="op">$</span>barettin_resp[nodes<span class="op">$</span>barettin_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>nodes<span class="op">$</span>barettin_estimate_P <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb222-33"><a href="inter-omics.html#cb222-33"></a>nodes<span class="op">$</span>barettin_resp[nodes<span class="op">$</span>barettin_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>nodes<span class="op">$</span>barettin_estimate_P <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb222-34"><a href="inter-omics.html#cb222-34"></a><span class="kw">length</span>(<span class="kw">unique</span>(nodes<span class="op">$</span>Class[nodes<span class="op">$</span>barettin_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]))  <span class="co">#coloring by class impossible with 21different categories</span></span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="inter-omics.html#cb224-1"></a><span class="kw">unique</span>(nodes<span class="op">$</span>Phylum[nodes<span class="op">$</span>barettin_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])  <span class="co"># use colors from rel abdc plot </span></span></code></pre></div>
<pre><code>## [1] &quot;Acidobacteria&quot;    &quot;Thaumarchaeota&quot;   &quot;Proteobacteria&quot;   &quot;Chloroflexi&quot;      &quot;&quot;                 &quot;Gemmatimonadetes&quot; &quot;Nitrospirae&quot;      &quot;Actinobacteria&quot;</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="inter-omics.html#cb226-1"></a>nodes[<span class="st">&quot;OTU_lab&quot;</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb226-2"><a href="inter-omics.html#cb226-2"></a>nodes<span class="op">$</span>OTU_lab[nodes<span class="op">$</span>barettin_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span>nodes<span class="op">$</span>OTU</span>
<span id="cb226-3"><a href="inter-omics.html#cb226-3"></a>nodes[<span class="st">&quot;inc_dec_c&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb226-4"><a href="inter-omics.html#cb226-4"></a>nodes<span class="op">$</span>inc_dec_c[nodes<span class="op">$</span>inc_dec_p_val <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># for scaling node size</span></span>
<span id="cb226-5"><a href="inter-omics.html#cb226-5"></a>nodes[<span class="st">&quot;inc_dec_c_group&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb226-6"><a href="inter-omics.html#cb226-6"></a>nodes<span class="op">$</span>inc_dec_c_group[nodes<span class="op">$</span>inc_dec_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>nodes<span class="op">$</span>inc_dec_estimate <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;deep&quot;</span>)  <span class="co"># for colouring shallow vs. deep</span></span>
<span id="cb226-7"><a href="inter-omics.html#cb226-7"></a>nodes<span class="op">$</span>inc_dec_c_group[nodes<span class="op">$</span>inc_dec_c <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>nodes<span class="op">$</span>inc_dec_estimate <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;shallow&quot;</span>)  <span class="co"># for colouring shallow vs. deep</span></span>
<span id="cb226-8"><a href="inter-omics.html#cb226-8"></a><span class="co"># Pearson pmcc &gt; 0 &amp; p &lt; 0.05 56 fdr &lt; 0.05 22 Spearman rho &gt; 0 &amp; p &lt; 0.05 42 fdr &lt; 0.05 1</span></span>
<span id="cb226-9"><a href="inter-omics.html#cb226-9"></a></span>
<span id="cb226-10"><a href="inter-omics.html#cb226-10"></a>nodes[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(nodes, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="kw">is.factor</span>(x)) <span class="kw">factor</span>(x) <span class="cf">else</span> x)</span>
<span id="cb226-11"><a href="inter-omics.html#cb226-11"></a></span>
<span id="cb226-12"><a href="inter-omics.html#cb226-12"></a><span class="kw">library</span>(igraph)</span>
<span id="cb226-13"><a href="inter-omics.html#cb226-13"></a>net &lt;-<span class="st"> </span><span class="kw">graph_from_data_frame</span>(<span class="dt">d =</span> edges, <span class="dt">vertices =</span> nodes, <span class="dt">directed =</span> F)</span>
<span id="cb226-14"><a href="inter-omics.html#cb226-14"></a>l &lt;-<span class="st"> </span><span class="kw">layout_with_kk</span>(net)</span>
<span id="cb226-15"><a href="inter-omics.html#cb226-15"></a></span>
<span id="cb226-16"><a href="inter-omics.html#cb226-16"></a><span class="co"># 11 colourblind-friendly colours from https://medialab.github.io/iwanthue/</span></span>
<span id="cb226-17"><a href="inter-omics.html#cb226-17"></a></span>
<span id="cb226-18"><a href="inter-omics.html#cb226-18"></a><span class="co"># Taxonomy coloring &amp; barettin: Class ecol &lt;- rep(&#39;gray80&#39;, ecount(net)) vcol &lt;- rep(&#39;grey40&#39;, vcount(net)) vcol[V(net)$Class==&#39;Subgroup_26&#39;] &lt;- &#39;#628ed6&#39;</span></span>
<span id="cb226-19"><a href="inter-omics.html#cb226-19"></a><span class="co"># vcol[V(net)$Class==&#39;Subgroup_15&#39;] &lt;- &#39;#957d34&#39; vcol[V(net)$Class==&#39;Subgroup_6&#39;] &lt;- &#39;#45c097&#39; vcol[V(net)$Class==&#39;Anaerolineae&#39;] &lt;- &#39;#ba4758&#39;</span></span>
<span id="cb226-20"><a href="inter-omics.html#cb226-20"></a><span class="co"># vcol[V(net)$Class==&#39;JG30-KF-CM66&#39;] &lt;- &#39;#b2467e&#39; vcol[V(net)$Class==&#39;SAR202_clade&#39;] &lt;- &#39;#5b3687&#39; vcol[V(net)$Class==&#39;TK10&#39;] &lt;- &#39;#ba5437&#39;</span></span>
<span id="cb226-21"><a href="inter-omics.html#cb226-21"></a><span class="co"># vcol[V(net)$Class==&#39;BD2-11_terrestrial_group&#39;] &lt;- &#39;#69ab54&#39; vcol[V(net)$Class==&#39;Alphaproteobacteria&#39;] &lt;- &#39;#c777cb&#39; vcol[V(net)$Class==&#39;JTB23&#39;] &lt;- &#39;#c3a63e&#39;</span></span>
<span id="cb226-22"><a href="inter-omics.html#cb226-22"></a><span class="co"># vcol[V(net)$Class==&#39;Acidimicrobiia&#39;] &lt;- &#39;#6a70d7&#39; colrs</span></span>
<span id="cb226-23"><a href="inter-omics.html#cb226-23"></a><span class="co"># &lt;-c(&#39;#628ed6&#39;,&#39;#957d34&#39;,&#39;#45c097&#39;,&#39;#ba4758&#39;,&#39;#b2467e&#39;,&#39;#5b3687&#39;,&#39;#ba5437&#39;,&#39;#69ab54&#39;,&#39;#c777cb&#39;,&#39;#c3a63e&#39;,&#39;#6a70d7&#39;) V(net)$color &lt;- colrs[V(net)$Class]</span></span>
<span id="cb226-24"><a href="inter-omics.html#cb226-24"></a></span>
<span id="cb226-25"><a href="inter-omics.html#cb226-25"></a><span class="co"># Taxonomy coloring &amp; barettin: Phylum</span></span>
<span id="cb226-26"><a href="inter-omics.html#cb226-26"></a>ecol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;gray80&quot;</span>, <span class="kw">ecount</span>(net))</span>
<span id="cb226-27"><a href="inter-omics.html#cb226-27"></a>vcol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;grey40&quot;</span>, <span class="kw">vcount</span>(net))</span>
<span id="cb226-28"><a href="inter-omics.html#cb226-28"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Acidobacteria&quot;</span>] &lt;-<span class="st"> &quot;#b8c4f6&quot;</span></span>
<span id="cb226-29"><a href="inter-omics.html#cb226-29"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Thaumarchaeota&quot;</span>] &lt;-<span class="st"> &quot;#aba900&quot;</span></span>
<span id="cb226-30"><a href="inter-omics.html#cb226-30"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Proteobacteria&quot;</span>] &lt;-<span class="st"> &quot;#ff633f&quot;</span></span>
<span id="cb226-31"><a href="inter-omics.html#cb226-31"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Chloroflexi&quot;</span>] &lt;-<span class="st"> &quot;#01559d&quot;</span></span>
<span id="cb226-32"><a href="inter-omics.html#cb226-32"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Gemmatimonadetes&quot;</span>] &lt;-<span class="st"> &quot;#019c51&quot;</span></span>
<span id="cb226-33"><a href="inter-omics.html#cb226-33"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Nitrospirae&quot;</span>] &lt;-<span class="st"> &quot;#49ca00&quot;</span></span>
<span id="cb226-34"><a href="inter-omics.html#cb226-34"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;Actinobacteria&quot;</span>] &lt;-<span class="st"> &quot;#ffaaaf&quot;</span></span>
<span id="cb226-35"><a href="inter-omics.html#cb226-35"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>Phylum <span class="op">==</span><span class="st"> &quot;&quot;</span>] &lt;-<span class="st"> &quot;#ffffff&quot;</span></span>
<span id="cb226-36"><a href="inter-omics.html#cb226-36"></a>colrs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#b8c4f6&quot;</span>, <span class="st">&quot;#aba900&quot;</span>, <span class="st">&quot;#ff633f&quot;</span>, <span class="st">&quot;#01559d&quot;</span>, <span class="st">&quot;#019c51&quot;</span>, <span class="st">&quot;#49ca00&quot;</span>, <span class="st">&quot;#ffaaaf&quot;</span>, <span class="st">&quot;#ffffff&quot;</span>)</span>
<span id="cb226-37"><a href="inter-omics.html#cb226-37"></a><span class="kw">V</span>(net)<span class="op">$</span>color &lt;-<span class="st"> </span>colrs[<span class="kw">V</span>(net)<span class="op">$</span>Phylum]</span>
<span id="cb226-38"><a href="inter-omics.html#cb226-38"></a></span>
<span id="cb226-39"><a href="inter-omics.html#cb226-39"></a></span>
<span id="cb226-40"><a href="inter-omics.html#cb226-40"></a><span class="kw">V</span>(net)<span class="op">$</span>shape &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;circle&quot;</span>, <span class="st">&quot;csquare&quot;</span>)[<span class="kw">V</span>(net)<span class="op">$</span>barettin_resp <span class="op">+</span><span class="st"> </span><span class="dv">1</span>]</span>
<span id="cb226-41"><a href="inter-omics.html#cb226-41"></a></span>
<span id="cb226-42"><a href="inter-omics.html#cb226-42"></a><span class="co"># set vertex.label=V(net)$OTU for OTU numbers</span></span>
<span id="cb226-43"><a href="inter-omics.html#cb226-43"></a><span class="kw">plot</span>(net, <span class="dt">vertex.color =</span> vcol, <span class="dt">edge.color =</span> ecol, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>barettin_c <span class="op">*</span><span class="st"> </span><span class="dv">7</span>, <span class="dt">vertex.label =</span> <span class="kw">V</span>(net)<span class="op">$</span>OTU_lab, <span class="dt">layout =</span> l)</span>
<span id="cb226-44"><a href="inter-omics.html#cb226-44"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="kw">c</span>(<span class="st">&quot;Acidobacteria&quot;</span>, <span class="st">&quot;Thaumarchaeota&quot;</span>, <span class="st">&quot;Proteobacteria&quot;</span>, <span class="st">&quot;Chloroflexi&quot;</span>, <span class="st">&quot;Gemmatimonadetes&quot;</span>, <span class="st">&quot;Nitrospirae&quot;</span>, <span class="st">&quot;Actinobacteria&quot;</span>, <span class="st">&quot;unclasified&quot;</span>), </span>
<span id="cb226-45"><a href="inter-omics.html#cb226-45"></a>    <span class="dt">pt.bg =</span> colrs, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="dt">pt.cex =</span> <span class="fl">1.5</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span id="fig:igraph1"></span>
<img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/igraph-1.png" alt="Microbial interaction networks highlighting OTUs correlating with barettin and OTUs correlating with depth." width="672" />
<p class="caption">
Figure 4.1: Microbial interaction networks highlighting OTUs correlating with barettin and OTUs correlating with depth.
</p>
</div>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="inter-omics.html#cb227-1"></a><span class="co"># legend(x=1, y=0.5, c(&#39;Subgroup_26 (Acidobacteria)&#39;,&#39;Subgroup_15 (Acidobacteria)&#39;, &#39;Subgroup_6 (Acidobacteria)&#39;, &#39;Anaerolineae (Chloroflexi)&#39;, &#39;JG30-KF-CM66</span></span>
<span id="cb227-2"><a href="inter-omics.html#cb227-2"></a><span class="co"># (Chloroflexi)&#39;, &#39;SAR202_clade (Chloroflexi)&#39;, &#39;TK10 (Chloroflexi)&#39;, &#39;BD2-11_terrestrial_group (Gemmatimonadetes)&#39;, &#39;Alphaproteobacteria (Proteobacteria)&#39;,</span></span>
<span id="cb227-3"><a href="inter-omics.html#cb227-3"></a><span class="co"># &#39;JTB23 (Proteobacteria)&#39;, &#39;Acidimicrobiia (Actinobacteria)&#39;), pt.bg=colrs, pch=21,col=&#39;#777777&#39;, pt.cex=1.5, cex=.7, bty=&#39;n&#39;, ncol=1)</span></span>
<span id="cb227-4"><a href="inter-omics.html#cb227-4"></a></span>
<span id="cb227-5"><a href="inter-omics.html#cb227-5"></a><span class="co"># circles are positive correlations with barettin, squares are negative</span></span>
<span id="cb227-6"><a href="inter-omics.html#cb227-6"></a></span>
<span id="cb227-7"><a href="inter-omics.html#cb227-7"></a></span>
<span id="cb227-8"><a href="inter-omics.html#cb227-8"></a><span class="co"># Depth by correlation</span></span>
<span id="cb227-9"><a href="inter-omics.html#cb227-9"></a>ecol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;gray80&quot;</span>, <span class="kw">ecount</span>(net))</span>
<span id="cb227-10"><a href="inter-omics.html#cb227-10"></a>vcol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;grey40&quot;</span>, <span class="kw">vcount</span>(net))</span>
<span id="cb227-11"><a href="inter-omics.html#cb227-11"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>inc_dec_c_group <span class="op">==</span><span class="st"> &quot;shallow&quot;</span>] &lt;-<span class="st"> &quot;gold&quot;</span></span>
<span id="cb227-12"><a href="inter-omics.html#cb227-12"></a>vcol[<span class="kw">V</span>(net)<span class="op">$</span>inc_dec_c_group <span class="op">==</span><span class="st"> &quot;deep&quot;</span>] &lt;-<span class="st"> &quot;blue&quot;</span></span>
<span id="cb227-13"><a href="inter-omics.html#cb227-13"></a></span>
<span id="cb227-14"><a href="inter-omics.html#cb227-14"></a><span class="kw">V</span>(net)<span class="op">$</span>color &lt;-<span class="st"> </span>colrs[<span class="kw">V</span>(net)<span class="op">$</span>inc_dec_c_group]</span>
<span id="cb227-15"><a href="inter-omics.html#cb227-15"></a>colrs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gold&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb227-16"><a href="inter-omics.html#cb227-16"></a></span>
<span id="cb227-17"><a href="inter-omics.html#cb227-17"></a><span class="kw">plot</span>(net, <span class="dt">vertex.color =</span> vcol, <span class="dt">edge.color =</span> ecol, <span class="dt">vertex.size =</span> <span class="kw">V</span>(net)<span class="op">$</span>inc_dec_c <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">vertex.label =</span> <span class="ot">NA</span>, <span class="dt">layout =</span> l)</span>
<span id="cb227-18"><a href="inter-omics.html#cb227-18"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="kw">c</span>(<span class="st">&quot;decreasing&quot;</span>, <span class="st">&quot;incerasing&quot;</span>), <span class="dt">pt.bg =</span> colrs, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">col =</span> <span class="st">&quot;#777777&quot;</span>, <span class="dt">pt.cex =</span> <span class="fl">1.5</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span id="fig:igraph2"></span>
<img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/igraph-2.png" alt="Microbial interaction networks highlighting OTUs correlating with barettin and OTUs correlating with depth." width="672" />
<p class="caption">
Figure 4.2: Microbial interaction networks highlighting OTUs correlating with barettin and OTUs correlating with depth.
</p>
</div>
</div>
</div>
</div>
<div id="shortlist" class="section level2">
<h2><span class="header-section-number">4.4</span> Shortlist</h2>
<p>We believe the producer of barettin (and related compounds) to have the following properties:</p>
<ul>
<li>common (average relative abundance &gt; 0.25%)</li>
<li>specific to <em>G. barretti</em></li>
<li>positively correlated with barettin</li>
</ul>
<p>the OTUs below fulfill these criteria:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="inter-omics.html#cb228-1"></a><span class="co"># most annotation from NW</span></span>
<span id="cb228-2"><a href="inter-omics.html#cb228-2"></a>micro &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/OTU_all_R.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb228-3"><a href="inter-omics.html#cb228-3"></a></span>
<span id="cb228-4"><a href="inter-omics.html#cb228-4"></a>OTU_prep_sqrt &lt;-<span class="st"> </span><span class="cf">function</span>(micro) {</span>
<span id="cb228-5"><a href="inter-omics.html#cb228-5"></a>    <span class="kw">rownames</span>(micro) &lt;-<span class="st"> </span>micro<span class="op">$</span>Sample_ID</span>
<span id="cb228-6"><a href="inter-omics.html#cb228-6"></a>    micro<span class="op">$</span>Sample_ID &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb228-7"><a href="inter-omics.html#cb228-7"></a>    <span class="co"># micro &lt;- sqrt(micro)</span></span>
<span id="cb228-8"><a href="inter-omics.html#cb228-8"></a>    </span>
<span id="cb228-9"><a href="inter-omics.html#cb228-9"></a>    micro_gb &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Gb&quot;</span>), ]</span>
<span id="cb228-10"><a href="inter-omics.html#cb228-10"></a>    micro_sf &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Sf&quot;</span>), ]</span>
<span id="cb228-11"><a href="inter-omics.html#cb228-11"></a>    micro_wb &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Wb&quot;</span>), ]</span>
<span id="cb228-12"><a href="inter-omics.html#cb228-12"></a>    </span>
<span id="cb228-13"><a href="inter-omics.html#cb228-13"></a>    micro_gb &lt;-<span class="st"> </span>micro_gb[, <span class="kw">colSums</span>(micro_gb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]  <span class="co">#removes columns that only contain 0</span></span>
<span id="cb228-14"><a href="inter-omics.html#cb228-14"></a>    micro_sf &lt;-<span class="st"> </span>micro_sf[, <span class="kw">colSums</span>(micro_sf <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb228-15"><a href="inter-omics.html#cb228-15"></a>    micro_wb &lt;-<span class="st"> </span>micro_wb[, <span class="kw">colSums</span>(micro_wb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb228-16"><a href="inter-omics.html#cb228-16"></a>    micros &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">gb =</span> micro_gb, <span class="dt">sf =</span> micro_sf, <span class="dt">wb =</span> micro_wb)</span>
<span id="cb228-17"><a href="inter-omics.html#cb228-17"></a>    <span class="kw">return</span>(micros)</span>
<span id="cb228-18"><a href="inter-omics.html#cb228-18"></a>}</span>
<span id="cb228-19"><a href="inter-omics.html#cb228-19"></a></span>
<span id="cb228-20"><a href="inter-omics.html#cb228-20"></a>micro_ds &lt;-<span class="st"> </span><span class="kw">OTU_prep_sqrt</span>(micro)</span>
<span id="cb228-21"><a href="inter-omics.html#cb228-21"></a></span>
<span id="cb228-22"><a href="inter-omics.html#cb228-22"></a>overall_rabdc &lt;-<span class="st"> </span><span class="cf">function</span>(micro) {</span>
<span id="cb228-23"><a href="inter-omics.html#cb228-23"></a>    mic &lt;-<span class="st"> </span>micro</span>
<span id="cb228-24"><a href="inter-omics.html#cb228-24"></a>    n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb228-25"><a href="inter-omics.html#cb228-25"></a>    k &lt;-<span class="st"> </span><span class="kw">dim</span>(mic)[<span class="dv">1</span>]</span>
<span id="cb228-26"><a href="inter-omics.html#cb228-26"></a>    mic[<span class="st">&quot;rowsum&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(mic, <span class="dv">1</span>, sum)</span>
<span id="cb228-27"><a href="inter-omics.html#cb228-27"></a>    </span>
<span id="cb228-28"><a href="inter-omics.html#cb228-28"></a>    <span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span>k) {</span>
<span id="cb228-29"><a href="inter-omics.html#cb228-29"></a>        n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb228-30"><a href="inter-omics.html#cb228-30"></a>        mic[n, ] &lt;-<span class="st"> </span>mic[n, ]<span class="op">/</span>(mic<span class="op">$</span>rowsum[n])</span>
<span id="cb228-31"><a href="inter-omics.html#cb228-31"></a>    }</span>
<span id="cb228-32"><a href="inter-omics.html#cb228-32"></a>    </span>
<span id="cb228-33"><a href="inter-omics.html#cb228-33"></a>    mic<span class="op">$</span>rowsum &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb228-34"><a href="inter-omics.html#cb228-34"></a>    mic &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(mic))</span>
<span id="cb228-35"><a href="inter-omics.html#cb228-35"></a>    mic[<span class="st">&quot;avg_rel_abdc&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(mic, <span class="dv">1</span>, mean)</span>
<span id="cb228-36"><a href="inter-omics.html#cb228-36"></a>    mic[<span class="st">&quot;occurrence&quot;</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(mic<span class="op">$</span>avg <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.0025</span>, <span class="st">&quot;common&quot;</span>, <span class="st">&quot;rare&quot;</span>)</span>
<span id="cb228-37"><a href="inter-omics.html#cb228-37"></a>    <span class="kw">return</span>(mic)</span>
<span id="cb228-38"><a href="inter-omics.html#cb228-38"></a>}</span>
<span id="cb228-39"><a href="inter-omics.html#cb228-39"></a></span>
<span id="cb228-40"><a href="inter-omics.html#cb228-40"></a>occurrence &lt;-<span class="st"> </span><span class="kw">lapply</span>(micro_ds, overall_rabdc)</span>
<span id="cb228-41"><a href="inter-omics.html#cb228-41"></a></span>
<span id="cb228-42"><a href="inter-omics.html#cb228-42"></a>depth &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/gb_OTUs_overall_rabdc_annotated.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb228-43"><a href="inter-omics.html#cb228-43"></a>taxonomy &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/microbiome_taxonomy.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb228-44"><a href="inter-omics.html#cb228-44"></a>barettin &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/GB_OTU_barettin_correlation.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb228-45"><a href="inter-omics.html#cb228-45"></a></span>
<span id="cb228-46"><a href="inter-omics.html#cb228-46"></a><span class="co"># matching IDs</span></span>
<span id="cb228-47"><a href="inter-omics.html#cb228-47"></a>nodes[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(nodes<span class="op">$</span>OTU_long, <span class="st">&quot;OTU196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-48"><a href="inter-omics.html#cb228-48"></a>depth[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(depth<span class="op">$</span>XOTU, <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-49"><a href="inter-omics.html#cb228-49"></a>taxonomy[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(taxonomy<span class="op">$</span>OTU_ID, <span class="st">&quot;196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-50"><a href="inter-omics.html#cb228-50"></a>barettin[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(barettin<span class="op">$</span>XOTU, <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-51"><a href="inter-omics.html#cb228-51"></a>occurrence<span class="op">$</span>gb[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">rownames</span>(occurrence<span class="op">$</span>gb), <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-52"><a href="inter-omics.html#cb228-52"></a></span>
<span id="cb228-53"><a href="inter-omics.html#cb228-53"></a><span class="co"># downsizing to relevant columns nodes$OTU_long &lt;- NULL</span></span>
<span id="cb228-54"><a href="inter-omics.html#cb228-54"></a>depth &lt;-<span class="st"> </span>depth[, <span class="kw">c</span>(<span class="st">&quot;ttest_pval&quot;</span>, <span class="st">&quot;ttest_fdr&quot;</span>, <span class="st">&quot;inc_dec_estimate&quot;</span>, <span class="st">&quot;inc_dec_p_val&quot;</span>, <span class="st">&quot;fdr&quot;</span>, <span class="st">&quot;classification&quot;</span>, <span class="st">&quot;OTU&quot;</span>)]</span>
<span id="cb228-55"><a href="inter-omics.html#cb228-55"></a><span class="kw">colnames</span>(depth) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ttest_pval&quot;</span>, <span class="st">&quot;ttest_fdr&quot;</span>, <span class="st">&quot;inc_dec_estimate&quot;</span>, <span class="st">&quot;inc_dec_p_val&quot;</span>, <span class="st">&quot;inc_dec_fdr&quot;</span>, <span class="st">&quot;inc_dec_classification&quot;</span>, <span class="st">&quot;OTU&quot;</span>)</span>
<span id="cb228-56"><a href="inter-omics.html#cb228-56"></a>barettin<span class="op">$</span>XOTU &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb228-57"><a href="inter-omics.html#cb228-57"></a>taxonomy[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(taxonomy, str_trim)</span>
<span id="cb228-58"><a href="inter-omics.html#cb228-58"></a></span>
<span id="cb228-59"><a href="inter-omics.html#cb228-59"></a><span class="co"># combining dfs</span></span>
<span id="cb228-60"><a href="inter-omics.html#cb228-60"></a>shortlist_gb &lt;-<span class="st"> </span><span class="kw">left_join</span>(occurrence<span class="op">$</span>gb, depth)</span>
<span id="cb228-61"><a href="inter-omics.html#cb228-61"></a>shortlist_gb &lt;-<span class="st"> </span><span class="kw">left_join</span>(shortlist_gb, barettin)</span>
<span id="cb228-62"><a href="inter-omics.html#cb228-62"></a>shortlist_gb &lt;-<span class="st"> </span><span class="kw">left_join</span>(shortlist_gb, taxonomy)</span>
<span id="cb228-63"><a href="inter-omics.html#cb228-63"></a></span>
<span id="cb228-64"><a href="inter-omics.html#cb228-64"></a><span class="co"># Exclude Sf OTUs intersect(colnames(micro_ds$gb), colnames(micro_ds$sf)) # shared OTUs length(intersect(colnames(micro_ds$gb), colnames(micro_ds$sf))) # 316</span></span>
<span id="cb228-65"><a href="inter-omics.html#cb228-65"></a></span>
<span id="cb228-66"><a href="inter-omics.html#cb228-66"></a><span class="co"># setdiff(colnames(micro_ds$gb), colnames(micro_ds$sf)) # Setdiff finds rows that appear in first table but not in second</span></span>
<span id="cb228-67"><a href="inter-omics.html#cb228-67"></a><span class="co"># length(setdiff(colnames(micro_ds$gb), colnames(micro_ds$sf))) # 104:ok!</span></span>
<span id="cb228-68"><a href="inter-omics.html#cb228-68"></a>gb_unique &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">setdiff</span>(<span class="kw">colnames</span>(micro_ds<span class="op">$</span>gb), <span class="kw">colnames</span>(micro_ds<span class="op">$</span>sf)))</span>
<span id="cb228-69"><a href="inter-omics.html#cb228-69"></a><span class="kw">colnames</span>(gb_unique) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;XOTU&quot;</span>)</span>
<span id="cb228-70"><a href="inter-omics.html#cb228-70"></a>gb_unique[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(gb_unique<span class="op">$</span>XOTU, <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-71"><a href="inter-omics.html#cb228-71"></a></span>
<span id="cb228-72"><a href="inter-omics.html#cb228-72"></a>gb_unique &lt;-<span class="st"> </span><span class="kw">left_join</span>(gb_unique, shortlist_gb)</span>
<span id="cb228-73"><a href="inter-omics.html#cb228-73"></a></span>
<span id="cb228-74"><a href="inter-omics.html#cb228-74"></a>gb_unique &lt;-<span class="st"> </span>gb_unique <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(occurrence <span class="op">==</span><span class="st"> &quot;common&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(barettin_estimate_P <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>barettin_p_val_P <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</span>
<span id="cb228-75"><a href="inter-omics.html#cb228-75"></a></span>
<span id="cb228-76"><a href="inter-omics.html#cb228-76"></a><span class="co"># Recovery of those OTUs that also correlate with barettin in S. fortis</span></span>
<span id="cb228-77"><a href="inter-omics.html#cb228-77"></a>sf_shared &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">intersect</span>(<span class="kw">colnames</span>(micro_ds<span class="op">$</span>gb), <span class="kw">colnames</span>(micro_ds<span class="op">$</span>sf)))</span>
<span id="cb228-78"><a href="inter-omics.html#cb228-78"></a><span class="kw">colnames</span>(sf_shared) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;XOTU&quot;</span>)</span>
<span id="cb228-79"><a href="inter-omics.html#cb228-79"></a>sf_barretin &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/SF_OTU_barettin_correlation.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb228-80"><a href="inter-omics.html#cb228-80"></a></span>
<span id="cb228-81"><a href="inter-omics.html#cb228-81"></a>sf_shared &lt;-<span class="st"> </span><span class="kw">left_join</span>(sf_shared, sf_barretin)</span>
<span id="cb228-82"><a href="inter-omics.html#cb228-82"></a></span>
<span id="cb228-83"><a href="inter-omics.html#cb228-83"></a><span class="co"># Sf Pearson p&lt;0.05 24 pFDR&gt;0.05 8 Spearman p&lt;0.05 14 pFDR&gt;0.05 0</span></span>
<span id="cb228-84"><a href="inter-omics.html#cb228-84"></a></span>
<span id="cb228-85"><a href="inter-omics.html#cb228-85"></a>sf_shared &lt;-<span class="st"> </span>sf_shared <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(barettin_estimate_P <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(barettin_p_val_P <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</span>
<span id="cb228-86"><a href="inter-omics.html#cb228-86"></a></span>
<span id="cb228-87"><a href="inter-omics.html#cb228-87"></a>sf_shared[<span class="st">&quot;OTU&quot;</span>] &lt;-<span class="st"> </span><span class="kw">str_replace</span>(sf_shared<span class="op">$</span>XOTU, <span class="st">&quot;X196900&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb228-88"><a href="inter-omics.html#cb228-88"></a>shared_recovered &lt;-<span class="st"> </span>shortlist_gb[shortlist_gb<span class="op">$</span>OTU <span class="op">%in%</span><span class="st"> </span>sf_shared<span class="op">$</span>OTU, ]</span>
<span id="cb228-89"><a href="inter-omics.html#cb228-89"></a></span>
<span id="cb228-90"><a href="inter-omics.html#cb228-90"></a><span class="co"># check again for the criteria in the new df</span></span>
<span id="cb228-91"><a href="inter-omics.html#cb228-91"></a>shared_recovered &lt;-<span class="st"> </span>shared_recovered <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(occurrence <span class="op">==</span><span class="st"> &quot;common&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(barettin_estimate_P <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>barettin_p_val_P <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)</span>
<span id="cb228-92"><a href="inter-omics.html#cb228-92"></a></span>
<span id="cb228-93"><a href="inter-omics.html#cb228-93"></a><span class="co"># combine the two data sets: gb_unique and shared_recovered</span></span>
<span id="cb228-94"><a href="inter-omics.html#cb228-94"></a></span>
<span id="cb228-95"><a href="inter-omics.html#cb228-95"></a>gb_unique[<span class="st">&quot;group&quot;</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gb_unique&quot;</span>)</span>
<span id="cb228-96"><a href="inter-omics.html#cb228-96"></a>shared_recovered[<span class="st">&quot;group&quot;</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sf_shared&quot;</span>)</span>
<span id="cb228-97"><a href="inter-omics.html#cb228-97"></a></span>
<span id="cb228-98"><a href="inter-omics.html#cb228-98"></a>gb_unique &lt;-<span class="st"> </span>gb_unique[, <span class="kw">c</span>(<span class="st">&quot;OTU&quot;</span>, <span class="st">&quot;group&quot;</span>, <span class="st">&quot;Kingdom&quot;</span>, <span class="st">&quot;Phylum&quot;</span>, <span class="st">&quot;Class&quot;</span>)]</span>
<span id="cb228-99"><a href="inter-omics.html#cb228-99"></a>shared_recovered &lt;-<span class="st"> </span>shared_recovered[, <span class="kw">c</span>(<span class="st">&quot;OTU&quot;</span>, <span class="st">&quot;group&quot;</span>, <span class="st">&quot;Kingdom&quot;</span>, <span class="st">&quot;Phylum&quot;</span>, <span class="st">&quot;Class&quot;</span>)]</span>
<span id="cb228-100"><a href="inter-omics.html#cb228-100"></a></span>
<span id="cb228-101"><a href="inter-omics.html#cb228-101"></a>shortlist &lt;-<span class="st"> </span><span class="kw">rbind</span>(gb_unique, shared_recovered)</span>
<span id="cb228-102"><a href="inter-omics.html#cb228-102"></a></span>
<span id="cb228-103"><a href="inter-omics.html#cb228-103"></a><span class="kw">options</span>(<span class="dt">kableExtra.html.bsTable =</span> T)</span>
<span id="cb228-104"><a href="inter-omics.html#cb228-104"></a><span class="kw">kable</span>(shortlist, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;OTU&quot;</span>, <span class="st">&quot;group&quot;</span>, <span class="st">&quot;Kingdom&quot;</span>, <span class="st">&quot;Phylum&quot;</span>, <span class="st">&quot;Class&quot;</span>), <span class="dt">longtable =</span> T, <span class="dt">booktabs =</span> T, <span class="dt">caption =</span> <span class="st">&quot;Shortlist of OTUs that were deemed candidate producers of barettin.&quot;</span>, </span>
<span id="cb228-105"><a href="inter-omics.html#cb228-105"></a>    <span class="dt">row.names =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt"> </span><span class="st">`</span> =<span class="st"> </span><span class="dv">2</span>, <span class="dt">Taxonomy =</span> <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;bordered&quot;</span>, <span class="st">&quot;condensed&quot;</span>, <span class="st">&quot;responsive&quot;</span>), </span>
<span id="cb228-106"><a href="inter-omics.html#cb228-106"></a>    <span class="dt">full_width =</span> F, <span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;scale_down&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">OTU</th>
<th align="left">group</th>
<th align="left">Kingdom</th>
<th align="left">Phylum</th>
<th align="left">Class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">589</td>
<td align="left">gb_unique</td>
<td align="left">Bacteria</td>
<td align="left">Chloroflexi</td>
<td align="left">SAR202_clade</td>
</tr>
<tr class="even">
<td align="left">588</td>
<td align="left">gb_unique</td>
<td align="left">Bacteria</td>
<td align="left">Acidobacteria</td>
<td align="left">Subgroup_9</td>
</tr>
<tr class="odd">
<td align="left">180</td>
<td align="left">sf_shared</td>
<td align="left">Bacteria</td>
<td align="left">Proteobacteria</td>
<td align="left">JTB23</td>
</tr>
<tr class="even">
<td align="left">144</td>
<td align="left">sf_shared</td>
<td align="left">Bacteria</td>
<td align="left">Acidobacteria</td>
<td align="left">Subgroup_9</td>
</tr>
<tr class="odd">
<td align="left">213</td>
<td align="left">sf_shared</td>
<td align="left">Bacteria</td>
<td align="left">Gemmatimonadetes</td>
<td align="left">BD2-11_terrestrial_group</td>
</tr>
<tr class="even">
<td align="left">310</td>
<td align="left">sf_shared</td>
<td align="left">Bacteria</td>
<td align="left">Proteobacteria</td>
<td align="left">JTB23</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="inter-omics.html#cb229-1"></a>micro &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/OTU_all_R.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb229-2"><a href="inter-omics.html#cb229-2"></a>meta_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Steffen_et_al_metadata_PANGAEA.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb229-3"><a href="inter-omics.html#cb229-3"></a>cmp &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/metabolite_master_20190605.csv&quot;</span>, <span class="dt">header =</span> T, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb229-4"><a href="inter-omics.html#cb229-4"></a></span>
<span id="cb229-5"><a href="inter-omics.html#cb229-5"></a>meta_data &lt;-<span class="st"> </span><span class="kw">meta_data_prep</span>(meta_data)</span>
<span id="cb229-6"><a href="inter-omics.html#cb229-6"></a></span>
<span id="cb229-7"><a href="inter-omics.html#cb229-7"></a>OTU_prep &lt;-<span class="st"> </span><span class="cf">function</span>(micro) {</span>
<span id="cb229-8"><a href="inter-omics.html#cb229-8"></a>    <span class="kw">rownames</span>(micro) &lt;-<span class="st"> </span>micro<span class="op">$</span>Sample_ID</span>
<span id="cb229-9"><a href="inter-omics.html#cb229-9"></a>    micro<span class="op">$</span>Sample_ID &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb229-10"><a href="inter-omics.html#cb229-10"></a>    <span class="co"># micro &lt;- sqrt(micro)</span></span>
<span id="cb229-11"><a href="inter-omics.html#cb229-11"></a>    </span>
<span id="cb229-12"><a href="inter-omics.html#cb229-12"></a>    micro_gb &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Gb&quot;</span>), ]</span>
<span id="cb229-13"><a href="inter-omics.html#cb229-13"></a>    micro_sf &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Sf&quot;</span>), ]</span>
<span id="cb229-14"><a href="inter-omics.html#cb229-14"></a>    micro_wb &lt;-<span class="st"> </span>micro[(<span class="kw">str_sub</span>(<span class="kw">rownames</span>(micro), <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">==</span><span class="st"> &quot;Wb&quot;</span>), ]</span>
<span id="cb229-15"><a href="inter-omics.html#cb229-15"></a>    </span>
<span id="cb229-16"><a href="inter-omics.html#cb229-16"></a>    micro_gb &lt;-<span class="st"> </span>micro_gb[, <span class="kw">colSums</span>(micro_gb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb229-17"><a href="inter-omics.html#cb229-17"></a>    micro_sf &lt;-<span class="st"> </span>micro_sf[, <span class="kw">colSums</span>(micro_sf <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb229-18"><a href="inter-omics.html#cb229-18"></a>    micro_wb &lt;-<span class="st"> </span>micro_wb[, <span class="kw">colSums</span>(micro_wb <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb229-19"><a href="inter-omics.html#cb229-19"></a>    micros &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">gb =</span> micro_gb, <span class="dt">sf =</span> micro_sf, <span class="dt">wb =</span> micro_wb)</span>
<span id="cb229-20"><a href="inter-omics.html#cb229-20"></a>    <span class="kw">return</span>(micros)</span>
<span id="cb229-21"><a href="inter-omics.html#cb229-21"></a>}</span>
<span id="cb229-22"><a href="inter-omics.html#cb229-22"></a></span>
<span id="cb229-23"><a href="inter-omics.html#cb229-23"></a>micro_ds &lt;-<span class="st"> </span><span class="kw">OTU_prep</span>(micro)</span>
<span id="cb229-24"><a href="inter-omics.html#cb229-24"></a></span>
<span id="cb229-25"><a href="inter-omics.html#cb229-25"></a>overall_rabdc &lt;-<span class="st"> </span><span class="cf">function</span>(micros) {</span>
<span id="cb229-26"><a href="inter-omics.html#cb229-26"></a>    mic &lt;-<span class="st"> </span>micros</span>
<span id="cb229-27"><a href="inter-omics.html#cb229-27"></a>    n &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb229-28"><a href="inter-omics.html#cb229-28"></a>    k &lt;-<span class="st"> </span><span class="kw">dim</span>(mic)[<span class="dv">1</span>]</span>
<span id="cb229-29"><a href="inter-omics.html#cb229-29"></a>    mic[<span class="st">&quot;rowsum&quot;</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(mic, <span class="dv">1</span>, sum)</span>
<span id="cb229-30"><a href="inter-omics.html#cb229-30"></a>    </span>
<span id="cb229-31"><a href="inter-omics.html#cb229-31"></a>    <span class="cf">while</span> (n <span class="op">&lt;</span><span class="st"> </span>k) {</span>
<span id="cb229-32"><a href="inter-omics.html#cb229-32"></a>        n &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb229-33"><a href="inter-omics.html#cb229-33"></a>        mic[n, ] &lt;-<span class="st"> </span>mic[n, ]<span class="op">/</span>(mic<span class="op">$</span>rowsum[n])</span>
<span id="cb229-34"><a href="inter-omics.html#cb229-34"></a>    }</span>
<span id="cb229-35"><a href="inter-omics.html#cb229-35"></a>    </span>
<span id="cb229-36"><a href="inter-omics.html#cb229-36"></a>    mic<span class="op">$</span>rowsum &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb229-37"><a href="inter-omics.html#cb229-37"></a>    mic &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(mic))</span>
<span id="cb229-38"><a href="inter-omics.html#cb229-38"></a>    <span class="co"># mic[&#39;avg_rel_abdc&#39;] &lt;- apply(mic, 1, mean) mic[&#39;occurrence&#39;] &lt;- ifelse(mic$avg&gt;0.0025, &#39;common&#39;, &#39;rare&#39;)</span></span>
<span id="cb229-39"><a href="inter-omics.html#cb229-39"></a>    <span class="kw">return</span>(mic)</span>
<span id="cb229-40"><a href="inter-omics.html#cb229-40"></a>}</span>
<span id="cb229-41"><a href="inter-omics.html#cb229-41"></a></span>
<span id="cb229-42"><a href="inter-omics.html#cb229-42"></a>rabdc &lt;-<span class="st"> </span><span class="kw">lapply</span>(micro_ds, overall_rabdc)</span>
<span id="cb229-43"><a href="inter-omics.html#cb229-43"></a></span>
<span id="cb229-44"><a href="inter-omics.html#cb229-44"></a>rabdc<span class="op">$</span>gb[, <span class="kw">c</span>(<span class="st">&quot;avg_rel_abdc&quot;</span>, <span class="st">&quot;occurrence&quot;</span>)] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb229-45"><a href="inter-omics.html#cb229-45"></a></span>
<span id="cb229-46"><a href="inter-omics.html#cb229-46"></a><span class="co"># Shortlist OTUs</span></span>
<span id="cb229-47"><a href="inter-omics.html#cb229-47"></a>sl &lt;-<span class="st"> </span>rabdc<span class="op">$</span>gb[<span class="kw">c</span>(<span class="st">&quot;X196900144&quot;</span>, <span class="st">&quot;X196900180&quot;</span>, <span class="st">&quot;X196900213&quot;</span>, <span class="st">&quot;X196900310&quot;</span>, <span class="st">&quot;X196900588&quot;</span>, <span class="st">&quot;X196900589&quot;</span>), ]</span>
<span id="cb229-48"><a href="inter-omics.html#cb229-48"></a>sl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(sl))</span>
<span id="cb229-49"><a href="inter-omics.html#cb229-49"></a>sl[<span class="st">&quot;unified_ID&quot;</span>] &lt;-<span class="st"> </span><span class="kw">rownames</span>(sl)</span>
<span id="cb229-50"><a href="inter-omics.html#cb229-50"></a>sl &lt;-<span class="st"> </span><span class="kw">left_join</span>(sl, meta_data[, <span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;Depth&quot;</span>)])</span>
<span id="cb229-51"><a href="inter-omics.html#cb229-51"></a>sl &lt;-<span class="st"> </span><span class="kw">left_join</span>(sl, cmp[, <span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;bar&quot;</span>)])</span>
<span id="cb229-52"><a href="inter-omics.html#cb229-52"></a><span class="kw">summary</span>(<span class="kw">lm</span>(X196900144 <span class="op">~</span><span class="st"> </span>bar, sl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X196900144 ~ bar, data = sl)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.009272 -0.002497 -0.001386  0.002741  0.013684 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -3.026e-03  4.204e-03  -0.720  0.49218    
## bar          1.720e-08  2.992e-09   5.748  0.00043 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.006446 on 8 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.8051, Adjusted R-squared:  0.7807 
## F-statistic: 33.04 on 1 and 8 DF,  p-value: 0.0004298</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="inter-omics.html#cb231-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(X196900180 <span class="op">~</span><span class="st"> </span>bar, sl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X196900180 ~ bar, data = sl)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0039199 -0.0014359 -0.0002769  0.0008649  0.0053601 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 9.756e-04  1.734e-03   0.562 0.589192    
## bar         6.287e-09  1.234e-09   5.093 0.000938 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.002659 on 8 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.7643, Adjusted R-squared:  0.7348 
## F-statistic: 25.94 on 1 and 8 DF,  p-value: 0.0009383</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="inter-omics.html#cb233-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(X196900213 <span class="op">~</span><span class="st"> </span>bar, sl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X196900213 ~ bar, data = sl)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0031031 -0.0012324 -0.0004205  0.0011007  0.0048727 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -5.866e-04  1.642e-03  -0.357  0.73020   
## bar          3.927e-09  1.169e-09   3.360  0.00994 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.002518 on 8 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.5852, Adjusted R-squared:  0.5333 
## F-statistic: 11.29 on 1 and 8 DF,  p-value: 0.009939</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="inter-omics.html#cb235-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(X196900310 <span class="op">~</span><span class="st"> </span>bar, sl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X196900310 ~ bar, data = sl)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0023418 -0.0007641 -0.0005424 -0.0002813  0.0047438 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -9.181e-05  1.476e-03  -0.062   0.9519  
## bar          2.655e-09  1.051e-09   2.527   0.0354 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.002263 on 8 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.4439, Adjusted R-squared:  0.3744 
## F-statistic: 6.385 on 1 and 8 DF,  p-value: 0.03543</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="inter-omics.html#cb237-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(X196900588 <span class="op">~</span><span class="st"> </span>bar, sl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X196900588 ~ bar, data = sl)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0036391 -0.0008598 -0.0003235  0.0000593  0.0060071 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -5.362e-04  1.815e-03  -0.295    0.775  
## bar          2.997e-09  1.292e-09   2.320    0.049 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.002783 on 8 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.4021, Adjusted R-squared:  0.3274 
## F-statistic:  5.38 on 1 and 8 DF,  p-value: 0.04895</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="inter-omics.html#cb239-1"></a><span class="kw">summary</span>(<span class="kw">lm</span>(X196900589 <span class="op">~</span><span class="st"> </span>bar, sl))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = X196900589 ~ bar, data = sl)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0020026 -0.0004915 -0.0001909  0.0003738  0.0020246 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -3.725e-04  8.105e-04   -0.46  0.65800    
## bar          3.063e-09  5.769e-10    5.31  0.00072 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.001243 on 8 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.779,  Adjusted R-squared:  0.7513 
## F-statistic: 28.19 on 1 and 8 DF,  p-value: 0.0007201</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="inter-omics.html#cb241-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb241-2"><a href="inter-omics.html#cb241-2"></a>sl &lt;-<span class="st"> </span><span class="kw">melt</span>(sl, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&quot;unified_ID&quot;</span>, <span class="st">&quot;Depth&quot;</span>, <span class="st">&quot;bar&quot;</span>))</span>
<span id="cb241-3"><a href="inter-omics.html#cb241-3"></a><span class="kw">ggplot</span>(sl, <span class="kw">aes</span>(<span class="dt">x =</span> Depth, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>variable, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>scientific) <span class="op">+</span><span class="st"> </span></span>
<span id="cb241-4"><a href="inter-omics.html#cb241-4"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>scientific) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shortlisted OTUs and depth&quot;</span>)</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/shortlisted-OTU-bar-1.png" width="672" /></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="inter-omics.html#cb242-1"></a><span class="kw">ggplot</span>(sl, <span class="kw">aes</span>(<span class="dt">x =</span> bar, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>variable, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, </span>
<span id="cb242-2"><a href="inter-omics.html#cb242-2"></a>    <span class="dt">vjust =</span> <span class="fl">0.5</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Barettin signal&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;OTU relative abundance&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>scientific) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>scientific) <span class="op">+</span><span class="st"> </span></span>
<span id="cb242-3"><a href="inter-omics.html#cb242-3"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shortlisted OTUs and barettin&quot;</span>)</span></code></pre></div>
<p><img src="Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges_files/figure-html/shortlisted-OTU-bar-2.png" width="672" /></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="inter-omics.html#cb243-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.15.5
## 
## Matrix products: default
## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] minerva_1.5.8           viridis_0.5.1           viridisLite_0.3.0       pheatmap_1.0.12         rgl_0.100.50            plot3D_1.3             
##  [7] gtools_3.8.2            seqinr_3.6-1            picante_1.8.1           nlme_3.1-145            ape_5.3                 phyloseq_1.28.0        
## [13] DT_0.13                 RColorBrewer_1.1-2      ggExtra_0.9             plotly_4.9.2            ropls_1.14.1            reshape2_1.4.3         
## [19] usdm_1.1-18             raster_3.0-12           sp_1.4-1                rnaturalearthdata_0.1.0 rnaturalearth_0.1.0     sf_0.8-1               
## [25] marmap_1.0.3            mapdata_2.3.0           maps_3.3.0              ggmap_3.0.0.901         kableExtra_1.1.0.9000   gridExtra_2.3          
## [31] reshape_0.8.8           ggrepel_0.8.2           igraph_1.2.5            metap_1.3               vegan_2.5-6             lattice_0.20-41        
## [37] permute_0.9-5           forcats_0.5.0           stringr_1.4.0           dplyr_0.8.5             purrr_0.3.3             readr_1.3.1            
## [43] tidyr_1.0.2             tibble_3.0.0            ggplot2_3.3.0           tidyverse_1.3.0         knitr_1.28             
## 
## loaded via a namespace (and not attached):
##   [1] tidyselect_1.0.0        RSQLite_2.2.0           htmlwidgets_1.5.1       munsell_0.5.0           codetools_0.2-16        mutoss_0.1-12          
##   [7] units_0.6-6             miniUI_0.1.1.1          misc3d_0.8-4            withr_2.1.2             colorspace_1.4-1        Biobase_2.42.0         
##  [13] highr_0.8               rstudioapi_0.11         stats4_3.5.1            gbRd_0.4-11             Rdpack_0.11-1           labeling_0.3           
##  [19] RgoogleMaps_1.4.5.3     mnormt_1.5-6            bit64_0.9-7             farver_2.0.3            rhdf5_2.26.2            vctrs_0.2.4            
##  [25] generics_0.0.2          TH.data_1.0-10          xfun_0.13.1             R6_2.4.1                isoband_0.2.0           manipulateWidget_0.10.1
##  [31] bitops_1.0-6            assertthat_0.2.1        promises_1.1.0          scales_1.1.0            multcomp_1.4-12         rgeos_0.5-2            
##  [37] gtable_0.3.0            sandwich_2.5-1          rlang_0.4.5             splines_3.5.1           lazyeval_0.2.2          broom_0.5.5            
##  [43] yaml_2.2.1              modelr_0.1.6            crosstalk_1.1.0.1       backports_1.1.5         httpuv_1.5.2            tools_3.5.1            
##  [49] bookdown_0.18           ellipsis_0.3.0          biomformat_1.10.1       BiocGenerics_0.28.0     TFisher_0.2.0           Rcpp_1.0.4             
##  [55] plyr_1.8.6              zlibbioc_1.28.0         classInt_0.4-2          S4Vectors_0.20.1        zoo_1.8-7               haven_2.2.0            
##  [61] cluster_2.1.0           fs_1.4.0                magrittr_1.5            data.table_1.12.8       reprex_0.3.0            mvtnorm_1.1-0          
##  [67] hms_0.5.3               mime_0.9                evaluate_0.14           xtable_1.8-4            jpeg_0.1-8.1            readxl_1.3.1           
##  [73] IRanges_2.16.0          shape_1.4.4             compiler_3.5.1          KernSmooth_2.23-16      ncdf4_1.17              crayon_1.3.4           
##  [79] htmltools_0.4.0         mgcv_1.8-31             later_1.0.0             lubridate_1.7.4         DBI_1.1.0               formatR_1.7            
##  [85] dbplyr_1.4.2            MASS_7.3-51.5           Matrix_1.2-18           ade4_1.7-15             cli_2.0.2               parallel_3.5.1         
##  [91] pkgconfig_2.0.3         sn_1.6-1                numDeriv_2016.8-1.1     xml2_1.3.0              foreach_1.5.0           multtest_2.38.0        
##  [97] webshot_0.5.2           XVector_0.22.0          bibtex_0.4.2.2          rvest_0.3.5             digest_0.6.25           Biostrings_2.50.2      
## [103] rmarkdown_2.1           cellranger_1.1.0        shiny_1.4.0.2           rjson_0.2.20            lifecycle_0.2.0         jsonlite_1.6.1         
## [109] Rhdf5lib_1.4.3          fansi_0.4.1             pillar_1.4.3            fastmap_1.0.1           httr_1.4.1              plotrix_3.7-7          
## [115] survival_3.1-11         glue_1.3.2              png_0.1-7               iterators_1.0.12        bit_1.1-15.2            class_7.3-16           
## [121] adehabitatMA_0.3.14     stringi_1.4.6           blob_1.2.1              memoise_1.1.0           e1071_1.7-3</code></pre>


</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="microbiota.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="funding-disclaimer.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges.pdf", "Oceanographic-setting-influences-the-prokaryote-community-and-metabolome-in-deep-sea-sponges.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
